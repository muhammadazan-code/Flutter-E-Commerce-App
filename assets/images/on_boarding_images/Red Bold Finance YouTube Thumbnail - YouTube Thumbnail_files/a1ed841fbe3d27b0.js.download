(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[70907],{

/***/ 632102:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(627974);__web_req__(855923);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var R0m=__c.R0m;var Rxw,Sxw,Txw,Uxw,Wxw,Xxw,Yxw,byw,ayw,Vxw,cyw,dyw,eyw,gyw,fyw,hyw,iyw,kyw,lyw;Rxw=function(a,b,c){const d=a.ZYo,e=a.PAn;a=a.ARo;b.u7i==null&&(b.u7i=Math.floor((b.eej+d-c)/(e-a)));return Math.max((b.kti??b.eej)+b.u7i,c)};Sxw=function(a,b,c,d){d.v7i=a;if(d.Tji)return __c.N0m;const e=Rxw(c,d,b);d.Tji=!0;return(0,__c.L0m)(Math.max(0,e-b)).pipe((0,__c.M0m)(()=>{const f=d.v7i;d.v7i=void 0;d.Tji=!1;d.Szg++;d.kti=e;return f}),(0,__c.O0m)(f=>f!=null))};
Txw=function(a,b){const c=a.oca;a=a.document.pages.toArray().at(b);if(a?.type==="fixed")return c?__c.Bn.create(c(__c.Bn.snapshot(a))):a};Uxw=async function(a,b,c){if(a.gg){var {dispose:d}=await a.gg.XD(b),e=__c.sg(4,b.dimensions??a.document.dimensions),f=(a.XKf?500:1E3)/Math.min(e.width,e.height);({context:a}=a.gg.lQ(b,e,{lee:{type:"dimensions",dimensions:{width:Math.round(e.width*f),height:Math.round(e.height*f)}},Ljm:c?{B$b:!0,U6h:!1,G7h:!1,s8h:!1}:void 0}));d();return a.canvas}};
Wxw=async function(a,b){if(a.K4a){R0m(()=>{a.store.Fee=[]});b=b.filter(f=>Txw(a,f.Yb)!=null).reduce((f,g)=>{const h=f.find(k=>k.Yb===g.Yb);h?f.splice(f.indexOf(h),1,g):f.push(g);return f},[]);var c=b.map(f=>f.Yb);if(await a.E3a(c)){var d=c.map(f=>{if(f=Txw(a,f))return a.Wna(f)}),e=await Vxw(a.K4a,b,a.Xbk);R0m(()=>{c.forEach((f,g)=>{const h=a.store.ZPb.get(f),k=d.at(g),l=Txw(a,f);k&&l&&__c.S0m.structural(k,a.Wna(l))&&a.store.ZPb.set(f,e.ok?{image:e.value[g],qId:k}:{image:h?.image,qId:k,status:"error"})})});
a.Xbk=void 0}}};Xxw=function(a,b){a.K4a?.BJj(b);a.K4a?.r5p(b);a.store.Fee=a.store.Fee.filter(c=>c.Yb!==b)};Yxw=function(a,b){switch(a){case 2:return a=b.Hc.first(),!a||a.image.ref==null&&a.video.ref==null&&a.gradient.ref==null&&a.color==null;case 1:return!0;default:return!1}};
__c.Zxw=async function(a,b,c){var d=Txw(a,b);if(d)if(__c.JVa(d)&&c!==2)Xxw(a,b),a.store.ZPb.delete(b);else{var e=a.Wna(d),f=a.store.ZPb.get(b);if(!(f&&f.image&&__c.S0m.structural(f.qId,e)&&f.status!=="error")){var g=Yxw(c,d);if(!a.K4a||!a.store.w3h&&a.gg?.Bth?.(d)){Xxw(a,b);c=a.V?.wb("rasterize",{Hb:{name:"rasterization_manager.rasterize",type:a.UPd}});try{const h=await Uxw(a,d,g);R0m(()=>{a.store.ZPb.set(b,{image:h,qId:e})});c?.setStatus("ok")}catch(h){const k=a.store.ZPb.get(b);R0m(()=>{a.store.ZPb.set(b,
{image:k?.image,qId:e,status:"error"})});c?.setStatus("error")}finally{d=c?.end(),a.eEm&&d&&a.eEm(d.Oi())}}else R0m(()=>{f?f.status="loading":a.store.ZPb.set(b,{image:void 0,qId:e,status:"loading"});a.store.Fee.push({Yb:b,ZQa:g});!a.Xbk&&a.V&&(a.Xbk=a.V.wb("rasterization_manager.export",{Hb:{name:"rasterization_manager.export",type:a.UPd}}))}),a.K4a.I4b()}}};
__c.$xw=function(a,b,c){var d=a.yee.get(b);if(d)return d.qMk++,d.laa;d=(0,__c.U0m)((0,__c.V0m)(()=>{const f=Txw(a,b);if(f)return a.Wna(f)},!0)).pipe((0,__c.W0m)(__c.S0m.structural));const e=(0,__c.X0m)(d.pipe((0,__c.Y0m)(1)),d.pipe((0,__c.Z0m)(1),(0,__c.$0m)(200))).subscribe((0,__c.T0m)(()=>__c.Zxw(a,b,c)));a.yee.set(b,{qMk:1,laa:()=>{const f=a.yee.get(b);f&&(f.qMk--,f.qMk<=0&&(e.unsubscribe(),a.yee.delete(b),R0m(()=>{a.K4a?.BJj(b);a.store.Fee=a.store.Fee.filter(h=>h.Yb!==b);const g=a.store.ZPb.get(b);
g&&a.store.ZPb.set(b,{image:g.image,qId:g.qId})})))}});return a.yee.get(b)?.laa};byw=function(a){const b=ayw(a);a=__c.m(a.K4a).Qxq;return b.pipe((0,__c.b1m)(a.pipe((0,__c.O0m)(c=>!c))),(0,__c.M0m)(c=>c.pop()||[]),(0,__c.O0m)(c=>c.length>0))};ayw=function(a){return(0,__c.U0m)((0,__c.V0m)(()=>[...a.store.Fee])).pipe((0,__c.O0m)(b=>b.length>0))};
Vxw=async function(a,b,c){b.forEach(e=>a.BJj(e.Yb));c?.ob().addEvent("page_previews_loading");const d=await cyw(a,b);if(c){const e=d.ok?"page_previews_loaded":"page_previews_loading_failed";c.ob().addEvent(e);c.ob().wk(({Oi:f})=>{f=f();a.Hht?.(b.length,f)});d.ok||c.setStatus("error");c.end()}return d};cyw=function(a,b){return a.ea?a.zXl?dyw(a,b):eyw(a,b,!1):eyw(a,b,!0)};
dyw=async function(a,b){try{const c=await Promise.all(b.map(async({Yb:d,ZQa:e})=>{e=await fyw(a,[{Yb:d,ZQa:e}],!0);if(e.url)return a.uR(e.url);if(e.Iw)return(await a.ATc(e.Iw,[d]))[0];if(!e.Iw&&!e.url)throw Error("Export failed without URL or export identifier");}));return(0,__c.La)(c)}catch(c){return a.errorService.Tq(c),(0,__c.Ma)("sync-export-failed")}};
eyw=async function(a,b,c){try{const {Iw:d}=c?await gyw(a,b):await fyw(a,b,!1);if(!d)return(0,__c.Ma)("async-export-failed");const e=await a.ATc(d,b.map(f=>f.Yb));return(0,__c.La)(e)}catch(d){return a.errorService.Tq(d),(0,__c.Ma)("async-export-failed")}};gyw=async function(a,b){var c=b.map(e=>e.Yb+1);b=hyw(b);const d=iyw(a,!!b);c=new __c.XQn({ka:a.ka,content:a.q4a,pages:c,AUk:d,cGa:b});({Iw:a}=await a.Xt.ZAm(c));return{Iw:a}};
fyw=async function(a,b,c){const d=__c.m(a.ea),e=b.map(k=>k.Yb+1);b=hyw(b);const f=iyw(a,!!b);await d.sync();const {Iw:g,url:h}=await a.Xt.YAm(new __c.YQn({ka:d.id,Qo:d.version,Of:d.extension,pages:e,AUk:f,ZQa:c?b?.dRi==="REMOVE_ALL":void 0,cGa:b,Qts:c}));return{Iw:g,url:h}};hyw=function(a){return a.some(b=>b.ZQa)?a.every(b=>b.ZQa)?new __c.J9c:new __c.K9c({oj:a.filter(b=>b.ZQa).map(b=>b.Yb+1)}):void 0};
iyw=function(a,b){const c=new Map([[500,1],[1E3,2],[1500,3]]),d=a.bYn?c.get(a.bYn):void 0;return d?d:a.x7c&&(!b||a.ea&&a.Zbk)?c.get(a.x7c)??1:1};kyw=async function(a,b){if(!Array.from(a.store.pUf.values()).find(c=>c.Iw===b))throw new __c.Ph;a=await a.Xt.l4m(new jyw({Iw:b}));switch(a.status){case 1:break;case 2:return a.xEn.map(({page:c,LXn:d})=>({page:c,url:d}));case 3:throw Error("Failed to complete export");default:throw new __c.u(a.status);}};
lyw=({config:a,Sb:b=__c.Tb,errorService:c})=>d=>{const e={eej:b.now(),Szg:0,v7i:void 0,Tji:!1,u7i:void 0,kti:void 0};return d.pipe((0,__c.K0m)(f=>{const g=b.now(),h=a.PAn,k=a.ARo;g-e.eej>=a.ZYo&&(e.eej=g,e.Szg=0,e.v7i=void 0,e.Tji=!1,e.u7i=void 0,e.kti=void 0);if(e.Szg<k)return e.Szg++,e.kti=g,(0,__c.L0m)(0).pipe((0,__c.M0m)(()=>f));if(e.Szg<h)return Sxw(f,g,a,e);c?.warning("Rolling window throttle exceeded max values");return __c.N0m}))};
__c.myw=class{static G(a){__c.O(a,{Tvk:__c.Q0m,XJd:__c.Q0m})}get Tvk(){return[...this.store.ZPb.values()].some(a=>a.status==="error")}get XJd(){return[...this.store.ZPb.values()].some(({status:a})=>a==="loading")}Fgi(a){if(Txw(this,a))return this.store.ZPb.get(a)?.image}SSs(a,b){this.yee.forEach((c,d)=>{a.has(d)||c.laa()});a.forEach(c=>{this.yee.has(c)||__c.$xw(this,c,b)})}Iwq(){this.yee.forEach(a=>{a.laa()})}oDo(a=!1){if(this.K4a){this.store.w3h=a;a=this.K4a.w2j?byw(this):ayw(this);var b=(this.OAh?
a.pipe(lyw({config:{ZYo:3E5,PAn:75,ARo:40},errorService:this.errorService})):a.pipe((0,__c.a1m)(4E3,void 0,{leading:!0,trailing:!0}))).subscribe(c=>Wxw(this,c));return()=>b.unsubscribe()}this.errorService?.warning("ExportManager is not provided")}async E3a(a){if(!this.pfi)return!0;this.gTh&&this.gTh.cancel();try{return this.gTh=this.pfi(new Set(a.map(b=>b+1))),await this.gTh,this.gTh=void 0,!0}catch(b){return b instanceof Error&&b.message==="WHEN_CANCELLED"?!1:!0}}XXi(a){this.K4a?.XXi(a)}constructor({store:a,
document:b,K4a:c,Iht:d,gg:e,XKf:f,pfi:g,V:h,UPd:k,oca:l,OAh:n=!1,errorService:p}){this.store=(__c.myw.G(this),void 0);this.yee=new Map;this.Wna=q=>__c.Wg.Wna(__c.Cs.HR(__c.Bn.snapshot(q),{h7a:!0}));this.store=a;this.document=b;this.K4a=c;this.gg=e;this.XKf=!!f;d&&(this.eEm=__c.Db(d,500));this.pfi=g;this.V=h;this.UPd=k;this.oca=l;this.OAh=n;this.errorService=p;if(!this.gg&&!this.K4a)throw Error("Rasterizer or ExportManager is required");}};__c.myw.prototype.aOi=__c.ea(1189);
var jyw=__c.F(()=>({Iw:__c.S(1)})),nyw=class{static G(a){__c.O(a,{w2j:__c.$Qn})}XXi(a){this.bYn=a}get q4a(){var a=__c.bs.snapshot(__c.m(this.document));a={...a,pages:this.oca?a.pages.map(b=>b.type==="fixed"&&this.oca?this.oca(b):b):a.pages};return __c.Wg.Yie(__c.qg(__c.Cs,a,{h7a:!0}))}async ATc(a,b){(0,__c.aRn)(()=>{b.forEach(c=>{this.store.pUf.set(c,{Iw:a})})});try{const {result:c,cancel:d}=__c.Qh(()=>kyw(this,a),this.Tbk,{Js:this.Ubk,PZ:!0});(0,__c.aRn)(()=>{b.forEach(f=>{(f=this.store.pUf.get(f))&&
f.Iw===a&&(f.W9=d)})});const e=await c;return Promise.all(b.map(f=>{const {url:g}=e.find(({page:h})=>h-1===f)||{};return g?this.uR(g):void 0}))}catch(c){if(c instanceof __c.Ph)return[];throw c;}}r5p(a){this.store.pUf.delete(a)}BJj(a){a=this.store.pUf.get(a);a?.W9&&(a.W9(),a.W9=void 0)}get Qxq(){return this.store.Vlb}get w2j(){return!!this.ea}async I4b(){this.w2j&&(this.store.Vlb.next(!0),await __c.m(this.ea).sync(),this.store.Vlb.next(!1))}constructor({store:a,Xt:b,errorService:c,uR:d,x7c:e,Zbk:f,
ZQl:g,zXl:h,...k}){this.store=(nyw.G(this),void 0);this.store=a;this.Xt=b;this.errorService=c;this.uR=d;this.x7c=e;this.Zbk=f;this.Tbk=k.Tbk??700;this.Ubk=k.Ubk??15E3;this.zXl=h;this.Hht=g;switch(k.L4a){case 1:this.ea=k.ea;break;case 2:this.document=k.document;this.ka=k.ka;this.oca=k.oca;break;default:throw new __c.u(k);}}},oyw=__webpack_require__(186901),pyw=oyw.Es,qyw=oyw.sH,ryw=oyw.z7;var syw=__webpack_require__(78583).t;var tyw=class{static G(a){__c.O(a,{pUf:qyw.deep})}constructor(){this.pUf=(tyw.G(this),new Map);this.Vlb=new syw(!1)}};var uyw=class{static G(a){__c.O(a,{Fee:qyw.deep})}constructor(){this.Fee=(uyw.G(this),[]);this.ZPb=new pyw;this.w3h=!1}};var vyw;__c.wyw=({document:a,V:b,UPd:c,XKf:d,gg:e,zM:f,Ght:g,oca:h,OAh:k,...l})=>{const n=vyw({BZa:l,document:a,ZQl:g?(q,r)=>g({type:"preview_loading",hTf:q,Tb:r}):void 0,oca:h}),p=new uyw;return new __c.myw({store:p,document:a,K4a:n,V:b,UPd:c,gg:e,XKf:d,pfi:f?q=>ryw(()=>f(q).E3a.get()):void 0,Iht:g?q=>g({type:"fe_rasterizer",hTf:1,Tb:q}):void 0,oca:h,OAh:k,errorService:l.L4a===3?void 0:l.errorService})};
vyw=a=>{const b=a.BZa;var c=a.ZQl;const d=a.document;a=a.oca;c={store:new tyw,uR:__c.Ds,ZQl:c};switch(b.L4a){case 1:return new nyw({...c,...b});case 2:return new nyw({...c,...b,document:d,oca:a})}};__c.xyw={nBm:__c.wyw};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/a1ed841fbe3d27b0.js.map