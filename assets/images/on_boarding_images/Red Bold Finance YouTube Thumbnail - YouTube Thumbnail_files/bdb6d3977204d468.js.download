(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[4073],{

/***/ 867578:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(764820);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var M=__c.M;var Qnx=async function(a){return(await a.Gb.Hsd(new __c.TMd({id:a.ea.id,extension:a.ea.extension,actions:[2]})).catch(b=>{if(b instanceof __c.sh)return a.Gb.Hsd(new __c.TMd({id:a.ea.id,extension:a.ea.extension,actions:[9],NOe:!0}));throw b;})).MCf},Rnx=function(a){switch(a){case "loading":break;case "save_a_copy":case "try_again":case "discard_changes":return"save_a_copy";case "lost_access":return"lost_access";default:throw new __c.u(a);}},Snx=__webpack_require__(31968).jsx;var Tnx=__webpack_require__(845212),Unx=Tnx.useCallback,Vnx=Tnx.useEffect,Wnx=Tnx.useState;var Xnx=__webpack_require__(186901),Ynx=Xnx.h5,Znx=Xnx.sH,$nx=Xnx.XI;var aox=__webpack_require__(647370).PA;var box=({open:a,onClose:b,state:c,Uc:d,GEi:e,LDi:f,ZDi:g,xDi:h,ACi:k})=>{switch(c.stage){case "loading":c={title:M("QvnFjw"),buttons:[{children:null,loading:!0}]};break;case "lost_access":c={title:M("HHz8ag"),explanation:M("aBIKgQ"),buttons:[{children:M("MQKp+A"),onClick:e}]};break;case "save_a_copy":c={title:M("n/DjUA"),explanation:Snx(__c.Q,{tone:"secondary",children:Snx(__c.Zj,{message:M("VHsx0Q")})}),buttons:[{children:M("4PzO+g"),loading:c.loading,onClick:f},{children:M("0+NrYw"),onClick:g}]};
break;case "try_again":c={title:M("X55Jsg"),explanation:M("90hEdg"),buttons:[{children:M("O6uLZw"),loading:c.loading,onClick:f},{children:M("0+NrYw"),onClick:g}]};break;case "discard_changes":c={title:M("QIZUdg"),explanation:M("uqFEEw"),nH:"critical",buttons:[{children:M("0+NrYw"),onClick:h},{children:M("OQlK6w"),onClick:k}]};break;default:throw new __c.u(c);}Vnx(()=>{d()},[d]);return Snx(__c.ld,{open:a,rj:b,...c})},cox=({Rc:a,B$r:b})=>Snx(__c.Ck,{dismissible:!0,Rc:a,tone:"info",UH:!1,Tg:!0,Icon:__c.tD,
children:Snx(__c.ak,{Kx:"semiBold",message:M("2rNMYQ"),uf:b})});var dox=class{static G(a){__c.O(a,{open:Znx.ref,state:Znx.ref})}constructor(a){this.Id=a;this.open=(dox.G(this),!0);this.state={stage:"loading"}}},eox=class{static G(a){__c.O(a,{Uc:$nx,LDi:$nx,ZDi:$nx,xDi:$nx,ACi:$nx,GEi:$nx})}async Uc(a){if(a.state.stage==="loading"){var b=await Promise.race([Qnx(this),__c.ka(5E3).then(()=>!1)]).catch(c=>{this.errorService.ra(c);return!1});Ynx(()=>{a.state=b?{stage:"save_a_copy",loading:!1}:{stage:"lost_access"};this.P.track(__c.gnb,{UHa:"dialog",Od:"terminal",flow:Rnx(a.state.stage),
cause:a.Id.cause,GBc:a.Id.GBc,m8a:a.Id.m8a,statusCode:a.Id.statusCode,requestId:a.Id.requestId})})}}LDi(a){__c.sa(a.state.stage==="save_a_copy"||a.state.stage==="try_again");a.state.loading||(a.state={stage:a.state.stage,loading:!0},this.P.track(__c.enb,{flow:Rnx(a.state.stage),action:"save_a_copy",cause:a.Id.cause,m8a:a.Id.m8a}),this.ARj().then($nx(()=>{a.open=!1})).catch($nx(b=>{a.state={stage:"try_again",loading:!1};this.errorService.ra(b,{La:"Failed to save a copy"})})))}ZDi(a){a.state={stage:"discard_changes"}}xDi(a){this.P.track(__c.enb,
{flow:Rnx(a.state.stage),action:"discard_changes",cause:a.Id.cause,m8a:a.Id.m8a});this.w2e()}ACi(a){a.state={stage:"save_a_copy",loading:!1}}GEi(a){this.P.track(__c.enb,{flow:Rnx(a.state.stage),action:"go_back_home",cause:a.Id.cause,m8a:a.Id.m8a});this.Ec.mG({})}async ARj(){const a=await this.rsg();this.E8e(a);await __c.PJa(this.Ob,{id:a})}async rsg(){var a=__c.qg(__c.Cs,__c.$g.snapshot(this.ea.document)),b={...a,title:a.title&&__c.J("F4+5uQ",[a.title])};b=__c.Wg.serialize(b);const c=this.ea.extension,
d=[this.ea.id+(c?`/${c}`:"")];a=__c.Ppb(__c.Df({document:a}));if(a.length===1)return(await this.Gb.createDocument(new __c.a9c({lg:1,body:b,zMa:d}))).document.id;const e=await this.Gb.createDocument(new __c.a9c({lg:1}));for(const f of a)await this.Gb.Fcf(new __c.UMd({id:e.document.id,body:new __c.m9c({yJ:e.document.id,extension:e.document.xc.extension,A3e:[new __c.Ts({id:this.ea.id,extension:c,revision:void 0})],audio:f.wp.map(g=>({id:g})),Dc:f.Dc.map(g=>({id:g})),embeds:f.embeds,fonts:f.fonts,media:f.media})}));
await this.Gb.q5b(new __c.VMd({lg:1,version:1,id:e.document.id,zMa:d,body:b,extension:e.document.xc.extension}));return e.document.id}constructor(a,b,c,d,e,f,g,h){this.Ob=a;this.Ec=b;this.Gb=c;this.ea=d;this.P=e;this.errorService=f;this.w2e=g;this.E8e=h;eox.G(this)}};__c.Tpb={Wiq:function({Ob:a,Ec:b,Gb:c,ea:d,P:e,errorService:f,alert:g,w2e:h}){const k=new eox(a,b,c,d,e,f,h,l=>{const n=()=>__c.PJa(a,{id:l}),p=g.Vq(()=>Snx(cox,{Rc:p,B$r:n}))});return aox(({onClose:l,Id:n})=>{const [p]=Wnx(()=>new dox(n)),q=Unx(()=>k.Uc(p),[p]),r=Unx(()=>k.GEi(p),[p]),t=Unx(()=>k.LDi(p),[p]),v=Unx(()=>k.ZDi(p),[p]),w=Unx(()=>k.xDi(p),[p]),x=Unx(()=>k.ACi(p),[p]);return Snx(box,{onClose:l,open:p.open,state:p.state,Uc:q,GEi:r,LDi:t,ZDi:v,xDi:w,ACi:x})})}};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/bdb6d3977204d468.js.map