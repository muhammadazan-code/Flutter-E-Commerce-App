(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[20314],{

/***/ 18433:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(527592);__web_req__(764820);__web_req__(451596);__web_req__(204803);__web_req__(690924);__web_req__(723024);__web_req__(104149);__web_req__(421020);__web_req__(732901);__web_req__(279512);__web_req__(77779);__web_req__(283579);__web_req__(817232);__web_req__(245142);__web_req__(944264);__web_req__(56389);__web_req__(966006);__web_req__(169562);__web_req__(549685);__web_req__(48888);__web_req__(73036);__web_req__(183734);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var AHb=__c.AHb;var PF=__c.PF;var Yq=__c.Yq;var jd=__c.jd;var $q=__c.$q;var Wi=__c.Wi;var St=__c.St;var uv=__c.uv;var Uq=__c.Uq;var uu=__c.uu;var O=__c.O;var Be=__c.Be;var fa=__c.fa;var F=__c.F;var Ae=__c.Ae;var Fj=__c.Fj;var TVc=__c.TVc;var ra=__c.ra;var rf=__c.rf;var Dfe=__c.Dfe;var zk=__c.zk;var yk=__c.yk;var J=__c.J;var br=__c.br;var Ak=__c.Ak;var jB=__c.jB;var kJd=__c.kJd;var nZa=__c.nZa;var iB=__c.iB;var Cfe=__c.Cfe;var Bfe=__c.Bfe;var Vb=__c.Vb;var dd=__c.dd;var Lj=__c.Lj;var Yz=__c.Yz;
var hf=__c.hf;var Ol=__c.Ol;var sj=__c.sj;var he=__c.he;var m=__c.m;var Q=__c.Q;var Tc=__c.Tc;var R=__c.R;var M=__c.M;var xk=__c.xk;var Gv=__c.Gv;var Lb=__c.Lb;var pj=__c.pj;var Tq=__c.Tq;var u=__c.u;var Z8q=__c.Z8q;var Ee=__c.Ee;var Qk=__c.Qk;var sa=__c.sa;
var Mex=function(a,b){return(a=__c.Jex(b))?__c.kAb(a,b):void 0},Nex=function(a,b,c){a=a.Ovh(b);const d=__c.Fg.qd();let e=!0;a.forEach({...__c.ae,Ya:(f,g)=>{const h={...g};__c.kfg(c,(k,l)=>{const n=(g.hasOwnProperty(k)||e)&&!g[k];l&&n&&(h[k]=l)});d.attrs(h).Xb(f);e=!1}});return __c.Fg.create(d.build())},Oex=function(a,b,c,d){sa(b.type!=="text3");if(b.type!=="text2")return d(b);c=__c.EUf(c);return Nex(a,b.value,c)},Pex=function(a,b){a=Qk.snapshot(a);const c=Qk.qd();let d=!0;a.forEach({Kl:()=>{},...__c.jfg,
Ya:(e,f)=>{const g={...f};__c.kfg(b,(h,k)=>{const l=(f.hasOwnProperty(h)||d)&&!f[h];k&&l&&(g[h]=k)});c.attrs(g).Xb(e);d=!1}});return Qk.create(c.build())},Qex=function(a,b,c){sa(a.type!=="text2");if(a.type!=="text3")return c(a);b=__c.CA(b);return Pex(a.value,b)},Rex=function(a,b,c){const d=b.layout.cells.get(c.row,c.column),e=b.layout.attrs.get(Ee.ht,c.row,c.column)||{};return d==null||d.ref==null||d.ref.content.ref==null?a.T2b.$Tf("",e,void 0,d?.ref?.Cb.ref?.type,b.direction):Oex(a.T2b,d.ref.content.ref,
e,f=>{var g=e;switch(f.type){case "boolean":var h=a.vn.vX.nJb(f.value);break;case "plaintext":h=f.value;break;case "formula":h=`=${Z8q(a.sE,b,f.value).gna}`;break;case "number":h=d.ref.Cb.ref&&__c.tAb(d.ref.Cb.ref);f=__c.uAb(a.upa,f.value,h);h=d.ref.Cb.ref?.type==="select"?f.wmd:f.DEe;break;case "media":h="";break;case "embed":h=f.value.map(k=>k.embed.text).join(" ");g={link:f.value.first()?.embed.url??"",decoration:__c.bB.decoration};e.color||(g.color=__c.bB.color);g={...e,...g};break;case "mention":h=
f.value.map(k=>k.text).join(" ");break;default:throw new u(f);}return a.T2b.$Tf(h,g,d.ref.content.ref?.type,d.ref.Cb.ref?.type,b.direction)})},Sex=function(a,b,c){const d=b.layout.cells.get(c.row,c.column),e=b.layout.attrs.get(Ee.ht,c.row,c.column)||{};return d==null||d.ref==null||d.ref.content.ref==null?a.T2b.aUf("",e,void 0,d?.ref?.Cb.ref?.type,b.direction):Qex(d.ref.content.ref,e,f=>{var g=e;switch(f.type){case "boolean":var h=a.vn.vX.nJb(f.value);break;case "plaintext":h=f.value;break;case "formula":h=
`=${Z8q(a.sE,b,f.value).gna}`;break;case "number":h=d.ref.Cb.ref&&__c.tAb(d.ref.Cb.ref);f=__c.uAb(a.upa,f.value,h);h=d.ref.Cb.ref?.type==="select"?f.wmd:f.DEe;break;case "media":h="";break;case "embed":h=f.value.map(k=>k.embed.text).join(" ");g={link:f.value.first()?.embed.url??"",decoration:__c.bB.decoration};e.color||(g.color=__c.bB.color);g={...e,...g};break;case "mention":h=f.value.map(k=>k.text).join(" ");break;default:throw new u(f);}return a.T2b.aUf(h,g,d.ref.content.ref?.type,d.ref.Cb.ref?.type,
b.direction)})},C0=function(a,b,c,d,e,f,g){var h;let k;class l extends(h=Tex){render(){return z0(b,{...this.props,o0:this.o0,FAa:this.draggable})}constructor(...n){super(...n);this.draggable=__c.Ic.wba?void 0:new Tq({onDragStart:A0(p=>d?.(this.props,new pj(p.clientX,p.clientY))),pe:A0(p=>e?.(this.props,new pj(p.clientX,p.clientY))),onDragEnd:A0(()=>f?.(this.props))});this.Xda=[new __c.fqf({onSelect:A0(p=>c(this.props,p))}),new __c.qr({yt:A0(p=>{p.pointerType==="touch"&&g?.(this.props,p)})})].filter(__c.sb);
this.o0=B0(()=>a.mode>=20?this.Xda:[])}}({c:[k,h]}=Uex(l,[],[Lb],h));h();return k},Vex=function(a){const b=a.Pa,c=a.tTd,d=a.vTd,e=a.rTd,f=(n,p,q)=>{const r=__c.Oj({top:0,left:0,width:n.width,height:n.height});return(q=q?.current?.getBoundingClientRect())?Gv(n,__c.Ej(-q.x,-q.y),r,new pj(0,0),p):new pj(0,0)},g=C0(b,a.Aea,(n,p)=>{n.P4g?.(p,f(n.sheet,new pj(p.Li,p.zj),n.Jg))},(n,p)=>n.onDragStart?.(f(n.sheet,p,n.Jg)),(n,p)=>n.pe?.(f(n.sheet,p,n.Jg)),n=>n.onDragEnd?.()),h=C0(b,n=>z0(c,{...n}),(n,p)=>n.btb?.(p,
f(n.sheet,new pj(p.Li,p.zj),n.Jg))),k=C0(b,n=>z0(d,{...n}),(n,p)=>n.P7g?.(p,f(n.sheet,new pj(p.Li,p.zj),n.Jg))),l=C0(b,n=>z0(e,{...n}),(n,p)=>n.q5g?.(p,f(n.sheet,new pj(p.Li,p.zj),n.Jg)));return D0(n=>{const p=E0(()=>__c.hk(),[]);return z0(__c.gVr,{container:void 0,...n,Jg:p,Aea:g,tTd:h,vTd:k,rTd:l,ora:__c.hVr})})},efx=function(a,b,c,d,e){const f=Wex(b,d),g=Xex(b),h=Yex(b),k=Zex(b,d),l=$ex(b,a,c,d),n=afx(b,d),p=bfx(b,d),q=cfx(b,d);return function({context:r,twa:t,ora:v}){const w=r.container.column,
x=r.container.row,y=d.getContent(r.container.sheet,x,w);sa(y!=null);if(!dfx(()=>{const z=b.OIg?.();return z?.column===w&&z?.row===x}))switch(y.Dya?.type){case "plain_number":case "currency":case "percentage":return f(r);case "checkbox":return e?l(r):f(r);case "date":case "mention":case "select":case "embed":return y.Dya?.type!==y.Cb?.type?g(r,t):h(r,t);case void 0:switch(y.Nr?.type){case "number":case "boolean":case "plaintext":return f(r);case "mention":case "embed":return h(r,t);case void 0:return;
case "formula":return k(r);case "media":return n(r,t);case "text2":return p(r);case "text3":return q(r,v);default:throw new u(y.Nr);}default:throw new u(y.Dya);}}},Wex=function(a,b){return function(c){const d=b.getContent(c.container.sheet,c.container.row,c.container.column);sa(d!=null);return a.Y3l?.({context:c,value:d.hU,valueType:d.NC.type})}},Yex=function(a){return function(b,c){return a.X3l?.({context:b,twa:c})}},Xex=function(a){return function(b,c){return a.Utj?.({context:b,twa:c})}},Zex=function(a,
b){return function(c){const d=b.getContent(c.container.sheet,c.container.row,c.container.column);sa(d?.Nr?.type==="formula");return a.V3l?.({context:c,content:d})}},$ex=function(a,b,c,d){const e=(f,g,h,k)=>{d.getContent(f,g,h)?.Nr?.type!=="formula"&&(d.Ew(l=>{l.faa(f,{row:g,column:h},__c.Uge(k))}),c?.iS())};return function(f){const g=f.container.sheet,h=f.container.column,k=f.container.row,l=d.getContent(g,k,h);sa(l?.NC?.type===3);return a.T3l?.({context:f,value:l.NC.value,valueType:l.NC.type,onChange:b.mode>=
40?(n,p)=>e(g,k,h,p):void 0})}},afx=function(a,b){return function(c,d){const e=b.getContent(c.container.sheet,c.container.row,c.container.column);sa(e?.Nr?.type==="media");return a.W3l?.({content:e.Nr,context:c,twa:d})}},bfx=function(a,b){return function(c){const d=b.getContent(c.container.sheet,c.container.row,c.container.column);sa(d?.Nr?.type==="text2");return a.Z3l?.({content:d.Nr,context:c})}},cfx=function(a,b){return function(c,d){const e=b.getContent(c.container.sheet,c.container.row,c.container.column);
sa(e?.Nr?.type==="text3");return a.$3l?.({content:e.Nr,context:c,ora:d})}},gfx=function(a){const b=a.Pa,c=a.mZ,d=a.Gg;var e=a.Rt,f=a.GJa;const g=a.hk,h=a.KGe;c.V3l=k=>__c.gUr({...k,mZ:c,twa:()=>{}});c.Y3l=k=>__c.dVb({...k,hk:g});c.T3l=k=>__c.jVr({...k});c.W3l=__c.eUr(__c.JUr({Rt:e,GJa:f}));e=a.fd;a=a.kNl;f=new ffx;a&&(c.Z3l=__c.lVr(a,g));c.$3l=__c.eUr(k=>z0(__c.pVr,{...k,hk:g}));return{fse:efx(b,c,d,e,h),jBl:f}},hfx=function(a){const b=a.store.iug;if(b){var c=b.z8.first();if(c){var d=c.Taa;c=c.lga;
d&&c&&(d=b.layout.GA.get(d),(c=b.layout.ZA.get(c))&&d&&(a.hj.Lnc(b,__c.mZa(b,{start:{row:c.start,column:d.start},end:{row:c.end,column:d.end}})),a.s5c({TZ:!1})))}}},ifx=function(a,b,c,d){const e=a.vg.Ma,f=a.vg.Kb;if(e?.inner?.type==="sheet")switch(e.type){case "pages":a.vg.u1a(e.inner.container,b,c,d);break;case "elements":a.vg.L7a(e.inner.container,b,c,d);break;case "audio":break;default:throw new u(e);}f?.type===4&&__c.xv(a.vg,f.container,b,c,d)},jfx=function(a,b,c){a=xk(b.column,c.column,a.cols);
return Array.from(a)},lfx=async function(a,b,c){if(a.EM){var {Sr:d}=await a.EM(),{erg:e}=__c.kPr(b.Pb.kxb.source),{Kud:f}=await d.fyd(new __c.kDo({Rg:[e],nvd:a.Jf}));if(f.length){({destination:f}=f[0]);const g=a.vg.Ma;g?.type==="pages"&&f?.sheetId===g.inner?.page.id&&f?.designId===a.designId&&await d.A1h(new kfx({id:e,nvd:a.Jf}))}a.undo.TZ(async()=>{a.B1h(b,c)})}else a.B1h(b,c)},vfx=function({la:a,EM:b,eo:c,Se:d,toolbar:e,cua:f,VMc:g,undo:h,Jf:k,vg:l,o2:n,hj:p,Oub:q,Pub:r,designId:t,kb:v,V:w}){const x=
new __c.Mx,y=new __c.jv,z={Sd:()=>C.Pb!=null,Button:D0(na=>{const qa=na.yi,ua=na.onClick;na=mfx(()=>{ua?.();oa()},[ua]);return z0(qa,{onClick:na,icon:__c.ezj,zh:"icon-and-label",children:M("0Po4uw")})}),navigation:x},B=({navigation:na,hf:qa,title:ua})=>{na.$g({hf:()=>z0(__c.Vn,{children:z0(qa,{})}),options:{sg:()=>z0(R,{children:ua})}})},C=new nfx(g),G=new ofx(C,h,l,n,p,b,k,t,v,w),H={row:r-1,column:q},K=pfx(qfx(()=>f?.cSj!=null).then(()=>f?.cSj?.({mimeTypes:["text/csv",".xlsx"],V:w}))),L=D0(function(){return K.case({fulfilled:na=>
na&&C.v7j&&F0(Tc,{spacing:"1u",children:[z0(na,{toe:M("hTp1lQ"),UWl:__c.wz,Button:__c.SAj}),z0(Q,{size:"small",tone:"secondary",alignment:"center",children:M("VURn4Q")})]}),pending:()=>null,rejected:()=>null})}),N=pfx(qfx(()=>f.KVb!=null).then(()=>m(f.KVb)({navigation:{$g:na=>B({...na,navigation:y}),goBack:()=>y.goBack()},L:{cFc:na=>{G.cFc(na);oa()}},Id:{location:"sheet_actions_data_panel"},VIi:{A8:H,bre:L,GGq:B0(()=>C.v7j)}}))),P=D0(function(){return N.case({fulfilled:na=>z0(na,{}),pending:()=>z0(rfx,
{}),rejected:()=>z0(rfx,{})})}),T=D0(()=>C.v$m?z0(sfx,{To:a.layout===2,Kda:()=>G.s5c({TZ:!0})}):z0(P,{})),V=pfx(qfx(()=>f.Ttd!=null).then(()=>m(f.Ttd)({store:C,navigation:{$g:na=>B({...na,navigation:x}),goBack:()=>x.goBack(),clear:()=>x.clear()},L:{cFc:na=>G.cFc(na),s5c:()=>{G.s5c({TZ:!0});la()}},Id:{location:"sheet_actions_data_panel"},A8:H}))),W=D0(function(){return V.case({fulfilled:na=>z0(na,{}),pending:()=>z0(rfx,{}),rejected:()=>z0(rfx,{})})}),aa={header:{pa:()=>z0(tfx,{navigation:y,onClose:ma})},
pa:()=>z0(ufx,{navigation:y,onClose:ma})};let ba,da;const la=()=>{a.layout===2?da=d?.XRf(y):c.open(aa);y.clear();B({navigation:y,hf:T,title:M("xCjHwQ")});ba?.();ba=qfx(()=>C.iug==null,()=>ma())};let ja;const oa=()=>{ma();e.dC(z);x.clear();B({navigation:x,hf:()=>z0(R,{padding:"2u",children:z0(W,{})}),title:M("6Q8AoQ")});ja?.();ja=qfx(()=>C.Pb==null,()=>e.BV(z))},ma=()=>{a.layout===2?da?.():c.close(aa)};return{ORf:la,eMu:oa,x8e:na=>{const qa=g();switch(na){case "sheet-import-data-suggested":return qa!=
null&&__c.NVa(qa.sheet);case "sheet-import-data-action":return qa!=null;default:throw new u(na);}},Nnq:z}},wfx=function({la:a,EM:b,he:c,Se:d,eo:e,cua:f,Jd:g,toolbar:h,VMc:k,undo:l,Jf:n,vg:p,o2:q,hj:r,Pub:t,Oub:v,designId:w,kb:x,V:y}){const {ORf:z,x8e:B,Nnq:C}=vfx({la:a,EM:b,cua:f,eo:e,Se:d,toolbar:h,VMc:k,undo:l,Jf:n,vg:p,o2:q,hj:r,Pub:t,Oub:v,designId:w,kb:x,V:y});c&&["sheet-import-data-suggested","sheet-import-data-action"].forEach(G=>c.ym(()=>B(G),{type:"simple",key:G,name:M("HH3x+g"),Icon:__c.I6j,
execute:async()=>{z()}}));g.plugins.cIb=()=>C},Afx=function(a){const b=a.viewport,c=a.mc,d=a.lkk,e=a.fd,f=a.Mdb,g=a.Ly,h=new xfx(b,g);return D0(({RFp:k,...l})=>{const {tb:n}=d()||{};var p=l.isComposing.get();h.Hpo(p);yfx(()=>{h.tA=n;h.Kqg()},[n]);yfx(()=>{h.setup();return()=>{h.dispose()}},[]);if(!n||c?.state?.type==="focused"||!g.RW||!b.uh)return z0("div",{className:"b8APwA",children:z0(k,{})});l=h.emg;if(!l)return z0("div",{className:"b8APwA",children:z0(k,{})});var q=g.sheet;const r=he(Ee,q.layout.attrs.get(Ee.ht,
n.row,n.column)||{});q=new __c.jVb(e,f,q,n.column,n.row,{get:()=>1},()=>{},()=>{});p=G0("StCJpA",{MVLxMQ:!p});var t={top:l.top,left:l.left,width:l.width,height:l.height,transform:`rotate(${l.rotation}deg)`,alignItems:zfx(r.Ki)};a:switch(q.textStyle?.tb.textAlign){case "center":var v={left:"50%",transform:"translateX(-50%)"};break a;case "right":v={left:"100%",transform:"translateX(-100%)"};break a;default:v={left:0}}return F0("div",{className:p,style:t,children:[z0(k,{style:{...q.textStyle?.tb,...v},
className:"csIygQ"}),z0("div",{className:"tAo2CA",style:{width:l.width,height:l.height,backgroundColor:r.n1}})]})})},zfx=function(a){switch(a){case "start":case "end":return a;case "middle":return"center";default:throw new u(a);}},Cfx=function(a){const b=a.Im.Mcm(a.x7r),c=Bfx(a.Zcs);return()=>{b();c()}},Dfx=function(a){const b=a.Im.Mcm(a.w7r),c=Bfx(a.$cs);return()=>{b();c()}},Efx=function(a,b,c){const d=c.vB,e=c.gM;return Gv(b,c.$R,d,b.direction==="rtl"?sj(d.tr,e.tr):sj(d.tl,e.tl),a)},Ffx=function(a,
b,c){switch(b.type){case 2:setTimeout(A0(()=>a.Im.focus({offset:a.Im.formula.length,length:0})),0);break;case 0:a.mc?.fBa(a.selection.Ma,c);break;case 1:sa(a.selection.Kb?.type===4);const d=__c.Xra(a.selection.Kb.container.XZ(b.tb.column,b.tb.row),b.Sc);a.ncf.register(b.Sc,d);setTimeout(()=>{a.selection.qv(d,d.text,c==="all"?__c.Gw.all():__c.Gw.end())},0);break;default:throw new u(b);}},Gfx=function(a,b){switch(b.type){case 2:case 0:break;case 1:a.ncf.unregister(b.Sc);break;default:throw new u(b);
}},Hfx=function(a,b){const c=a.selection.Kb;c!=null&&c.type!==4&&c.container.type==="sheet-item-cell-richtext"&&__c.xv(a.selection,c.container.container.container,b,b,[b])},Ifx=function(a,b,c){var d=a.store.draft;if(d){Gfx(a.config,d);var e=d.tb,f=d.sheet;switch(b){case 0:sa(d.type===2);d=f.layout.attrs.get(Ee.ht,e.row,e.column)||{};b=a.store;e={type:0,tb:e,sheet:f,Sc:a.config.$Tf(m(c),f,d)};b.NDc=e;Ffx(a.config,a.store.draft,"end");break;case 1:sa(d.type===2);d=f.layout.attrs.get(Ee.ht,e.row,e.column)||
{};b=a.store;e={type:1,tb:e,sheet:f,Sc:a.config.aUf(m(c),f,d)};b.NDc=e;Ffx(a.config,a.store.draft,"end");break;case 2:sa(d.type===0||d.type===1);c=d.type===0?a.config.RYf(d.Sc):a.config.SYf(d.Sc);a.Im.Jhc(c);a.store.NDc={type:2,tb:e,sheet:f,formula:c};Ffx(a.config,a.store.draft,"end");Hfx(a.config,a.store.draft.tb);break;default:throw new u(b);}}},Jfx=function(a,b,c,d){if(d.startsWith("="))return{type:2,tb:c,sheet:b,formula:d};var e=c.row,f=c.column;const g=b.layout.cells.get(e,f);e=b.layout.attrs.get(Ee.ht,
e,f);a=a.T2b.$Tf(d,e,g?.ref?.content?.ref?.type,g?.ref?.Cb?.ref?.type,b.direction);return{type:0,tb:c,sheet:b,Sc:a}},Kfx=function(a,b,c,d){if(d.startsWith("="))return{type:2,tb:c,sheet:b,formula:d};var e=c.row,f=c.column;const g=b.layout.cells.get(e,f);e=b.layout.attrs.get(Ee.ht,e,f);a=a.T2b.aUf(d,e,g?.ref?.content?.ref?.type,g?.ref?.Cb?.ref?.type,b.direction);return{type:1,tb:c,sheet:b,Sc:a}},Lfx=function(a,b,c){const d=c.layout.cells.get(b.row,b.column),e=a.gye.getContent(c,b.row,b.column);if(d&&
e&&e.Nr){switch(e.Nr.type){case "formula":a=a.config.Cme(d?.ref?.content.ref,c);b={type:2,tb:b,sheet:c,formula:a};break;default:a=Rex(a.gye,c,b);if(!a)return;b={type:0,tb:b,sheet:c,Sc:a}}return b}},Mfx=function(a,b,c){const d=c.layout.cells.get(b.row,b.column),e=a.gye.getContent(c,b.row,b.column);if(d&&e&&e.Nr){switch(e.Nr.type){case "formula":a=a.config.Cme(d?.ref?.content.ref,c);b={type:2,tb:b,sheet:c,formula:a};break;default:a=Sex(a.gye,c,b);if(!a)return;b={type:1,tb:b,sheet:c,Sc:a}}return b}},
Nfx=function(a,{ase:b,fhf:c,ehf:d,feg:e,Rpj:f,Tpj:g,Spj:h,Upj:k}){a.ase=b;a.fhf=c;a.ehf=d;a.feg=e;a.Rpj=f;a.Tpj=g;a.Spj=h;a.Upj=k;a.e6e()},Ofx=function(a,b,c){b=c.layout.cells.get(b.row,b.column);if(!b)return!0;if(b.ref.content.ref==null)switch(b.ref.Cb.ref?.type){case void 0:case "plain_number":case "currency":case "percentage":case "checkbox":return!0;case "date":case "select":case "mention":case "embed":return a.length!==0;default:throw new u(b.ref.Cb.ref);}else switch(b.ref.content.ref?.type){case void 0:case "formula":case "boolean":case "number":case "plaintext":case "text2":case "text3":return!0;
case "media":return a.length!==0;case "mention":return b.ref.content.ref.value.map(d=>d.text).join(" ")!==a;case "embed":return b.ref.content.ref.value.map(d=>d.embed.text).join(" ")!==a;default:throw new u(b.ref.content.ref);}},cgx=function(a){var b=a.session;const c=a.canvas;var d=a.Pa;const e=a.viewport;var f=a.selection;const g=a.mc,h=a.sE;var k=a.Im;const l=a.Ind,n=a.mTb,p=a.uzp,q=a.wzp,r=a.vzp,t=a.xzp;var v=a.T2b;const w=a.ncf,x=a.hk,y=a.QA;var z=a.a3j;const B=a.fd,C=a.jBl,G=a.Ly,H=a.Goh,K=
a.Mdb;var L=a.vJ;const N=a.kJa,P=a.ps;var T=a.undo;const V=a.$xa,W=a.V;a=a.P;const aa=new Pfx;f=new Qfx(f,g,h,k,w);const ba=new Rfx(d,f,aa,k,v,T,B,L,V,z,b.mk,W,a);b=new Sfx(ba,k,f);const da=new Tfx(g,b);d=p?D0(({text:va,selection:xa,dIa:Ba,TY:pa,gd:ia})=>z0(p,{text:va,selection:xa,writingMode:1,Ki:"start",zv:2,Lc:void 0,gd:ia,JF:Ba,TY:pa,fBg:!1})):void 0;k=r?D0(({text:va,selection:xa,dIa:Ba})=>z0(r,{text:va,selection:xa,yba:N.map,dIa:Ba,qhk:!0,PK:!0,className:"blNcTQ",tN:"ciW4SA"})):void 0;v=va=>
D0(({page:xa,gd:Ba})=>{const pa=ba.store.draft;return pa&&g&&z0(Ufx,{parent:xa,Ind:l,oEp:va,mc:g,hta:da.hta,ita:da.ita,$vc:da.$vc,dIa:da.dIa,gd:Ba,TY:da.TY,draft:pa})});z=q?D0(({text:va})=>z0(q,{text:va,Lc:void 0,animation:void 0,AW:[],writingMode:1,Ki:"start",hk:x,gwa:!0,REa:!1})):void 0;L=D0(({text:va})=>z0(Vfx,{text:va}));T=va=>D0(({page:xa,i5e:Ba})=>{if(xa.sheet){xa=xa.sheet;let pa=ba.store.draft;!pa&&xa&&Ba?pa=Lfx(ba,Ba,xa):pa?.type===2&&(pa={...pa,formula:ba.Im.formula});Ba=pa}else Ba=null;
return Ba&&z0(Wfx,{content:Ba,CEp:va,mTb:n})});const la=()=>{var va=y.Uu(Ol.Sw);if(va){var xa=va.inner;va=va.container;if(xa!=null)xa=xa.anchor;else{switch(va.type){case "sheet-element":xa=va.ia.config;break;case "sheet-item":xa=va.ia.config;break;case "fixed-page":xa=va.ia.sheet;break;default:throw new u(va);}var Ba=xa.layout.cols;xa={row:m(xa.layout.rows.first()),column:m(Ba.first())}}Ba=g?.state&&g.state.type==="focused"&&g.state.contentType===4&&g.state.tb?g.state.tb:void 0;return xa?{tb:xa,pMp:Ba,
container:va}:void 0}};Xfx(()=>la(),va=>{const xa=ba.store.draft;if(xa){var {tb:Ba,pMp:pa}=va||{};xa.type===0&&pa&&Ba&&pa.column===Ba.column&&pa.row===Ba.row||(xa.type!==0||pa?Ba?xa.tb.column===Ba.column&&xa.tb.row===Ba.row||ba.uOa():ba.uOa():ba.uOa())}},{equals:Yfx.structural});const ja=H0.box();c.jc(()=>{const va=y.Uu(Ol.Sw);return va?.container.type==="sheet-element"||va?.container.type==="fixed-page"?va:void 0},(va,xa)=>{va.Bg.qDc=xa?D0(Ba=>{const pa=Ba.page.page;Ba=Ba.Tc;if(!G.RW||!C.MIh||!hf(pa)&&
e.uh&&e.uK)return null;const ia=ba.store.draft,{tb:wa}=la()||{};return wa&&ia&&pa===xa.page&&ia.tb.column===wa.column&&ia.tb.row===wa.row?z0(Yz,{Amc:wa,wz:G,page:pa,overflow:!0,children:z0(Zfx,{b3h:ia.type!==2||hf(pa)?Ba.scale:Math.max(.6,Ba.scale),bel:Ba.scale,Mdb:K,fd:B,tA:wa,sheet:ia.sheet,Ijm:ia.type===2?"hsla(0, 0%, 100%, 1)":void 0,rIm:ia.type===2,onClick:()=>{$fx(()=>{ba.gvb(wa,ia.sheet,"CELL_OVERLAY",0)})},WCn:A0(Ca=>{var Ha=ja.set;a:{var Oa=y.Uu(Ol.Sw);if(Oa!=null){var Ka=Ca.current?.getBoundingClientRect();
if(Ka){Ca=Efx({x:Ka.x,y:Ka.y},Oa.sheet,G);Oa=Efx({x:Ka.x+Ka.width,y:Ka.y+Ka.height},Oa.sheet,G);Ca=Lj(Math.min(Ca.x,Oa.x),Math.min(Ca.y,Oa.y),Math.max(Ca.x,Oa.x),Math.max(Ca.y,Oa.y));break a}}Ca=void 0}return Ha.call(ja,Ca)}),children:z0(C.MIh,{page:pa,gd:Ba.scale})})}):null}):void 0});const oa=new agx(b),ma=D0(({Tc:va,Pxb:xa,Vp:Ba,Jg:pa})=>aa.draft?z0(bgx,{draft:aa.draft,zaa:t,Ind:l,Tc:va,Pxb:xa,Vp:Ba,Jg:pa,ita:oa.ita,hta:oa.hta}):null);Xfx(()=>la(),va=>{const xa=ba.store.draft;if(xa)if(va){var Ba=
va.tb.row;xa.tb.column===va.tb.column&&xa.tb.row===Ba||ba.uOa()}else ba.uOa()},{equals:Yfx.structural});c.jc(()=>la(),(va,xa)=>{va.Bn.FL.qDc=xa?D0(()=>{const Ba=xa.container;if(!G.RW||!C.Pqj||Ba.type!=="sheet-item")return null;const pa=ba.store.draft,ia=H.C5m(Ba.ia),wa=xa.tb;if(!pa||!ia||pa.tb.column!==wa.column||pa.tb.row!==wa.row)return null;const Ca=ia.Tc,Ha=ia.Vp,Oa=C.Pqj;return z0(Yz,{Amc:wa,wz:G,page:void 0,children:z0(Zfx,{b3h:pa.type===2?Math.max(.6,G.gd):G.gd,bel:G.gd,Mdb:K,fd:B,tA:wa,sheet:pa.sheet,
Ijm:pa.type===2?"hsla(0, 0%, 100%, 1)":void 0,rIm:pa.type===2,onClick:()=>{$fx(()=>{ba.gvb(wa,pa.sheet,"CELL_OVERLAY",1)})},children:Oa&&z0(__c.vp,{map:N.map,Hr:!0,children:({ref:Ka})=>z0(Oa,{Jg:Ka,Tc:{...Ca,zoom:1},Pxb:Ba,Vp:Ha})})})})}):void 0},{equals:Yfx.structural});const na=d?v(d):void 0,qa=k?v(k):void 0,ua=z?T(z):void 0,za=T(L);[ba,ba].forEach(va=>Nfx(va,{ase:na,fhf:ma,ehf:qa,feg:ma,Rpj:ua,Tpj:ma,Spj:za,Upj:ma}));P.Q5.w9a=Afx({viewport:e,mc:g,lkk:la,fd:B,Mdb:K,Ly:G});return{ZU:ba,lkk:la,SKj:ja}},
fgx=function(a){const b=a.K5e,c=a.e5h,d=a.scale,e=a.onDragStart,f=a.pe,g=a.onDragEnd;a=E0(()=>new dd([new __c.ed({yt:A0(h=>e(new pj(h.Li,h.zj))),IF:A0(h=>f(new pj(h.Li,h.zj))),tx:A0(()=>g())})]),[e,f,g]);return F0(I0,{children:[z0(dgx,{K5e:b,scale:d,lPa:a.Gq}),z0(egx,{e5h:c,scale:d})]})},jgx=function(a){const b=a.canvas,c=a.viewport,d=a.Pa,e=a.Mgb,f=a.vJ,g=a.Ly,h=a.JEk;a=new ggx(a.QA);const k=new hgx(a,g,f),l=new igx(k,q=>{b.dva=q?"oEXCqA":void 0}),n=D0(function(q){const r=k.selection;return!r||r.page!==
q.page.page||h()||!hf(r.page)&&c.uh&&c.uK?null:z0(Yz,{wz:g,page:q.page.page,children:z0(fgx,{K5e:r.K5e,e5h:void 0,scale:q.Tc.scale,onDragStart:l.onDragStart,pe:l.pe,onDragEnd:l.onDragEnd})})}),p=D0(function(){const q=k.selection;return!q||h()?null:z0(Yz,{wz:g,page:void 0,children:z0(fgx,{K5e:q.K5e,e5h:void 0,scale:g.gd,onDragStart:l.onDragStart,pe:l.pe,onDragEnd:l.onDragEnd})})});b.jc(()=>d.mode===40&&!Vb(window)&&!e.isActive,(q,r)=>{r?(q.Bg.X6b=n,q.Bn.FL.X6b=p):(q.Bg.X6b=void 0,q.Bn.FL.X6b=void 0)})},
kgx=function(a,b){var c=a.layout.cols;const d=[...xk(b.$b,b.df,a.layout.rows)];b=[...xk(b.ec,b.jf,c)];c=[];for(const e of d)for(const f of b)a.layout.cells.get(e,f)?.ref.content.ref&&c.push({row:e,column:f});return __c.zfe(a,c)},mgx=function(a,b,c){var d=Bfe(c,a);c=Cfe(c,a);if(d&&c){var e,f;a.layout.cols.dj(c,b.ec)<0?e={start:c,end:m(a.layout.cols.previous(b.ec)),direction:1}:a.layout.cols.dj(c,b.jf)>0&&(e={start:m(a.layout.cols.next(b.jf)),end:c,direction:0});a.layout.rows.dj(d,b.$b)<0?f={start:d,
end:m(a.layout.rows.previous(b.$b)),direction:3}:a.layout.rows.dj(d,b.df)>0&&(f={start:m(a.layout.rows.next(b.df)),end:d,direction:2});if(e||f){if(f&&e){d=e.start;c=e.end;e=e.direction;const g=f.start,h=f.end;f=f.direction;const k=lgx(d,c,a.layout.cols);a=lgx(g,h,a.layout.rows);return k.length>a.length?{$b:b.$b,ec:d,df:b.df,jf:c,direction:e}:{$b:g,ec:b.ec,df:h,jf:b.jf,direction:f}}if(e)return{$b:b.$b,ec:e.start,df:b.df,jf:e.end,direction:e.direction};if(f)return{$b:f.start,ec:b.ec,df:f.end,jf:b.jf,
direction:f.direction}}}},lgx=function(a,b,c){const d=[a];for(;a&&a!==b;)(a=c.next(a))&&d.push(a);return d},ngx=function(a,b,c){return a.layout.rows.dj(b,c.$b)>=0&&a.layout.rows.dj(b,c.df)<=0},ogx=function(a,b,c){return a.layout.cols.dj(b,c.ec)>=0&&a.layout.cols.dj(b,c.jf)<=0},pgx=function(a,b){switch(b){case 0:return{row:a.$b,col:a.ec};case 1:return{row:a.$b,col:a.jf};case 2:return{row:a.$b,col:a.ec};case 3:return{row:a.df,col:a.ec};default:throw new u(b);}},qgx=function(a,b,c,d,e,f){let g=b,h=c;
switch(e){case 0:h=c!==d.jf?a.layout.cols.next(c):f?d.ec:void 0;break;case 1:h=c!==d.ec?a.layout.cols.previous(c):f?d.jf:void 0;break;case 2:g=b!==d.df?a.layout.rows.next(b):f?d.$b:void 0;break;case 3:g=b!==d.$b?a.layout.rows.previous(b):f?d.df:void 0;break;default:throw new u(e);}return{row:g&&ngx(a,g,d)?g:void 0,col:h&&ogx(a,h,d)?h:void 0}},rgx=function(a,b,c){if((a=a.layout.cells.get(b,c))&&a.span.$b===b&&a.span.ec===c)return a},sgx=function(a,b){return{$b:b,ec:a.ec,df:b,jf:a.jf}},tgx=function(a,
b){return{$b:a.$b,ec:b,df:a.df,jf:b}},ugx=function(a,b){switch(b){case 0:case 1:return sgx(a,a.$b);case 2:case 3:return tgx(a,a.ec);default:throw new u(b);}},vgx=function(a,b,c,d){const e=b.$b;b=b.ec;switch(d){case 0:case 1:return(d=a.layout.rows.next(e))&&ngx(a,d,c)?sgx(c,d):void 0;case 2:case 3:return(d=a.layout.cols.next(b))&&ogx(a,d,c)?tgx(c,d):void 0;default:throw new u(d);}},wgx=function(a,b,c){let d=c.$b;var e=b;const f=[];for(;d!=null;){let g=c.ec;for(;g!=null;){f.push(e);const h=a.layout.cols.next(e.column);
if(!h)break;e={row:e.row,column:h};g=g!==c.jf?a.layout.cols.next(g):void 0}e=a.layout.rows.next(e.row);if(!e)break;e={row:e,column:b.column};d=d!==c.df?a.layout.rows.next(d):void 0}return f},ygx=function(a,b,c,d){const e=d.direction;let f=ugx(c,e),g=ugx(d,e);const h=new iB;a.fd.Ew(k=>{for(;f&&g;){var l=b,n=f;const p=[],{row:q,col:r}=pgx(n,e);let t=q,v=r;for(;t!=null&&v!=null;){const w=rgx(l,t,v);w?.ref.content.ref?p.push({location:{row:t,column:v},content:w?.ref.content.ref}):p.push(void 0);const {row:x,
col:y}=qgx(l,t,v,n,e);t=x;v=y}l=a.lVq.Zxd(b,p);xgx(a,b,f,g,e,l,h,k);f=vgx(b,f,c,e);g=vgx(b,g,d,e)}})},zgx=function(a,b){const c=new Map,d=new Map;for(const f of a){a=b.layout.cells.get(f.row,f.column);var e=a?.ref.content.ref;e&&(e=e.type.toString(),c.set(e,(c.get(e)??0)+1));if(a=a?.ref.Cb.ref)a=a.type.toString(),d.set(a,(d.get(a)??0)+1)}return{Oe:c,Zci:d}},xgx=function(a,b,c,d,e,f,g,h){const {row:k,col:l}=pgx(c,e),{row:n,col:p}=pgx(d,e);let q=k,r=l,t=n,v=p;for(;t&&v&&q&&r;){var w=rgx(b,q,r)?.span??
{ec:r,$b:q,jf:r,df:q},x=b.layout.cells.get(t,v);x=x&&!g.has([x.span.$b,x.span.ec])?x.span:{ec:v,$b:t,jf:v,df:t};if(w.$b!==w.df||w.ec!==w.jf||x.$b!==x.df||x.ec!==x.jf)w=wgx(b,{row:t,column:v},w),w.forEach(H=>{__c.Tps(b,H)&&a.hj.Kld(b,H)}),a.hj.fXd(b,w)&&a.hj.mergeCells(b,w),g.add([t,v]);w=f.lec({row:t,column:v});if(b.layout.cells.get(t,v)==null||rgx(b,t,v)){const H=b.layout.attrs.get(Ee.ht,q,r)||{};var y=b.layout.cells.get(q,r)?.ref.Cb.ref;y=y&&__c.PNc.snapshot(y);a.hmh(b,x,w,y,H,h)}const {row:z,col:B}=
qgx(b,q,r,c,e,!0),{row:C,col:G}=qgx(b,t,v,d,e);q=z;r=B;t=C;v=G}},Agx=function(a){if(!a.some(b=>b.content.type!=="formula"))return a},Cgx=function(a,b){const c=[];for(var d of b){b=Bgx(a,d);if(b==null)return;c.push(b)}if(c.length<=1)return 1;let e;for(a=1;a<c.length;a++)if(d=c[a]-c[a-1],e==null)e=d;else if(d!==e)return;return e},Bgx=function(a,b){a=a.Vuh.findIndex(c=>b===c);return a===-1?void 0:a},Egx=function(a,b,c){return c.reduce((d,e)=>{var f=d[d.length-1];let g=!1;if(f){a:{switch(f.type){case "content":if(e==
null){f=void 0;break a}break;case "undefined":if(e==null){f={...f,sequence:[...f.sequence,e]};break a}break;default:throw new u(f);}if(f.type!=="undefined"){var h=f.oXm;if(h.type!=="duplicate"){var k=[...f.sequence,e];f=h.Zxd(k)!=null?{...f,sequence:k}:void 0;break a}}f=void 0}f&&(d[d.length-1]=f,g=!0)}g||(e=e?{type:"content",oXm:Dgx(a,b,e),sequence:[e]}:{type:"undefined",sequence:[e]},d.push(e));return d},[]).flatMap(d=>{const e=d.type==="content"?m(d.oXm.Zxd(d.sequence)):a.YPo;return Array(d.sequence.length).fill(e)})},
Dgx=function(a,b,c){return[new Fgx(a.vn.vX.H9b.L$),new Fgx(a.vn.vX.H9b.K$),new Ggx,new Hgx(b,a.sE,a.Nma)].find(d=>d.Zxd([c]))??new Igx},Jgx=function(a,b,c,d){let e=Bfe(d,a);d=Cfe(d,a);if(e&&d){switch(c.position){case "top-start":a.layout.rows.dj(b.df,e)<0&&(e=b.df);a.layout.cols.dj(b.jf,d)<0&&(d=b.jf);c={row:e,column:d};b={row:b.df,column:b.jf};break;case "bottom-end":a.layout.rows.dj(e,b.$b)<0&&(e=b.$b);a.layout.cols.dj(d,b.ec)<0&&(d=b.ec);c={row:b.$b,column:b.ec};b={row:e,column:d};break;default:throw new u(c.position);
}return nZa(a,c,b)}},Tgx=function(a){const b=a.canvas,c=a.viewport,d=a.Pa;var e=a.vn;const f=a.Mgb,g=a.Ih,h=a.sE,k=a.Nma,l=a.vJ,n=a.fd,p=a.hj,q=a.Ly,r=a.Gia,t=a.he,v=a.JEk,w=a.V,x=a.P,y=H=>{b.dva=H?"h86poQ":void 0};a=new ggx(a.QA);const z=new Kgx(a,q,l);e=new Lgx(e,h,k,n,p,new Mgx(e,h,k));const B=new Ngx(z,q,r,g,e,y,w,x),C=new Ogx(z,e);t?.ym(()=>Vb(window)&&C.EIj,{type:"simple",key:"autofill",name:M("WkVniw"),Icon:Pgx,execute:async()=>{if(C.EIj){var H=C.store.selection;if(H){var K=H.source;H=H.sheet;
var L=kgx(H,K);if(L){a:{for(const P of C.i9o){b:{var N=H.layout.rows;const T=H.layout.cols;switch(P){case 2:if(!(N.dj(K.df,L.df)>0))break;N=N.next(L.df);if(!N)break;N={$b:N,df:K.df,ec:L.ec,jf:L.jf,direction:P};break b;case 3:if(!(N.dj(K.$b,L.$b)<0))break;N=N.previous(L.$b);if(!N)break;N={$b:K.$b,df:N,ec:L.ec,jf:L.jf,direction:P};break b;case 0:if(!(T.dj(K.jf,L.jf)>0))break;N=T.next(L.jf);if(!N)break;N={$b:L.$b,df:L.df,ec:N,jf:K.jf,direction:P};break b;case 1:if(T.dj(K.ec,L.ec)<0&&(N=T.previous(L.ec))){N=
{$b:L.$b,df:L.df,ec:K.ec,jf:N,direction:P};break b}}N=void 0}if(N){K=N;break a}}K=void 0}K&&ygx(C.oBl,H,L,K)}}}}});b.jc(()=>d.mode===40&&!Vb(window)&&!f.isActive,(H,K)=>{H.Bg.sDc=K?D0(L=>{const N=z.selection;return!N||N.page!==L.page.page||v()||!q.RW||!N.nEe||!hf(N.page)&&c.uh&&c.uK?null:z0(Yz,{wz:q,page:L.page.page,children:z0(Qgx,{bLm:N.nEe,Byf:z.Byf,scale:L.Tc.scale,onDragStart:B.onDragStart,pe:B.pe,onDragEnd:B.onDragEnd,isDragging:B.isDragging,ko:q.sheet.direction==="rtl"})})}):void 0});const G=
new Rgx(z,q,r,l,g,y);b.jc(()=>d.mode===40&&Vb(window)&&!f.isActive,(H,K)=>{H.Bg.tDc=K?D0(L=>{const N=z.selection;return!N||N.page!==L.page.page||v()&&!l.active||!q.RW||!hf(N.page)&&c.uh&&c.uK?null:z0(Yz,{wz:q,page:L.page.page,children:z0(Sgx,{xwh:{point:N.aLm,position:"top-start"},hmm:{point:N.$Km,position:"bottom-end"},hK:G.hK,scale:L.Tc.scale,onDragStart:G.onDragStart,pe:G.pe,onDragEnd:G.onDragEnd})})}):void 0});b.jc(()=>d.mode===40&&!Vb(window)&&!f.isActive,(H,K)=>{H.Bn.FL.sDc=K?D0(()=>{const L=
z.selection;return L&&!v()&&q.RW&&L.nEe?z0(Yz,{wz:q,page:void 0,children:z0(Qgx,{bLm:L.nEe,Byf:z.Byf,scale:q.gd,onDragStart:B.onDragStart,pe:B.pe,onDragEnd:B.onDragEnd,isDragging:B.isDragging,ko:q.sheet.direction==="rtl"})}):null}):void 0});b.jc(()=>d.mode===40&&Vb(window)&&!f.isActive,(H,K)=>{H.Bn.FL.tDc=K?D0(()=>{const L=z.selection;return!L||v()&&!l.active||!q.RW?null:z0(Yz,{wz:q,page:void 0,children:z0(Sgx,{xwh:{point:L.aLm,position:"top-start"},hmm:{point:L.$Km,position:"bottom-end"},hK:G.hK,
scale:q.gd,onDragStart:G.onDragStart,pe:G.pe,onDragEnd:G.onDragEnd})})}):void 0})},Ugx=function(a){const b=a.Pa,c=a.cua,d=a.viewport,e=a.pd,f=a.QA;return{qKr:g=>D0(h=>{if(!c.xAe)return z0(g,{...h});const k=h.container,l=new __c.Xz(k,d,b),n=c.xAe(p=>z0(g,{...p}));return z0(n,{...h,sheet:k,FE:l,muf:k,$Zf:p=>f.IAa(k,[p],p,p,[],[])})}),oKr:g=>D0(h=>{if(!c.xAe)return z0(g,{...h});const k=new __c.Wz(h.element,d),l=c.xAe(n=>z0(g,{...n}));if(h.element.container.type==="group-element"||h.element.container.type===
"controlled-element")throw new kJd;return z0(l,{...h,sheet:h.element,muf:h.element.container,FE:k,$Zf:n=>f.IAa(h.element,[n],n,n,[],[])})}),pKr:g=>D0(h=>{if(!c.xAe)return z0(g,{...h});const k=h.iJ.ew(h.item),l=new __c.Zz(k,e,d),n=c.xAe(p=>z0(g,{...p}));return z0(n,{...h,sheet:k,FE:l,muf:h.iJ,$Zf:p=>f.IAa(k,[p],p,p,[],[])})})}},Wgx=function(a){return()=>z0(Vgx,{symbol:a})},Xgx=function(a,b){a=a.map(c=>c);return b?a.sort(c=>c.row===b.row&&c.column===b.column?-1:0):a},Zgx=function(a){return Ygx.some(b=>
a.type===b)},$gx=function(a){if(a.aea==null)return 0;const b=a.aea.sheet;var c=a.aea.anchor;const d=a.aea.cells;if(a.flags.M6||a.flags.N6&&d.length>500)return a.wfn(b,c)??0;for(const e of d)if(c=a.wfn(b,e),c!=null)return c;return 0},chx=function(a,b,c){if(b.aea!=null){var d=a.V.wb("sheets_number_formatting_menu_used",{Hb:{name:"editor.editing.sheet.cell.formatting"}}),e=new Map,f=new Map,g=b.aea.sheet,h=b.aea.cells;a.fd.Ew(k=>{h.forEach(l=>{const n=a.fd.getContent(g,l.row,l.column);({Oe:e,bVf:f}=
ahx(n,e,f));k.m2(g,l,c)})});d?.ob().wk(({Oi:k})=>{var l=a.P,n=l.track,p=bhx(c);a:{if(c)switch(c.type){case "plain_number":var q=new Map([["precision",c.Fj.Dw.toString()],["grouping",c.Fj.dr.toString()]]);break a;case "currency":q=new Map([["symbol",c.Fj.symbol],["position",c.Fj.position],["locale",c.Fj.locale??""],["precision",c.Fj.Dw.toString()],["grouping",c.Fj.dr.toString()]]);break a;case "percentage":q=new Map([["precision",c.Fj.Dw.toString()],["grouping",c.Fj.dr.toString()]]);break a;case "date":break;
default:throw new u(c);}q=void 0}n.call(l,__c.EMe,{action:"format_type_changed",L_q:p,Qik:q,L3g:h.length,Oe:e,bVf:f,location:"toolbar",Tb:k()})});d?.end()}},dhx=function(a,b,c){b.n1h.some(d=>a.OT.wUb(d.Cb,c.Cb))||(b.Jeh=[c,...b.Jeh.filter(d=>!a.OT.wUb(d.Cb,c.Cb))].slice(0,2))},ahx=function(a,b,c){b=new Map(b);c=new Map(c);const d=a?.Nr?.type.toString();d&&b.set(d,(b.get(d)??0)+1);a=a?.Cb?a.Cb.type.toString():"default";c.set(a,(c.get(a)??0)+1);return{Oe:b,bVf:c}},bhx=function(a){switch(a?.type){case void 0:return"default";
case "plain_number":return"number";case "currency":return"currency";case "percentage":return"percentage";case "date":return"date";default:throw new u(a);}},ohx=function(a){const b=a.keyboardShortcuts,c=a.document,d=a.Jd,e=a.HCe,f=a.la,g=a.fd,h=a.ZU,k=a.OT,l=a.V,n=a.P,p=new ehx(a.vn,a.QA,g,k,{M6:a.M6,N6:a.N6}),q=new fhx(g,h,k,l,n);b.register([__c.v5b(__c.Oo("1")),()=>{q.xNg(p,"plain_number")},M("UeTlZw"),["edit"]]);b.register([__c.v5b(__c.Oo("3")),()=>{q.xNg(p,"date")},M("FJQ0JA"),["edit"]]);b.register([__c.v5b(__c.Oo("4")),
()=>{q.xNg(p,"currency")},M("xd7C1g"),["edit"]]);b.register([__c.v5b(__c.Oo("5")),()=>{q.xNg(p,"percentage")},M("Kn0x6g"),["edit"]]);Xfx(()=>c.language,()=>{q.Dtm(p)});const r=D0(({oa:B,rIi:C})=>{const G=mfx(H=>{q.SMe(p,H);B()},[B]);return z0(ghx,{gMc:p.n1h,yBs:p.Jeh,mq:p.Hie,wUb:p.wUb,OXe:G,rIi:C})}),t=D0(()=>{const B=mfx(C=>{q.SMe(p,C)},[]);return z0(hhx,{categories:p.Wik,mq:p.Hie,wUb:p.wUb,OXe:B})}),v=ihx(({oa:B})=>{const C=mfx(()=>{B();e.LJ?.()},[B]);return z0(jhx,{f2r:C})}),w=new __c.Mx,x={Sd:()=>
p.hTh,Button:D0(({onClick:B,...C})=>{const G=mfx(()=>{B?.();w.$g({hf:({oa:H})=>{const K=mfx(()=>{w.$g({hf:t,options:{sg:()=>M("l5xPAA")},sb:()=>z0(v,{oa:H})})},[H]);return z0(r,{oa:H,rIi:K})},options:{sg:()=>M("l5xPAA")}})},[B]);return z0(khx,{...C,icon:p.KPl,selected:p.IPl,onClick:G})}),navigation:w},y={Sd:()=>p.hTh,Button:D0(B=>z0(khx,{...B,icon:p.KPl,selected:p.IPl})),pa:D0(({oa:B,KG:C})=>{const G=mfx(()=>{C?.({pa:t,vv:{sg:lhx},sb:()=>z0(v,{oa:B})})},[C,B]);return z0(r,{oa:B,rIi:G})})};d.plugins.bHb=
()=>f.layout===2?x:y;const z=B=>q.Hgm(p,B);d.plugins.aHb=()=>({Sd:()=>p.hTh,Button:D0(({yi:B,...C})=>z0(B,{ariaLabel:M("q4S/TQ"),tooltip:M("q4S/TQ"),zh:"icon",pressed:C.open,icon:mhx,...C,children:M("q4S/TQ")})),pa:D0(()=>z0(nhx,{uya:p.gEm,onChange:z}))})},qhx=function({ZHg:a,ZU:b,W1f:c,Gg:d,selection:e,vJ:f,QA:g,Gia:h}){const k=new phx(e,d,b,c,f,g,h);a.onEnter=A0(()=>k.uOa("down"));a.r7k=A0(l=>{l.preventDefault();k.uOa("right")});a.IOb=A0(()=>k.Ngg());a.xUh=A0(l=>{k.oQi(l,"right")});a.wUh=A0(l=>
{k.oQi(l,"left")});a.frm=A0(l=>{k.oQi(l,"up")});a.erm=A0(l=>{k.oQi(l,"down")});a.irm=A0(l=>{k.yUh(l,"right")});a.hrm=A0(l=>{k.yUh(l,"left")});a.jrm=A0(l=>{k.yUh(l,"up")});a.grm=A0(l=>{k.yUh(l,"down")});a.zUh=A0(l=>{k.zUh(l)})},rhx=async function(a){try{await a.Nha.tgd()}catch(b){return!0}a=a.Nha.B1e;return a.state==="loaded"&&(a=a.quota,a?.expires==null&&a&&a.qG<=0)?!1:!0},shx=async function(a){if(a.Nha.Wle)if(a.UG("submit"),a.store.error=void 0,a.store.formula=void 0,a.store.Nzb=void 0,a.store.iPa=
void 0,a.store.UD=!0,!await rhx(a)&&a.XRc)$fx(()=>{a.dispose();a.XRc()});else{var b=await a.Nha.Igk({formula:a.Nha.Wle});$fx(()=>{a.store.state=1;a.store.UD=!1;if(b.status==="failure")a.UG("error",{Bqc:b.error}),a.store.error=b.endUserMessage||M("LEcD9A");else{var c=b.formula;a.UG("success",{Y3d:a.Nha.ico(c)});a.store.formula=c;a.store.Nzb=a.Nha.wEg(c)}})}},whx=function(a){const b=a.qa,c=a.la,d=a.canvas,e=a.ZKf,f=a.jqa,g=a.ZU,h=a.Ly,k=a.Rma,l=a.Nha,{store:n,L:p,Fhp:q,Ghp:r}=thx({Nub:a.Nub,mTb:a.mTb,
Nha:l,XRc:()=>{e.Rd("magic_formulas_upgrade","intentional")},Yvf:jB.Yvf}),t=D0(({page:v,tA:w})=>{if(n.state===1&&c.layout===2)return z0(r,{});var x=Ak(h.sheet,w.column,w.row);if(jB.F7j)return n.isOpen?z0(f.K_c,{mode:"sheet",NBa:x,hidden:!1,page:v,wz:h,tA:w,children:z0(q,{})}):void 0;x=x.scale(h.gd).Nb();return z0(uhx,{isOpen:n.isOpen,tA:w,wz:h,page:v,NBa:x,children:z0(q,{})})});d.jc(k,(v,w)=>{w?(v.Bg.Y6b=D0(x=>w.page===x.page.page&&h.RW&&l.target?z0(t,{page:x.page.page,tA:l.target.tA}):null),v.Bn.FL.Y6b=
D0(()=>h.RW&&l.target?z0(t,{page:void 0,tA:l.target.tA}):null)):(v.Bg.Y6b=void 0,v.Bn.FL.Y6b=void 0)});Xfx(()=>b.status===1&&!!l.Wle&&!vhx(l,l.Wle)&&!g.store.draft,v=>{!p.store.isOpen&&v?p.ZCa():p.store.isOpen&&!v&&p.handleClose()})},xhx=function(a,b){navigator.clipboard.writeText(b);a.ma.Ib({Db:M("EBD9Bw")})},yhx=function(a,b){if(a.Kxa){var c=a.Kxa.tA,d=a.Kxa.sheet;a.fd.Ew(e=>{e.faa(d,c,__c.Vge(b.slice(1)))})}},vhx=function(a,b){return!!a.Kxa&&"canonical"===a.sE.Cme(a.Kxa.sheet,{type:1,gna:b.slice(1)}).type},
zhx=async function(a){a.g9f&&a.mba&&$fx(()=>a.mba?.L3c(1));await a.tgd()},Ahx=function(a){if(a===void 0)return new __c.i7c;const b=a.type;switch(b){case "plain_number":return new __c.j7c({Dw:a.Fj.Dw,dr:a.Fj.dr});case "percentage":return new __c.l7c({Dw:a.Fj.Dw,dr:a.Fj.dr});case "currency":return new __c.k7c({Dw:a.Fj.Dw,dr:a.Fj.dr,tma:a.Fj.symbol,locale:a.Fj.locale});case "date":return new __c.m7c;case "select":case "mention":case "embed":case "checkbox":return new __c.i7c;default:throw new u(b);}},
Bhx=function(a){return(b,c,d)=>{if(d=a.getContent(b,c,d))if(c=d.hU,b=d.NC,d=d.Cb,b&&b.type){var e=b.type;switch(e){case 1:return c=Ahx(d),new __c.o7c({value:b.value,Wci:c});case 2:return new __c.o7c({value:b.value,Wci:new __c.m7c});case 3:return new __c.p7c({value:b.value});case 4:return new __c.q7c({value:c});case 6:return new __c.r7c;case 7:return new __c.s7c({name:c});case 8:return new __c.t7c({title:c});case 9:break;default:throw new u(e);}}}},Chx=function(a){return(b,c)=>__c.uAb(a,b,c?__c.tAb(c):
void 0).wmd},Ehx=function(a){return b=>{b=__c.rGb(a,b,new Dhx);return b.ok?b.value:{}}},Fhx=function(a){return()=>{const b=a();if(b?.inner?.cells.size===1){var [c]=[...b.inner.cells];c=b.sheet.layout.cells.get(c.row,c.column)?.span||{$b:c.row,ec:c.column};return{tA:{row:c.$b,column:c.ec},sheet:b.sheet}}}},Hhx=function(a){const b=a.fd;return{Nha:new Ghx(a.P,a.ma,a.sE,a.pAb,a.YJe,a.mba,Bhx(b),Chx(a.upa),Ehx(a.QCa),Fhx(a.Rma),b,a.g9f,a.document)}},Ihx=function(a){const b=a.jcg,c=a.canvas,d=a.Ly,e=a.WHg,
f=a.jqa,g=a.ZU,h=a.QA,k=a.SKj,l=D0(({page:n})=>{var p=g.store.draft;if(p&&p.type===2){p=p.tb;var q=k.get()??Ak(d.sheet,p.column,p.row),r=q.scale(d.gd).Nb();return jB.F7j?z0(f.K_c,{mode:"sheet",NBa:q,hidden:!1,page:n,wz:d,tA:p,children:z0(b,{})}):p&&z0(uhx,{isOpen:!0,tA:p,wz:d,page:n,NBa:r,children:z0(b,{})})}});c.jc(()=>{const n=h.Uu(Ol.Sw);return{t4a:n?.container.type==="sheet-element"||n?.container.type==="fixed-page"?n:void 0,ute:g.ute}},(n,{t4a:p,ute:q})=>{n.Bg.uDc=p&&q==="CELL_OVERLAY"?D0(({page:r})=>
d.RW&&r.page===p.page&&z0(l,{page:r.page})):void 0;e&&(e.Hkj=p&&q==="FORMULA_BAR"?D0(({page:r})=>d.RW&&r===p.page&&z0(b,{})):void 0)},{equals:Yfx.structural});c.jc(()=>{const n=h.Uu(Ol.Sw);return n?.container.type==="sheet-item"?n:void 0},(n,p)=>{n.Bn.FL.uDc=p?D0(()=>d.RW?z0(l,{page:void 0}):null):void 0})},Jhx=function(a){const {vSd:b}=__c.d7e({...a,N:{Iha:"formula_generation",y4i:a.y4i,UVm:"formula_generation_credit_cta"}});let c=__c.qQn;a.Oc.status===__c.Jx.Ak&&(c=__c.tQn);return{zNa:__c.nQn({config:c,
errorService:a.errorService,vSd:b})}},Khx=async function(a){const b=!!a.store.JTc.length;a.UG(b?"retry":"submit");a.store.error=void 0;a.store.formula=void 0;a.store.Nzb=void 0;a.store.iPa=void 0;a.store.UD=!0;const c=await a.Nha.zej({PCa:a.store.PCa,...(b?{JTc:a.store.JTc}:void 0)});$fx(()=>{a.store.UD=!1;if(c.status==="failure")a.UG("error",{Bqc:c.error}),a.store.error=c.endUserMessage||M("LEcD9A"),c.error==="forbidden"&&(a.store.jhh=!0),a.store.state=0;else{var d=c.formula;a.UG("success",{Y3d:a.Nha.ico(d)});
a.store.formula=d;a.store.JTc=[...a.store.JTc,{formula:d}];a.store.Nzb=a.Nha.wEg(d);a.store.state=1}})},Phx=function(a){const b=a.qa,c=a.la,d=a.canvas,e=a.jqa,f=a.he,g=a.ZKf,h=a.Im,k=a.XJe,l=a.ZU,n=a.Ly,p=a.Rma,q=a.Nha,r=a.mba,t=a.Kh,v=a.errorService,w=a.V$j,{store:x,L:y,Hhp:z,Ihp:B}=Lhx({Nub:a.Nub,Nha:q,mTb:a.mTb,zNa:(()=>{if(w&&r){const {zNa:T}=Jhx({y4i:"formula_writer",Oc:{status:g.status,Rd:()=>g.Rd("magic_formulas_upgrade","intentional"),Ia:g.Ia},errorService:v,pMa:r,ve:new __c.D3b});return T}})(),
Nza:()=>g.Rd("magic_formulas_upgrade","intentional"),XRc:()=>{g.Rd("magic_formulas_upgrade","intentional")},Yvf:jB.Yvf,V$j:w}),C=A0(()=>{l.iCb();q.tgd().catch(()=>{}).finally(()=>{$fx(()=>{var T=q.Wle;y.reset();y.store.K8d=!0;y.store.isOpen=!0;y.store.formula=T;y.store.state=1;y.Mii()})})});t.jc(()=>b.status===1&&q.Wle!=null,(T,V)=>{T.hcg=V?{Button:D0(W=>z0(W.rl,{...W,Icon:Mhx,label:M("B+nttQ"),onClick:C}))}:void 0});const {c0q:G,a0q:H,d0q:K,b0q:L}=Nhx({yis:T=>{l.iCb();q.tgd();y.ZCa(T)}}),N=D0(({page:T,
tA:V})=>{switch(c.layout){case 2:return z0(B,{});case 1:var W=Ak(n.sheet,V.column,V.row);if(jB.F7j){if(!x.isOpen)break;return z0(e.K_c,{mode:"sheet",NBa:W,hidden:!1,page:T,wz:n,tA:V,children:z0(z,{})})}W=W.scale(n.gd).Nb();return z0(uhx,{isOpen:x.isOpen,tA:V,wz:n,page:T,NBa:W,children:z0(z,{})});default:throw new u(c.layout);}}),P=D0(({page:T})=>z0(Ohx,{isOpen:x.isOpen,qPi:q.qPi,wz:n,page:T}));d.jc(p,(T,V)=>{V?(T.Bg.Z6b=D0(W=>V.page===W.page.page&&n.RW&&q.target?z0(N,{page:W.page.page,tA:q.target.tA}):
null),T.Bg.$6b=D0(W=>V.page===W.page.page&&n.RW&&q.target?z0(P,{page:W.page.page}):null),T.Bn.FL.Z6b=D0(()=>n.RW&&q.target?z0(N,{page:void 0,tA:q.target.tA}):null),T.Bn.FL.$6b=D0(()=>n.RW&&q.target?z0(P,{page:void 0}):null)):(T.Bg.Z6b=void 0,T.Bg.$6b=void 0,T.Bn.FL.Z6b=void 0,T.Bn.FL.$6b=void 0)});f&&(f.ym(()=>b.status===1&&!!q.target&&!!p(),K),f.ym(()=>b.status===1&&!!q.target&&!!p(),L));Xfx(()=>({yWs:h.uh&&h.formula.trimEnd()==="="&&!!q.target,ye:b.status!==1}),({yWs:T,ye:V})=>{k.kcg=T?V?H:G:void 0},
{fireImmediately:!0});Xfx(()=>q.target,()=>{x.isOpen&&y.handleClose()})},Rhx=function({he:a,QA:b,ZU:c}){a.ym(()=>!!b.Uu(Ol.Sw),{type:"simple",key:"formula",name:M("wT9klQ"),Icon:Qhx,execute:async()=>{const {inner:d,sheet:e,container:f}=m(b?.Uu(Ol.Sw)),g=d?.anchor??{row:m(e.layout.rows.first()),column:m(e.layout.cols.first())};d?.anchor&&d?.cells.size>1&&b.IAa(f,[g],g,g,[],[]);c.store.draft?$fx(()=>{if(f.type==="sheet-item"){var h=m(c.store.draft);h=Kfx(c,h.sheet,h.tb,"=");h.type===2&&(c.Im.Jhc(h.formula),
Hfx(c.config,h.tb));c.store.NDc=h;Ffx(c.config,h,"end")}else h=m(c.store.draft),h=Jfx(c,h.sheet,h.tb,"="),h.type===2&&(c.Im.Jhc(h.formula),Hfx(c.config,h.tb)),c.store.NDc=h,Ffx(c.config,h,"end")}):c.gvb(g,e,"CELL_OVERLAY",f.type==="sheet-item"?1:0,"=")},hI:!0})},Shx=function(a,b,c,d){if(b.length===0)return[];if(b.length===1)return[{type:0,iC:b[0].row,SB:b[0].col}];const e=new Map;a=new Set(a);for(var f=b.length-1;f>=0;f--){const {row:h,col:k}=b[f];if(a.has(k)){h===0&&e.set(h*c+k,d);continue}var g=
h*c+k;const l=g+c,n=e.get(l);n?(e.set(g,n+1),e.delete(l)):e.set(g,1)}b=[];d=Array.from(e.keys()).reverse();for(a=0;a<d.length;a++){g=d[a];f=e.get(g);if(f===void 0)continue;const {row:h,col:k}={row:Math.floor(g/c),col:g%c};for(g=1;e.get(h*c+(k+g))===f;)e.delete(h*c+(k+g)),g++;g===1&&f===1?b.push({type:0,iC:h,SB:k}):b.push({type:1,iC:h,SB:k,width:g,height:f})}return b},Xhx=function(a,b){if(b&&!(b.cells.length<2)){var c=a.V.wb("quick_insights",{Hb:{name:"quick_insights_generation"}}),d=b.sheet,e=b.cells,
f=b.columns,{category:g,sampleSize:h}=Thx(a,d,e);if(g&&(b=a.config.umr[g]))return e=Uhx(d,f,e),d=Vhx(a,d,e,b),c.ob().wk(({Oi:k})=>{var l=a.N,n={$in:g,aBi:h};k=k();l.P.track(Whx,{action:"insights_generated",...n,Tb:k})}),c.end(),{category:g,pPe:d,aBi:h};c.end()}},Thx=function(a,b,c){const d=new Set;let e=0;for(const f of c)if((c=a.fd.getContent(b,f.row,f.column))&&!c.isEmpty&&(c=(c=c.NC.type)?Yhx[c]:void 0)&&(d.add(c),e++,e>=a.config.IOr))break;if(e<2)return{category:void 0,sampleSize:e};for(const f of a.config.smr)if(d.has(f))return{category:f,
sampleSize:e};return{category:void 0,sampleSize:e}},Uhx=function(a,b,c){b=b.map(d=>a.zL(d));c=c.map(d=>({row:a.kL(d.row),col:a.zL(d.column)}));return Shx(b,c,a.cols.count(),a.rows.count()).map(d=>__c.lAb(d)).join(",")},Vhx=function(a,b,c,d){const e=[];for(const g of d){d={type:0,Ora:`${Zhx[g]}(${c})`};const h=__c.a9q(a.Mma,b,d);if(h.type===0){a:{if(h.Cb)switch(h.Cb.type){case "plain_number":case "currency":case "percentage":case "date":var f=h.Cb.Fj;break a}f=void 0}f=__c.uAb(a.upa,h.value,f).wmd;
e.push({type:g,Iyd:d,token:h,formattedValue:f})}}return e},bix=function(){const a=$hx(new Map);aix(()=>{const b=requestAnimationFrame(()=>{const c=Array.from(a.current.values());if(c.length!==0){c.forEach(e=>{e.style.width="auto"});var d=Math.max(...c.map(e=>e.offsetWidth));c.forEach(e=>{e.style.width=`${d}px`})}});return()=>cancelAnimationFrame(b)});return{Xcm:(b,c)=>{c?a.current.set(b,c):a.current.delete(b)}}},cix=function(a){return b=>z0(__c.Pt,{...b,borderRadius:"element",backgroundColor:{default:"#F0F1F5"},
tp:"1.5u",du:"0.5u",width:"full",height:"full",alignItems:"center",className:"VKUyUQ",children:F0(br,{spacing:"1u",align:"end",Fa:"center",children:[F0(Q,{weight:"bold",children:[a.f1j,":"]}),z0(Q,{children:a.formattedValue}),z0(__c.Rt,{})]})})},jix=function(a){const b=a.WHg,c=a.QA;var d=a.ma;const e=a.cua,f=a.Jd,g=a.oea,h=new dix(a.P),k=new eix(a.Mma,a.fd,a.upa,a.dF,h,a.V);a=new fix(a.sE,e);d=new gix(a,k,d,e,h);Xfx(()=>{var l=c.getSelection();l=l?.inner!=null&&l?.container.type==="fixed-page"?{sheet:l.sheet,
cells:[...l.inner.cells],columns:[...l.inner.columns],rows:[...l.inner.rows],anchor:l.inner.anchor}:void 0;return l},__c.Db(d.aTo,200));hix(b,a,d);f&&g&&iix(f,g,a,d)},hix=function(a,b,c){a.Sdg=D0(()=>b.Bji&&b.mq!=null?z0(kix,{selected:b.mq,options:b.options,e8e:b.e8e,onChange:c.onChange,onCopy:c.onCopy,Nh:c.Nh,PXe:c.PXe}):null)},iix=function(a,b,c,d){const e=D0(h=>z0(lix,{options:c.options,onCopy:k=>{h.oa();d.onCopy(k)},PXe:()=>{h.oa();d.PXe()},Nh:d.Nh,e8e:c.e8e})),f=D0(()=>z0(Q,{weight:"bold",children:M("XJf+bw")})),
g={Sd:()=>c.Bji,Button:h=>z0(h.yi,{...h,icon:Qhx,tooltip:M("XJf+bw"),zh:"icon",XEa:M("XJf+bw"),children:M("XJf+bw")}),pa:e,vv:{sg:f}};Xfx(()=>!c.Bji,()=>b.BV(g));a.plugins.vlc=()=>g},pix=function({canvas:a,Pa:b,viewport:c,la:d,ee:e,QA:f,ZU:g,Gia:h,WHg:k,Dfa:l}){const n=new mix(b,c,d,f,g,h,l),p=({ko:r})=>{r=G0("UGR0LA",{uoe7bQ:!r,v0qhVA:r});var t=J("1zf8Kw",["uPUGYA"]);return z0("div",{className:r,children:z0(Q,{children:z0(__c.Zj,{className:"aVhZ7w",message:t})})})},q=D0(({page:r,Tc:{scale:t},K7g:v,
J7g:w,I7g:x})=>{const y=ihx(()=>k.Hkj&&z0(k.Hkj,{page:r.page})),z=ihx(()=>k.Sdg&&z0(k.Sdg,{}));if(!hf(r.page)||!k.cGh)return null;const B=r.page.sheet,C=B.direction==="rtl";return F0(nix,{anp:y,Sdg:z,ko:C,K7g:v,J7g:G=>w(G.rpc),I7g:x,SEi:()=>n.qOn(B),children:[z0(k.cGh,{page:r.page,gd:t,i5e:n.i5e}),n.FNd&&z0(p,{ko:C})]})});e.wv(()=>n.nJj,({vM:r},t)=>{r&&(r.Uqj=t?{Button:D0(v=>z0(oix,{...v,onClick:n.lUn,CB:n.J2f}))}:void 0)});l?.pOc(()=>n.J2f,(r,t)=>r.M3b({qzo:t}));a.jc(()=>n.Bxo,(r,t)=>{r.Lub.ueg=
t?q:void 0})},rix=function({QA:a,hj:b,pma:c}){const d=new qix(a,b),e=A0(d.Lnc);c.jc(()=>d.aXs(),(f,g)=>{f.RZc=g?{Button:D0(h=>z0(h.rl,{...h,label:M("xfFbMQ"),Icon:__c.k$d,onClick:e}))}:void 0})},tix=function(a,b){const c=new six(a);return d=>z0(b,{...d,uAb:c.uAb,EAb:c.EAb})},uix=function(a){switch(a.type){case "fixed-page":case "responsive-page":return a.page;case "body":case "controlled-element":break;case "sheet-element":return uix(a.container);case "group-element":return uix(a.container);case "sheet-item":return uix(a.container);
default:throw new u(a);}},yix=function({canvas:a,viewport:b,Pa:c,pd:d}){const e=new vix(b,c,d);b=new wix(e);a.jc(()=>e.sBl,(f,g)=>{f.Bg.vDc=g.length===0?void 0:D0(h=>g.map((k,l)=>{if(k.page===h.page.page)return z0(Yz,{page:h.page.page,wz:k.FE,children:z0(xix,{sheet:k.g_i,cells:k.cells,scale:k.FE.gd})},l)}))});a.Bn.jc(()=>e.sBl,(f,g)=>{f.FL.vDc=g.length===0?void 0:D0(h=>g.filter(k=>k.sheet.type==="sheet-item").map((k,l)=>{if(h.page.type!=="responsive-page"||k.page===h.page.page)return z0(Yz,{page:void 0,
wz:k.FE,children:z0(xix,{sheet:k.g_i,cells:k.cells,scale:k.FE.gd})},l)}))});return{rBl:b}},Aix=function(a,{sheet:b,point:c,scrollX:d=!0,scrollY:e=!0}){var f=a.Ly.gM,g=a.Ly.vB,h=a.Ly.selection;const k=b.direction==="rtl";f=k?sj(g.tr,f.tr):sj(g.tl,f.tl);const l=yk(b).find(y=>y.box.GH(c));if(l!=null){var n=zk(b,f,l);g=Lj(0,0,g.width,g.height);g=__c.Rj(g,l.box);if(g!=null){var p=Dfe(c,b);if(p!=null){var q=Ak(b,p.column,p.row).transform(n),r=n.transformPoint(c),t=p.column,v=p.row;g.intersects(q)&&(r.x>=
g.r.x-25?t=b.layout.cols.next(p.column)??p.column:r.x<=g.Ub.x+25&&(t=b.layout.cols.previous(p.column)??p.column),r.y>=g.b.y-25?v=b.layout.rows.next(p.row)??p.row:r.y<=g.t.y+25&&(v=b.layout.rows.previous(p.row)??p.row));p=t&&v&&{column:t,row:v};if(p!=null&&(b=Ak(b,p.column,p.row),l.box.tD(b))){b=b.transform(n);var {deltaX:w,deltaY:x}=zix(g,b);if(w||x)h=m(h?.container),a.scrollTo(h,f.x+(d?w*(k?-1:1):0),f.y+(e?x:0))}}}}},Bix=function(a,b){var c=a.Ly.gM,d=a.Ly.vB;a=a.Ly.sheet;c=a.direction==="rtl"?sj(d.tr,
c.tr):sj(d.tl,c.tl);const e=yk(a).find(f=>f.box.tD(b));if(e==null)return{o9:c,cwo:void 0,bwo:void 0};d=Lj(0,0,d.width,d.height);d=__c.Rj(d,e.box);a=zk(a,c,e);return{o9:c,cwo:d,bwo:a}},zix=function(a,b){const {left:c,right:d,top:e,bottom:f}={left:{delta:b.Ub.x-a.Ub.x,iRe:b.Ub.x<a.Ub.x},right:{delta:b.r.x-a.r.x,iRe:b.r.x>a.r.x},top:{delta:b.t.y-a.t.y,iRe:b.t.y<a.t.y},bottom:{delta:b.b.y-a.b.y,iRe:b.b.y>a.b.y}};b=a=0;d.iRe?a=d.delta:c.iRe&&(a=c.delta);e.iRe?b=e.delta:f.iRe&&(b=f.delta);return{deltaX:a,
deltaY:b}},Cix=function(a,b,c){if(b.row===c.row&&b.column===c.column)return!0;b=a.layout.cells.get(b.row,b.column);a=a.layout.cells.get(c.row,c.column);return b!=null&&a!=null&&b.span.ec===a.span.ec&&b.span.$b===a.span.$b},Dix=function(a,b,c){const d=[a];for(;a!=null&&a!==b;)(a=c.next(a))&&d.push(a);return d},Eix=function(a,b){const c={row:m(b.page.sheet.rows.first()),column:m(b.page.sheet.cols.first())};a.PMd(b,[c],c,c,[],[])},Fix=function(a){return`${a.column.id}:${a.row.id}`},Hix=function(a){const b=
a.anchor;if(a.xyc&&!(a.MNd<20)){var c=a.xyc;if(b){var d=a.Qla.Or.get(c);d&&d.yAa===b.row.id&&d.N3a===b.column.id||a.undo.TZ(()=>{a.Qla.Or.set(c,{yAa:b.row.id,N3a:b.column.id,Bpb:!1})})}else Gix(a)}},Gix=function(a){if(a.xyc&&!(a.MNd<20)){var b=a.xyc;a.undo.TZ(()=>{a.Qla.Or.delete(b)})}},Iix=function(a,b){return b.layout.rows.has(a.row)&&b.layout.cols.has(a.column)},Qix=function(a){const b=a.session,c=a.Pa,d=a.Kc,e=a.viewport,f=a.selection;var g=a.pd;const h=a.Ih,k=a.Gg,l=a.pma,n=a.pg,p=a.Wk,q=a.ma,
r=a.V,t=a.P,v=a.vJ,w=a.U7d,x=a.qOc,y=a.wPe,z=Jix.CHg(navigator);a=new Kix;const B=new Lix(c,b);x(B);y(B);const C=new Mix(c,e,g,f,a,B),G=new Nix(C,a,c,h,k,z,l,v,p,q,r,t);g=b.document.Ka==="fixed"?__c.zf(b.document):__c.yf(b.document);w&&w(new Oix(c,b,g));Xfx(()=>f.Ma,(K,L)=>{if(!L&&!K){if(K=e.Vg?.type==="fixed-page"&&rf(e.Vg)?e.Vg:void 0)Eix(C,K),k?.iS()}else if(e.uh&&!d.DNa&&L?.type==="pages"&&L.inner?.type==="sheet"&&K?.type==="pages"&&K.inner==null){var N=Pix(K);if(Pix(L)!==N&&N&&hf(N)){K=K.container.xb(N);
if(N=C.c1n.get(N)){L=N.rows;const P=N.columns,T=N.cells.map(V=>V);G.IAa(K,T,N.anchor||T[0],N.Iu||T[T.length-1],L.map(V=>V),P.map(V=>V))}else Eix(C,K);k?.iS()}}},{fireImmediately:!0});const H=__c.Db(()=>{n.TYe?.()},1E3);qfx(()=>c.mode===40&&!!n.TYe,()=>{const K=Xfx(()=>G.Uu(),L=>{(L=L?.inner?.cells)&&L.size>1&&H()});qfx(()=>c.mode!==40||!n.TYe,K)});return{o_i:a,QA:G,tKr:K=>C0(c,K,(L,N)=>{L=L.container;G.y6a(L,L.page.sheet,N)},(L,N)=>{L=L.container;G.GCi(L,L.page.sheet,N)},(L,N)=>{L=L.container;G.N4g(L,
L.page.sheet,N)},G.FCi,(L,N)=>{L=L.container;G.M_k(L,L.page.sheet,N)}),rKr:K=>C0(c,K,(L,N)=>{L=L.element;if(L.container.type!=="fixed-page")throw new kJd;G.y6a(L,L.ia.config,N)},(L,N)=>{L=L.element;if(L.container.type!=="fixed-page")throw new kJd;G.GCi(L,L.ia.config,N)},(L,N)=>{L=L.element;if(L.container.type!=="fixed-page")throw new kJd;G.N4g(L,L.ia.config,N)},G.FCi,(L,N)=>{L=L.element;if(L.container.type!=="fixed-page")throw new kJd;G.M_k(L,L.ia.config,N)}),sKr:K=>C0(c,K,(L,N)=>{var P=L.iJ;L=L.item;
ra(TVc(P));P=P.ew(L);G.y6a(P,L.config,N)},(L,N)=>{var P=L.iJ;L=L.item;ra(TVc(P));P=P.ew(L);G.GCi(P,L.config,N)},(L,N)=>{var P=L.iJ;L=L.item;ra(TVc(P));P=P.ew(L);G.N4g(P,L.config,N)},G.FCi,(L,N)=>{var P=L.iJ;L=L.item;ra(TVc(P));P=P.ew(L);G.M_k(P,L.config,N)})}},Pix=function(a){if(a=a.Rz)return a.page},Rix=function(a){const b=a.left,c=a.top,d=a.ko,e=a.onClick,f=a.N9c;a=a.axis;const g={xxdnZQ:!d,b0__og:d};return z0("div",{className:G0("nZWtnw",g),style:{transform:`translate(${b*(d?-1:1)}px, ${c}px)`},
children:z0("div",{className:G0("J_StUw",g,{_lywxg:a==="row",Qdha7g:a==="column"}),onMouseLeave:f,children:z0(__c.ir,{variant:"tertiary",icon:__c.Gu,Qc:"small",size:"tiny",PWb:!0,onClick:e,className:G0("kpGohw"),ariaLabel:a==="column"?M("RMzytA"):M("JAyXbw")})})})},Vix=function({Ly:a,hj:b,ee:c,Wa:d,VIa:e,V:f}){if(!d.hover)return{vDh:void 0};const g=new Six(a,e),h=new Tix(g,b,a,f);c.y6g.push(h.x6g);c.KEi.push(h.z6g);const k=A0(()=>{var n=h.store.target;if(n){var p=n.sheet,q=h.V.wb("sheets_add_button_clicked",
{Hb:{name:"editor.editing.sheet.adding",type:n.type}});switch(n.type){case "row":var r=n.row;if(n.position==="before"){var t=p.rows.previous(r);n=t?t:r;r=t?"after":"before"}else n=r,r="after";h.hj.addRows(p,n,r,1,q,"menu");q?.qe();break;case "column":r=n.column;n.position==="before"?(n=(t=p.cols.previous(r))?t:r,r=t?"after":"before"):(n=r,r="after");h.hj.bUb(p,n,r,1,q,"menu");q?.qe();break;default:throw new u(n);}}}),l=A0(()=>h.N9c());return{vDh:D0(n=>{const p=n.scale,q=n.uob;if(!g.target||!g.position||
!g.xYa)return null;const r=a.sheet;var t=c.Nva({size:a.o9b,scale:p,Ybb:n.p0});const v=parseInt("24px",10)/2;switch(g.target.type){case "row":n=-(t-v);t=0;break;case "column":n=0;t=-(t-v);break;default:throw new u(g.target);}return z0(Uix,{scale:p,uob:q,wz:a,children:z0(Rix,{left:g.position.left*p+n,top:g.position.top*p+t,ko:r.direction==="rtl",onClick:k,N9c:l,axis:g.target.type})})})}},J0=function(a,b,c){const d=c.$R.then(c.vB.Fn());c=d.invert();a=d.transformPoint(a);switch(b){case "row":return c.transformPoint(new pj(0,
a.y));case "column":return c.transformPoint(new pj(a.x,0));default:throw new u(b);}},Wix=function(a,b){var c=a.store;a=a.y6g;if(c.uZd){var d=c.uZd.sheet,e=c.uZd.oVp,f=c.uZd.scale,g=c.uZd.wz;c=g.$R;var h=g.vB,k=g.gM;k=d.direction==="rtl"?sj(h.tr,k.tr):sj(h.tl,k.tl);b=J0(new pj(b.clientX,b.clientY),e,g);b=Gv(d,c,h,k,b);var l;switch(e){case "row":(e=Bfe(b,d))&&(l={type:"row",row:e,offsetY:b.y-d.ld(e)});break;case "column":(e=Cfe(b,d))&&(l={type:"column",column:e,offsetX:b.x-d.yd(e)});break;default:throw new u(e);
}if(l)for(const n of a)n(d,l,f)}},Xix=function(a){function b(c){a.iSc(c.shiftKey);a.pSc(c.metaKey||c.ctrlKey)}return new Tq({onDragStart:A0(c=>{b(c);a.onDragStart(new pj(c.clientX,c.clientY),{age:c.shiftKey,Pyc:c.metaKey||c.ctrlKey,clone:c.altKey})}),pe:A0(c=>{a.pe(new pj(c.clientX,c.clientY))}),onDragEnd:A0(c=>{a.onDragEnd(new pj(c.clientX,c.clientY))}),ux:A0(c=>{b(c)})})},ajx=function(a){const b=a.Pa,c=a.Ly,d=a.hj,e=a.Yqb,f=a.QA,g=a.aTb,h=a.bTb,k=a.$Sb;a=a.HH;const l=(v,w,x,y)=>{e.onMouseMove(v,
w,c,x,y)},n=a?Xix(a):void 0,p=C0(b,D0(v=>z0(Yix,{Oef:!0,size:"small",placement:"absolute",Yqb:e,Ly:c,aTb:g,sheet:v.sheet,p0:1,selection:v.selection,o0:v.o0,onTouchStart:n?.onTouchStart,onMouseDown:n?.onMouseDown,IZd:n?"move":void 0})),(v,w)=>f.btb(v.container,v.sheet,w)),q=C0(b,D0(v=>z0(Zix,{size:"small",placement:"absolute",scrollMode:"transform",Yqb:e,Ly:c,AVc:d.Xya(v.sheet)?.range,$Sb:k,sheet:v.sheet,p0:1,selection:v.selection,o0:v.o0,onTouchStart:v.FAa?.onTouchStart,onMouseDown:v.FAa?.onMouseDown,
onMouseMove:l,onMouseLeave:e.onMouseLeave})),(v,w)=>{const x=J0(new pj(w.Li,w.zj),"column",c);f.pXe(v.container,v.sheet,{...w,Li:x.x,zj:x.y})},(v,w)=>{w=J0(w,"column",c);f.SOf(v.container,v.sheet,new pj(w.x,w.y),"column")},(v,w)=>{w=J0(w,"column",c);f.ZWe(v.container,v.sheet,new pj(w.x,w.y),"column")},()=>{f.ROf()},(v,w)=>{const x=J0(new pj(w.Li,w.zj),"column",c);f.D0k(v.container,v.sheet,{...w,Li:x.x,zj:x.y})}),r=C0(b,D0(v=>z0($ix,{size:"small",placement:"absolute",scrollMode:"transform",Yqb:e,Ly:c,
AVc:d.Xya(v.sheet)?.range,bTb:h,onMouseMove:l,onMouseLeave:e.onMouseLeave,sheet:v.sheet,p0:1,selection:v.selection,o0:v.o0,onTouchStart:v.FAa?.onTouchStart,onMouseDown:v.FAa?.onMouseDown})),(v,w)=>{const x=J0(new pj(w.Li,w.zj),"row",c);f.AYe(v.container,v.sheet,{...w,Li:x.x,zj:x.y})},(v,w)=>{w=J0(w,"row",c);f.SOf(v.container,v.sheet,new pj(w.x,w.y),"row")},(v,w)=>{w=J0(w,"row",c);f.ZWe(v.container,v.sheet,new pj(w.x,w.y),"row")},()=>{f.ROf()},(v,w)=>{const x=J0(new pj(w.Li,w.zj),"row",c);f.B5k(v.container,
v.sheet,{...w,Li:x.x,zj:x.y})}),t=B0(()=>{const v=f.Uu();return v?.container.type==="sheet-element"?v.inner:void 0});return D0(v=>{const w=f.Uu();if(w==null||w.container.type!=="sheet-element"||w.page!==v.page.page||!c.RW)return null;const x=w.container,y=w.sheet;return z0(Uix,{wz:c,scale:v.Tc.scale,uob:!1,children:[p,q,r].map((z,B)=>z0(z,{sheet:y,container:x,selection:t},B))})})},bjx=function(a){const b=a.Pa,c=a.Ly,d=a.hj,e=a.QA,f=a.Yqb,g=a.aTb,h=a.bTb,k=a.$Sb,l=(t,v,w,x)=>{f.onMouseMove(t,v,c,w,
x)},n=C0(b,D0(t=>z0(Yix,{Oef:!0,size:"small",placement:"absolute",Yqb:f,Ly:c,aTb:g,sheet:t.sheet,p0:1,selection:t.selection,o0:t.o0})),(t,v)=>e.btb(t.container,t.sheet,v)),p=C0(b,D0(t=>z0(Zix,{size:"small",placement:"absolute",scrollMode:"transform",Yqb:f,Ly:c,AVc:d.Xya(t.sheet)?.range,$Sb:k,onMouseMove:l,onMouseLeave:f.onMouseLeave,sheet:t.sheet,p0:1,selection:t.selection,o0:t.o0,onMouseDown:t.FAa?.onMouseDown,onTouchStart:t.FAa?.onTouchStart})),(t,v)=>{const w=J0(new pj(v.Li,v.zj),"column",c);e.pXe(t.container,
t.sheet,{...v,Li:w.x,zj:w.y})},(t,v)=>{v=J0(v,"column",c);e.SOf(t.container,t.sheet,new pj(v.x,v.y),"column")},(t,v)=>{v=J0(v,"column",c);e.ZWe(t.container,t.sheet,new pj(v.x,v.y),"column")},()=>{e.ROf()},(t,v)=>{const w=J0(new pj(v.Li,v.zj),"column",c);e.D0k(t.container,t.sheet,{...v,Li:w.x,zj:w.y})}),q=C0(b,D0(t=>z0($ix,{size:"small",placement:"absolute",scrollMode:"transform",Yqb:f,Ly:c,AVc:d.Xya(t.sheet)?.range,bTb:h,onMouseMove:l,onMouseLeave:f.onMouseLeave,sheet:t.sheet,p0:1,selection:t.selection,
o0:t.o0,onMouseDown:t.FAa?.onMouseDown,onTouchStart:t.FAa?.onTouchStart})),(t,v)=>{const w=J0(new pj(v.Li,v.zj),"row",c);e.AYe(t.container,t.sheet,{...v,Li:w.x,zj:w.y})},(t,v)=>{v=J0(v,"row",c);e.SOf(t.container,t.sheet,new pj(v.x,v.y),"row")},(t,v)=>{v=J0(v,"row",c);e.ZWe(t.container,t.sheet,new pj(v.x,v.y),"row")},()=>{e.ROf()},(t,v)=>{const w=J0(new pj(v.Li,v.zj),"row",c);e.B5k(t.container,t.sheet,{...v,Li:w.x,zj:w.y})}),r=B0(()=>{const t=e.Uu();return t?.container.type==="sheet-item"?t.inner:
void 0});return D0(()=>{const t=e.Uu();if(t==null||t.container.type!=="sheet-item"||!c.RW)return null;const v=t.sheet,w=t.container;return z0(Uix,{wz:c,scale:c.gd,uob:!1,children:[n,p,q].map((x,y)=>z0(x,{sheet:v,container:w,selection:r},y))})})},cjx=function(a){var b=a.Pa;const c=a.Ly,d=a.hj,e=a.Yqb,f=a.QA,g=a.aTb,h=a.bTb,k=a.$Sb,l=B0(()=>{const v=f.Uu();return v?.container.type==="fixed-page"?v.inner:void 0}),n=(v,w,x,y)=>{e.onMouseMove(v,w,c,x,y)},p=C0(b,D0(v=>z0(Yix,{size:"large",placement:"relative",
Yqb:e,Ly:c,aTb:g,sheet:v.sheet,p0:void 0,Oef:v.HWc?.dvt??!0,selection:v.selection,o0:v.o0})),(v,w)=>f.btb(v.container,v.sheet,w)),q=C0(b,D0(v=>z0(Zix,{size:"large",placement:"relative",scrollMode:"native",Yqb:e,Ly:c,AVc:d.Xya(v.sheet)?.range,$Sb:k,GYb:v.HWc?.GYb,onMouseMove:n,onMouseLeave:e.onMouseLeave,sheet:v.sheet,p0:void 0,selection:v.selection,o0:v.o0,onMouseDown:v.FAa?.onMouseDown,onTouchStart:v.FAa?.onTouchStart})),(v,w)=>{const x=J0(new pj(w.Li,w.zj),"column",c);f.pXe(v.container,v.sheet,
{...w,Li:x.x,zj:x.y})},(v,w)=>{w=J0(w,"column",c);f.SOf(v.container,v.sheet,new pj(w.x,w.y),"column")},(v,w)=>{w=J0(w,"column",c);f.ZWe(v.container,v.sheet,new pj(w.x,w.y),"column")},()=>{f.ROf()},(v,w)=>{const x=J0(new pj(w.Li,w.zj),"column",c);f.D0k(v.container,v.sheet,{...w,Li:x.x,zj:x.y})}),r=C0(b,D0(v=>z0($ix,{size:"large",placement:"relative",scrollMode:"native",Yqb:e,Ly:c,AVc:d.Xya(v.sheet)?.range,bTb:h,GYb:v.HWc?.GYb,onMouseMove:n,onMouseLeave:e.onMouseLeave,sheet:v.sheet,p0:void 0,selection:v.selection,
o0:v.o0,onMouseDown:v.FAa?.onMouseDown,onTouchStart:v.FAa?.onTouchStart})),(v,w)=>{const x=J0(new pj(w.Li,w.zj),"row",c);f.AYe(v.container,v.sheet,{...w,Li:x.x,zj:x.y})},(v,w)=>{w=J0(w,"row",c);f.SOf(v.container,v.sheet,new pj(w.x,w.y),"row")},(v,w)=>{w=J0(w,"row",c);f.ZWe(v.container,v.sheet,new pj(w.x,w.y),"row")},()=>{f.ROf()},(v,w)=>{const x=J0(new pj(w.Li,w.zj),"row",c);f.B5k(v.container,v.sheet,{...w,Li:x.x,zj:x.y})});a=D0(v=>{const w=v.page;if(rf(w))return z0(p,{sheet:w.page.sheet,container:w,
parent:w,selection:l,HWc:v.HWc})});b=D0(v=>{const w=v.page;if(rf(w))return z0(r,{sheet:w.page.sheet,container:w,parent:w,selection:l,HWc:v.HWc})});const t=D0(v=>{const w=v.page;if(rf(w))return z0(q,{sheet:w.page.sheet,container:w,parent:w,selection:l,HWc:v.HWc})});return{thf:b,rhf:t,shf:a}},fjx=function(a){var b=a.Pa;const c=a.Ly,d=a.hj,e=a.QA;var f=a.HH;a=new djx;a=new ejx(a);const {aTb:g,bTb:h,$Sb:k}=__c.qUr(),l=cjx({Pa:b,Ly:c,hj:d,Yqb:a,QA:e,aTb:g,bTb:h,$Sb:k});f=ajx({Pa:b,Ly:c,hj:d,Yqb:a,QA:e,
aTb:g,bTb:h,$Sb:k,HH:f});b=bjx({Pa:b,Ly:c,hj:d,QA:e,Yqb:a,aTb:g,bTb:h,$Sb:k});return{ee:a,aTb:g,bTb:h,$Sb:k,Qup:l,$bp:f,Qpp:b}},gjx=function({width:a,height:b,top:c,left:d,headerSize:e,ko:f}){return F0("div",{style:{width:a,height:b,transform:`translate(${d*(f?-1:1)}px, ${c}px)`},className:G0("F3q_JA","dSit_g",{sAzM_A:!f,KWCrpQ:f}),children:[z0("div",{style:{width:e},className:G0("cQhI8w","dEIfZQ"),children:z0(__c.VAj,{size:"small"})}),z0("div",{className:"BCvYRg"})]})},hjx=function({width:a,height:b,
top:c,left:d,headerSize:e,ko:f}){return F0("div",{style:{width:a,height:b,transform:`translate(${d*(f?-1:1)}px, ${c}px)`},className:G0("F3q_JA","_7C59mg",{sAzM_A:!f,KWCrpQ:f}),children:[z0("div",{style:{height:e},className:G0("cQhI8w","K4nBGg"),children:z0(__c.e9q,{size:"small"})}),z0("div",{className:"BCvYRg"})]})},ijx=function({width:a,height:b,top:c,left:d,ko:e}){return z0("div",{style:{width:a,height:b,transform:`translate(${d*(e?-1:1)}px, ${c}px)`},className:G0("_3EdIbw","rhz1zA",{sAzM_A:!e,
KWCrpQ:e})})},jjx=function({width:a,height:b,top:c,left:d,ko:e}){return z0("div",{style:{width:a,height:b,transform:`translate(${d*(e?-1:1)}px, ${c}px)`},className:G0("_3EdIbw","_3X_iBQ",{sAzM_A:!e,KWCrpQ:e})})},kjx=function({width:a}){return z0("div",{className:G0("lLMUiA","_QNZRQ"),style:{width:a}})},ljx=function({height:a,ko:b}){return z0("div",{className:G0("lLMUiA","_8xoILA",{Zg_qIg:!b,_5F_7Aw:b}),style:{height:a}})},mjx=function({width:a,top:b,left:c,ko:d}){return z0("div",{className:G0("sjCRow",
{iOi5Hw:!d,TdCW6w:d}),style:{transform:`translate(${c*(d?-1:1)}px, ${b}px)`},children:z0(kjx,{width:a})})},njx=function({height:a,top:b,left:c,ko:d}){return z0("div",{className:G0("sjCRow",{iOi5Hw:!d,TdCW6w:d}),style:{transform:`translate(${c*(d?-1:1)}px, ${b}px)`},children:z0(ljx,{height:a,ko:d})})},ojx=function(a,b){const c=a.Ly.vB,d=a.Ly.sheet.direction==="rtl";return a.Ly.$R.then(__c.Kj(c.center(),c.rotation,d,!1)).then(c.Fn()).transformPoint(b)},tjx=function({Ly:a,Gia:b,hj:c,Ih:d,ee:e,Wa:f,VIa:g,
pma:h,Wk:k,V:l}){const n=new pjx(a,g,f),p=new qjx(n,a,e,d,b,c,l,h,k);f.hover&&(e.y6g.push(p.x6g),e.KEi.push(p.z6g));const q=D0(w=>{const x=w.scale;var y=w.p0,z=n.dropTarget;if(!z)return null;var B=a.sheet,C=a.o9b,G=a.gM,H=a.vB;G=(w=B.direction==="rtl")?sj(H.tr,G.tr):sj(H.tl,G.tl);H=H.transform(Fj(x));y=e.Nva({size:C,scale:x,Ybb:y});switch(z.type){case "row":C=z.row;z=z.position;const K=new pj(0,B.ld(C)+(z==="after"?C.height:0));z=yk(B).find(N=>N.box.GH(K));B=zk(B,G,z).transformPoint(K);return z0(mjx,
{width:y+H.width,top:B.y*x,left:-y,ko:w});case "column":C=z.column;z=z.position;const L=new pj(B.yd(C)+(z==="after"?C.width:0),0);z=yk(B).find(N=>N.box.GH(L));B=zk(B,G,z).transformPoint(L);return z0(njx,{height:y+H.height,top:-y,left:B.x*x,ko:w});default:throw new u(z);}}),r=D0(w=>{const x=w.scale;var y=w.p0;w=n.UKm;var z=n.Qh;if(!w||!z)return null;var B=a.sheet;const C=a.o9b;z=a.vB.transform(Fj(x));y=e.Nva({size:C,scale:x,Ybb:y});B=B.direction==="rtl";switch(w.type){case "row":return z0(gjx,{top:w.top*
x,left:-y,width:y+z.width,height:w.height*x,headerSize:y,ko:B});case "column":return z0(hjx,{top:-y,left:w.left*x,width:w.width*x,height:y+z.height,headerSize:y,ko:B});default:throw new u(w);}}),t=D0(w=>{const x=w.scale,y=n.$bn;if(!y)return null;var z=a.sheet;w=e.Nva({size:a.o9b,scale:x,Ybb:w.p0});z=z.direction==="rtl";switch(y.type){case "row":return z0(ijx,{width:w,height:y.height*x,top:y.top*x,left:-w,ko:z});case "column":return z0(jjx,{width:y.width*x,height:w,top:-w,left:y.left*x,ko:z});default:throw new u(y);
}}),v=D0(({scale:w,p0:x})=>{const y=n.SPg;if(y==null)return null;var z=a.sheet;x=e.Nva({size:a.o9b,scale:w,Ybb:x});z=z.direction==="rtl";switch(y.type){case "row":return z0(rjx,{top:y.top*w,left:-x,width:x,height:y.height*w,ko:z,onMouseMove:p.B6g,onMouseLeave:p.C6g,onDragStart:p.onDragStart,pe:p.pe,onDragEnd:p.onDragEnd,Rza:p.Rza});case "column":return z0(rjx,{top:-x,left:y.left*w,width:y.width*w,height:x,ko:z,onMouseMove:p.B6g,onMouseLeave:p.C6g,onDragStart:p.onDragStart,pe:p.pe,onDragEnd:p.onDragEnd,
Rza:p.Rza});default:throw new u(y);}});return{tpj:D0(w=>{const x=w.scale,y=w.p0;w=w.uob;const z=E0(()=>()=>z0(v,{scale:x,p0:y}),[x,y]),B=E0(()=>()=>z0(r,{scale:x,p0:y}),[x,y]),C=E0(()=>()=>z0(t,{scale:x,p0:y}),[x,y]),G=E0(()=>()=>z0(q,{scale:x,p0:y}),[x,y]);return n.xYa?z0(Uix,{scale:x,uob:w,wz:a,children:z0(sjx,{d6o:z,cjj:B,mbp:C,vbp:G})}):null}),kBs:p}},ujx=function(a,b){return a.$R.then(__c.Gj(-__c.oj(a.gM.rotation))).transformPoint(b)},vjx=function(a){a=__c.YVa(a);if(!(a<-157.5)){if(a<-112.5)return"left-end";
if(a<-67.5)return"left";if(a<-22.5)return"left-start";if(a<22.5)return"top";if(a<67.5)return"right-start";if(a<112.5)return"right";if(a<157.5)return"right-end"}return"bottom"},wjx=function({ib:a,ald:b}){return z0(__c.Xyc,{label:a,open:!0,x:b.x,y:b.y,direction:"LTR"})},Cjx=function({Ly:a,undo:b,ee:c,Ih:d,Wa:e,VIa:f,hj:g,$xa:h,ZU:k,V:l,P:n}){const p=new xjx(a,e,f),q=new yjx(p,a,b,d,c,g,h,k,l,n);e.hover&&(c.y6g.push(q.x6g),c.KEi.push(q.z6g));const r=y=>q.osc(y,a),t=D0(()=>p.tooltip?z0(wjx,{ib:p.tooltip.label,
ald:p.tooltip.position}):null),v=D0(y=>{var z=y.scale,B=y.p0,C=p.erb;if(!C||!q.YUa)return null;const G=a.sheet;var H=a.o9b;y=a.vB.transform(Fj(z));B=c.Nva({size:H,scale:z,Ybb:B});var K=G.direction==="rtl";H={_4h3wAQ:!K,agAT6w:K};switch(C.type){case "row":return C=C.row,K=-B*(K?-1:1),z*=q.osc(new pj(0,G.ld(C)+C.height),a).y,z0("div",{style:{transform:`translate(${K}px, ${z}px)`},className:G0("J2v8PQ",H),children:z0(kjx,{width:B+y.width})});case "column":return C=C.column,z=q.osc(new pj(G.yd(C)+C.width,
0),a).x*z*(K?-1:1),z0("div",{style:{transform:`translate(${z}px, ${-B}px)`},className:G0("J2v8PQ",H),children:z0(ljx,{height:B+y.height,ko:K})});default:throw new u(C);}}),w=D0(({target:y,scale:z,p0:B})=>{if(y.type!=="row")return null;const C=a.o9b,G=a.vB.transform(Fj(z));B=c.Nva({size:C,scale:z,Ybb:B});return z0(zjx,{sheet:y.sheet,row:y.row,scale:z,offset:{left:-(B/2),top:0},headerSize:B,width:G.width,Om:t,osc:r,onDoubleClick:q.onDoubleClick,onMouseMove:q.B6g,onMouseLeave:q.C6g,onDragStart:q.onDragStart,
pe:q.pe,onDragEnd:q.onDragEnd})}),x=D0(({target:y,scale:z,p0:B})=>{if(y.type!=="column")return null;const C=a.o9b,G=a.vB.transform(Fj(z));B=c.Nva({size:C,scale:z,Ybb:B});return z0(Ajx,{sheet:y.sheet,column:y.column,scale:z,headerSize:B,offset:{left:0,top:-(B/2)},height:G.height,Om:t,osc:r,onDoubleClick:q.onDoubleClick,onMouseMove:q.B6g,onMouseLeave:q.C6g,onDragStart:q.onDragStart,pe:q.pe,onDragEnd:q.onDragEnd})});return{Typ:D0(y=>{const z=y.scale,B=y.p0;y=y.uob;const C=E0(()=>()=>z0(v,{scale:z,p0:B}),
[z,B]),G=E0(()=>({target:K})=>z0(w,{target:K,scale:z,p0:B}),[z,B]),H=E0(()=>({target:K})=>z0(x,{target:K,scale:z,p0:B}),[z,B]);return p.xYa?z0(Uix,{scale:z,uob:y,wz:a,children:z0(Bjx,{eEb:p.eEb,enp:G,lIp:H,P1o:C})}):null}),gIs:q}},Djx=function(a){const b=a.Pa,c=a.canvas,d=a.viewport,e=a.hj,f=a.Gia,g=a.QA,h=a.ZU,k=a.Ly,l=a.$xa,n=a.Ih,p=a.HH,q=a.nq,r=a.undo,t=a.V,v=a.P,w=a.pma;a=a.Wk;const x=new __c.vk,y=new __c.vk,z=new __c.vk,B=new __c.vk,C={pua:Vb(),hover:__c.Wb()},{Qup:G,$bp:H,Qpp:K,ee:L,aTb:N,
$Sb:P,bTb:T}=fjx({canvas:c,Pa:b,Ly:k,hj:e,QA:g,HH:p});B.add(()=>d.uh&&d.uK);const {Typ:V,gIs:W}=Cjx({Ly:k,undo:r,ee:L,Ih:n,Wa:C,VIa:y,hj:e,$xa:l,ZU:h,V:t,P:v});x.add(()=>W.YUa);z.add(()=>W.YUa);const {tpj:aa,kBs:ba}=tjx({Ly:k,Gia:f,hj:e,Ih:n,ee:L,Wa:C,VIa:z,V:t,pma:w,Wk:a});x.add(()=>ba.d_b);y.add(()=>ba.d_b);const {vDh:da}=Vix({hj:e,ee:L,Ly:k,Wa:C,VIa:x,V:t});c.jc(la=>la===40,(la,ja)=>{ja?(la.Bg.PIh=D0(oa=>F0(I0,{children:[da&&z0(da,{scale:oa.Tc.scale,p0:void 0,uob:!0}),z0(aa,{scale:oa.Tc.scale,
p0:void 0,uob:!0}),z0(V,{scale:oa.Tc.scale,p0:void 0,uob:!0})]})),la.Bg.teg=D0(oa=>{if(!B.value)return F0(I0,{children:[z0(H,{...oa}),da&&z0(da,{scale:oa.Tc.scale,p0:1,uob:!1}),z0(aa,{scale:oa.Tc.scale,p0:1,uob:!1}),z0(V,{scale:oa.Tc.scale,p0:1,uob:!1})]})})):(la.Bg.PIh=void 0,la.Bg.teg=void 0)});c.jc(la=>la>=10,(la,ja)=>{ja?(c.Lub.thf=G.thf,c.Lub.rhf=G.rhf,c.Lub.shf=G.shf):(c.Lub.thf=void 0,c.Lub.rhf=void 0,c.Lub.shf=void 0)});c.jc(la=>la===40&&k.RW,(la,ja)=>{la.Bn.FL.NIh=ja?D0(()=>F0(I0,{children:[z0(K,
{}),da&&z0(da,{scale:k.gd,p0:1,uob:!1}),z0(aa,{scale:k.gd,p0:1,uob:!1}),z0(V,{scale:k.gd,p0:1,uob:!1})]})):void 0});q.wv&&q.wv(()=>{if(k.RW)return k.selection},(la,ja)=>{const oa=!!ja?.cells;la.sheet.WCa=()=>{if(k.RW&&oa){var ma=L.Nva({size:k.o9b,scale:k.gd,Ybb:1});ma={top:ma,left:ma}}else ma=void 0;return ma}});return{tTd:N,rTd:P,vTd:T}},Ejx=function(a,b){a=Object.fromEntries(a.map(c=>[c,void 0]));return new Proxy(a,{get(c,d,e){let f=Reflect.get(c,d,e);!f&&Ae.ht(d)&&(f=b(d),Reflect.set(c,d,f,e));
return f}})},Ijx=function(a){const b=a.Ldb,c=a.M6,d=a.N6;return{Xrg:b?(e,f)=>c||d&&f.cells.length>500?[new Fjx(e,b,f.sheet,new Gjx(e,b,f.sheet,f.anchor),f.cells)]:f.cells.map(g=>new Gjx(e,b,f.sheet,g)):void 0,sVs:new Hjx(a.fd,a.SEb)}},Kjx=async function(a,b,c){b=await Jjx(a,b,c);const d=b?.results??[];c=c?[...a.spreadsheets,...d]:d;(c.length===0||c.find(e=>e.id===a.ka)==null)&&a.KWc.zid().size>0&&c.unshift(a.xvi);a.spreadsheets=c;a.continuation=b?.continuation},Pjx=async function(a,b,c){const d=await Ljx(a,
b);c=c?[await Mjx(a,d,c)]:await Njx(a,d);if(c.length===0)throw new __c.n3g(`No sheets found for Spreadsheet[${b}]`);Ojx(a,d,c.map(e=>e.yUb));return{cvb:d,sheets:c}},Jjx=async function(a,b,c){try{let d;({results:d,continuation:c}=await a.Wp.kie(new __c.i8n({query:b??"",jNf:!0,continuation:c,Y8a:3,limit:10,mZa:[1]})));return d&&{results:Qjx(d),continuation:c}}catch(d){a.errorService.ra(d,{La:`Failed to search for designs with query: ${b}`})}},Rjx=async function(a,b){if(b.id===a.ka)return a.KWc;a=await a.getDocumentContent(b);
return new __c.Xps(a)},Sjx=async function(a,b){if(b.id===a.ka)return a.tlb;a=await a.getDocumentContent(b);return new __c.rVb(a)},Tjx=async function(a,b){a=await a.C7a.Udk(b);return __c.$g.create(__c.Wg.deserialize(a.IEa.content))},Ljx=async function(a,b){let c=a.spreadsheets.find(d=>d.id===b);c||b!==a.ka||(c=a.xvi,a.spreadsheets.push(a.xvi));c||(c=await Ujx(a,b),a.spreadsheets.push(c));return c},Mjx=async function(a,b,c){const d=(await Rjx(a,b)).zid().get(c);if(!d)throw new __c.m3g(`No sheet found for Spreadsheet[${b.id}] with Id:[${c}]`);
return{id:c,name:a.sheetName(d),yUb:d.sheet,parent:d.parent}},Njx=async function(a,b){b=await Rjx(a,b);return Array.from(b.zid().entries()).map(([c,d])=>({id:c,name:a.sheetName(d),yUb:d.sheet,parent:d.parent}))},Ojx=async function(a,b,c){const d=[],e=[];c.forEach(f=>{f.layout.cells.forEach(g=>{g=g.content.ref;g?.type==="media"&&g.value.forEach(h=>{h.fill.image.ref&&d.push(h.fill.image.ref.media);h.fill.video.ref&&e.push(h.fill.video.ref.video)})})});b=new __c.a5e({yJ:b.id,extension:b.extension});
await a.lq.CY({Xb:[],fonts:[],embeds:[],media:d,Dc:e,wp:[]},{type:"document",ref:b})},Vjx=async function(a,b,c){return(await Sjx(a,b)).hBl.get(c)},Ujx=async function(a,b){var c=m(a.X?.user.id);const d=m(a.X?.Ab.brand.id);({usage:c}=await a.Ff.hMg(new __c.Gmd({user:c,brand:d,ka:b,rf:26})));sa(c.item.type==="DOCUMENT_ACCESS");({document:a}=await a.Gb.wpa(new __c.In({id:b,extension:c.item.extension})));if(!a)throw new __c.m3g(`Spreadsheet[${b}] not found`);return{id:a.id,name:a.draft.content.title??
J("gM5Y+A",[a.draft.content.title??""]),nr:a.draft.content.title,url:__c.sB.iMb({id:a.id,extension:a.xc.extension}),modifiedTime:a.timestamp?new Date(a.timestamp):new Date,thumbnailUrl:a.draft.sI.thumbnail.images[0]?.url,extension:a.xc.extension}},Qjx=function(a){if(a.length!==0)return a.filter(b=>b.item==="DOCUMENT").filter(b=>!b.pb.draft.Acf).map(b=>({id:b.pb.id,name:b.pb.draft.content.title??J("gM5Y+A",[b.nr??""]),nr:b.nr,url:__c.sB.iMb({id:b.pb.id,extension:b.pb.xc.extension}),modifiedTime:b.pb.timestamp?
new Date(b.pb.timestamp):new Date,thumbnailUrl:b.pb.draft.sI.thumbnail.images[0]?.url,extension:b.pb.xc.extension}))},Wjx=function(a,{current:b,edge:c}){var d=a.layout.rows.previous(b.row);b=a.layout.cols.next(b.column);if(d&&b)return{current:{row:d,column:b},edge:c};if(d=(d=a.layout.rows.next(c.row))&&a.layout.rows.next(d))return a={row:d,column:c.column},{current:a,edge:a};b=a.layout.cols.next(c.column);d=a.layout.rows.last();c.row===d&&b&&(b=a.layout.cols.next(b));if(b&&d)return a={row:d,column:b},
{current:a,edge:a}},bkx=function({Pa:a,Aea:b,ffc:c,I:d}){const e=new Xjx(!!d?.n5c),f=new Yjx(e,c),g=new Zjx(e),h=new Kix,k=new Nix(g,h,a,void 0,void 0,Jix.CHg(navigator),void 0,void 0,void 0,void 0,void 0,void 0),l=d?.n5c?()=>{}:(B,C,G)=>{k.y6a(G,G,{...B,Li:C.x,zj:C.y});c&&e.xRe&&c(f.Pzd())},n=d?.n5c?()=>{}:(B,C,G)=>{k.btb(G,G,B);c&&e.xRe&&c(f.Pzd())},p=d?.n5c?()=>{}:(B,C,G)=>{k.pXe(G,G,{...B,Li:C.x,zj:C.y});c&&e.xRe&&c(f.Pzd())},q=d?.n5c?()=>{}:(B,C,G)=>{k.AYe(G,G,{...B,Li:C.x,zj:C.y});c&&e.xRe&&
c(f.Pzd())},r=d?.n5c?()=>{}:(B,C)=>{k.GCi(C,C,B);c&&e.xRe&&c(f.Pzd())},t=d?.n5c?()=>{}:(B,C)=>{k.N4g(C,C,B);c&&e.xRe&&c(f.Pzd())},v=d?.n5c?()=>{}:()=>{k.FCi();c&&e.xRe&&c(f.Pzd())},w=D0(()=>e.selection&&e.selection.cells?z0(__c.kdg,{yfc:$jx,outlineColor:"hsla(264, 100%, 62%, 1)",Ack:"hsla(264, 100%, 62%, 0.1)",gd:1,sheet:e.selection.sheet,cells:e.selection.cells,rows:e.selection.rows,columns:e.selection.columns}):null),x=()=>d?.H6d?null:z0("div",{className:"suCbTg"}),y=B0(()=>e.selection),z=D0(B=>
b?z0(b,{...B,selection:y,Xbn:d?.Ifr?"hidden":"visible"}):void 0);return{qhf:D0(B=>b?z0(akx,{sheet:B.sheet,MSb:B.MSb,P4g:l,P7g:q,q5g:p,btb:n,onDragStart:r,pe:t,onDragEnd:v,Aea:z,$Ap:w,Lbp:x},B.id):null),L:f}},ekx=function({Pa:a,Aea:b,dF:c,store:d,ffc:e,DSc:f,I:g}){const {qhf:h,L:k}=bkx({Pa:a,Aea:b,ffc:e,I:{n5c:e==null||g?.n5c===!0,...g}});a=D0(()=>{const l=d.sheet;var n=l?.yUb;n=(n&&Mex(c,n))??"";return z0(ckx,{aJd:n,sheetName:l?.name,value:d.range,onChange:e,DSc:f,disabled:d.disabled,error:d.errorMessage,
Hki:d.Hki})});b=D0(l=>{yfx(()=>Xfx(()=>d.range,n=>{const p=d.sheet?.yUb;p!=null&&(n&&!__c.zde(n,p)||k.Gso(p,n))},{fireImmediately:!0}),[]);return d.sheet?.yUb==null?null:z0(h,{sheet:d.sheet.yUb,id:d.sheet.id,...l})});return{P2a:a,qhf:b,Sil:new dkx(k)}},fkx=function(a,b,c){return D0(d=>{const e=E0(()=>__c.hk(),[]);var f=d.clientHeight;const g=d.clientWidth;if(f!=null&&g!=null&&f!==0&&g!==0)return d=b.width,f=Math.max(f/b.height,g/d,.25),z0("div",{style:{transformOrigin:"top",transform:`scale(${f}) translate(${(d-
d/f)/2}px, 0px)`},children:z0("div",{ref:e,children:c&&z0(c,{id:a,sheet:b,MSb:e})})})})},hkx=function(a,b,c){return D0(()=>z0(gkx,{onSelect:b,store:a,Dqj:c}))},nkx=function(a,b,c){const d=()=>z0(ikx,{title:a.E3f==="ready"?J("C2DlcQ",[a.VNd.length]):M("FcgbSQ")}),e=D0(()=>z0(jkx,{sheets:a.VNd,vMd:a.vMd,onSelect:b,Dqj:c})),f=()=>z0(kkx,{}),g=()=>z0(lkx,{});return D0(()=>z0(mkx,{Ge:d,rpj:e,Ngf:f,Wjj:g,loadState:a.E3f}))},okx=async function(a,b){return a.jCa.pCf(b)},rkx=function({TIa:a,qhf:b,onSelect:c,
variant:d}){const e=new pkx,f=new qkx(e,a);a=A0(g=>{f.Bio(g);e.vMd&&c(e.vMd)});switch(d){case "list":return{store:e,L:f,Component:nkx(e,a,b)};case "carousel":return{store:e,L:f,Component:hkx(e,a,b)};default:throw new u(d);}},ykx=function({TIa:a,onSelect:b,mLc:c}){const d=new skx,e=new tkx(d,{qGg:async({continuation:t,filter:v})=>a.dhi(v,t)}),f=__c.Db(()=>void e.ryf(),750),g=async t=>{e.IVl(t);await f();e.myf()},h=async()=>{e.IVl("");await f();e.myf()},k=D0(()=>z0(ukx,{onChange:g,$i:h,placeholder:M("1PmYoA"),
AS:d.AS})),l=()=>z0(vkx,{}),n=A0(async t=>{e.gMd({id:t});d.glb&&b(d.glb)}),p=()=>e.myf(),q=D0(()=>z0(wkx,{zc:e.Iji,spreadsheets:d.spreadsheets,glb:d.glb,Sg:p,onSelect:n,loadState:d.hFb,mLc:c})),r=D0(()=>{yfx(()=>{e.ryf()},[]);return z0(xkx,{L2:k,Ge:l,pa:q})});return{store:d,Component:r}},zkx=F(()=>({ka:__c.S(1),extension:__c.U(2)}));
__c.Igg.prototype.iQd=fa(1084,function(a,b,c,d){var e=b.layout.cells.get(a.row,a.column);a=e?{row:e.span.$b,column:e.span.ec}:a;e=this.NKe(b,a);const f=c(he(Ae,e));c=__c.ie(Ae,f,(g,h)=>__c.ze(Ae,f,h));this.imh(c,b,a,d)});__c.Hgg.prototype.iQd=fa(1083,function(a,b,c,d){var e=b.layout.cells.get(a.row,a.column);a=e?{row:e.span.$b,column:e.span.ec}:a;e=this.NKe(b,a);let f=c(he(Be,e));f=__c.Agg(f);c=__c.ie(Be,f,(g,h)=>__c.ze(Be,f,h));this.imh(c,b,a,d)});
__c.Dgg.prototype.aUf=fa(1078,function(a,b,c,d,e){var f=b?__c.CA(b):{};b=__c.QUb(b?.textAlign,c,d);e={...f,...(e==="rtl"?{direction:"rtl"}:{}),textAlign:b};return Qk.create(Qk.qd().attrs(e??{}).Xb(`${a}\n`).build())});
__c.HIe.prototype.dhi=fa(876,async function(a){try{const b=await this.lU.pui({AS:a});return(0,__c.La)({spreadsheets:b.sheets.map(c=>({id:c.id,name:c.name,url:c.url,thumbnailUrl:c.y7i,modifiedTime:new Date(c.modifiedTime)})),continuation:void 0})}catch(b){return this.handleError(b,()=>this.dhi(a))}});
__c.ZHb.prototype.wUb=fa(762,function(a,b){if(a===void 0||b===void 0)return a===b;if(a.type!==b.type)return!1;switch(a.type){case "select":case "mention":case "embed":case "checkbox":case "plain_number":case "percentage":return!0;case "currency":return sa(b.type===a.type),a.Fj.symbol===b.Fj.symbol&&a.Fj.position===b.Fj.position&&a.Fj.locale===b.Fj.locale;case "date":return sa(b.type===a.type),a.Fj.format===b.Fj.format;default:throw new u(a);}});
__c.bRa.prototype.smk=fa(421,async function(a){ra(a.ka!=null&&/^[a-zA-Z0-9_-]{11}$/.test(a.ka));const b=__c.ih(__c.gh([__c.Hjd,a.ka,"document"])),[c,{Skj:d}]=await Promise.all([this.Da.post(b,zkx.serialize(a.body),{Sa:"getdocumentapiv2"}),__webpack_require__.me(834613).then(()=>({Skj:__c.Dls}))]);return d.deserialize(c)});
var Akx={eventType:"sheet_cell_content_modified",Oa(a){return __c.jf({action:a.action,action_type:a.mi,num_cells_modified:a.L3g,content_types:a.Oe!=null?[...a.Oe].reduce((b,[c,d])=>(b[c]=d,b),{}):void 0,format_types:a.Zci!=null?[...a.Zci].reduce((b,[c,d])=>(b[c]=d,b),{}):void 0,control_context:a.mb,location:a.location,editing_context:a.Ca==null?void 0:__c.mf(a.Ca),performance_context:a.Tb==null?void 0:__c.pf(a.Tb)})}},Bkx=__webpack_require__(31968),I0=Bkx.Fragment,z0=Bkx.jsx,F0=Bkx.jsxs;var Ckx=__webpack_require__(845212),Tex=Ckx.Component,Dkx=Ckx.createRef,Ekx=Ckx.forwardRef,Fkx=Ckx.Fragment,ihx=Ckx.memo,mfx=Ckx.useCallback,yfx=Ckx.useEffect,Gkx=Ckx.useId,aix=Ckx.useLayoutEffect,E0=Ckx.useMemo,$hx=Ckx.useRef,Hkx=Ckx.useState;var Ikx=__webpack_require__(186901),B0=Ikx.EW,Bfx=Ikx.fm,$fx=Ikx.h5,Yfx=Ikx.m3,Xfx=Ikx.mJ,H0=Ikx.sH,A0=Ikx.XI,qfx=Ikx.z7;var Uex=__webpack_require__(269018)._;var D0=__webpack_require__(647370).PA;var Jkx=__webpack_require__(536618),pfx=Jkx.Sx,dfx=Jkx.uP;var Kkx=__webpack_require__(277049)._;var Lkx=__webpack_require__,Mkx=Lkx(208463),G0=Lkx.n_x(Mkx)();var Nkx=__webpack_require__(13851);var Okx=__webpack_require__(671142).A;var ffx=class{static G(a){O(a,{MIh:H0.ref,Pqj:H0.ref})}constructor(){this.MIh=(ffx.G(this),void 0)}};var kfx=F(()=>({id:__c.S(1),Qzf:__c.U(2),nvd:__c.U(3)}));var ofx=class{static G(a){O(a,{cFc:A0,B1h:A0})}cFc(a){const b=this.store.iug;if(b){var c=a.rU,d=c.columns.length,e=Math.max(0,...c.columns.map(h=>h.cells.length)),f=__c.LFe(this.o2,a.rU,e,d),g=this.V.wb("sheet_data_consuming",{Hb:{name:"editor.editing.sheet",type:"data_consuming"}});hfx(this);c={column:m(b.layout.cols.first()),row:m(b.layout.rows.first())};f=this.hj.Y2i(__c.$Tc.snapshot(f),void 0,b,[c],g,"contextual_menu",{mmd:!0});d={column:m(b.layout.cols.LAf(d-1)),row:m(b.layout.rows.LAf(e-1))};
e=this.kb.Lqa.generate();b.layout.ZA.create(e,{start:c.row,end:d.row});g=this.kb.Lqa.generate();b.layout.GA.create(g,{start:c.column,end:d.column});a.Pb.type==="app"&&b.z8.append({type:"replace",Pb:{type:"app",QX:a.Pb.QX,kxb:{app:{id:a.Pb.appId,version:a.Pb.appVersion},title:a.Pb.title,source:a.Pb.source}},lga:e,Taa:g});ifx(this,c,d,[...f]);this.hj.phe(b,jfx(b,c,d))}}async s5c(a){const b=this.store.iug;if(b){var c=b.z8.first();c&&(this.EM&&c.Pb.kxb.app.id==="widget:form"&&a.TZ?await lfx(this,c,b):
this.B1h(c,b))}}B1h(a,b){a.lga&&b.layout.ZA.delete(a.lga);a.Taa&&b.layout.GA.delete(a.Taa);b.z8.delete(a)}constructor(a,b,c,d,e,f,g,h,k,l){this.store=a;this.undo=b;this.vg=c;this.o2=d;this.hj=e;this.EM=f;this.Jf=g;this.designId=h;this.kb=k;this.V=l;ofx.G(this)}};var nfx=class{static G(a){O(a,{v$m:B0,iug:B0,Pb:B0,v7j:B0})}get v$m(){const a=this.VMc();return a?!a.sheet.z8.empty:!1}get iug(){const a=this.VMc();if(a)return a.sheet}get Pb(){const a=this.VMc();if(a){var b=a.sheet.z8;if(!b.empty){var c=a.inner?.anchor;if(c){var d=a.sheet.kL(c.row);c=a.sheet.zL(c.column);for(const g of b){if(g.type!=="replace"||g.Pb.type!=="app")continue;var e=g.Taa;b=g.lga;if(!e||!b)continue;var f=a.sheet.layout.GA.get(e);e=a.sheet.layout.ZA.get(b);if(!f||!e)continue;b=a.sheet.zL(f.start);
f=a.sheet.zL(f.end);const h=a.sheet.kL(e.start);e=a.sheet.kL(e.end);if(d>=h&&d<=e&&c>=b&&c<=f)return{appId:g.Pb.kxb.app.id,appVersion:g.Pb.kxb.app.version,title:g.Pb.kxb.title,source:g.Pb.kxb.source,type:"app",QX:g.Pb.QX}}}}}}get v7j(){const a=this.VMc();return a?a.container.type==="fixed-page":!1}constructor(a){this.VMc=a;nfx.G(this)}};var Pkx=__webpack_require__.p+"images/cca9c45328f5e216a276175190d49002.png";var ufx=D0(({navigation:a,onClose:b})=>z0(__c.mv,{height:"fill",navigation:a,zSa:({hf:c})=>z0(c,{oa:b,We:"fill"})})),tfx=D0(({navigation:a,onClose:b})=>z0(__c.l8d,{navigation:a,onClose:b,Fb:a.kz?a.goBack:void 0,display:"compact"})),sfx=({To:a,Kda:b})=>z0(R,{display:"flex",justifyContent:"center",alignItems:"center",height:"full",padding:"2u",children:F0(R,{display:"flex",flexDirection:"column",alignItems:"center",children:[z0(__c.Tu,{src:Pkx,aspectRatio:1,width:a?200:void 0,border:"none"}),z0(Q,{size:"medium",
alignment:"center",children:z0(__c.ak,{uf:b,message:M("zyxomA")})})]})}),rfx=ihx(function(){return z0(R,{padding:"2u",className:"xSiGWg",children:z0(__c.Xi,{shape:"rectangle"})})});var Qkx,Rkx,Skx,Zfx;
new (Qkx=class extends Kkx{constructor(){super(Zfx);Rkx()}},(()=>{class a extends(Skx=Tex){static G(b){O(b,{dye:B0.struct,maxWidth:B0,TXn:B0})}componentDidMount(){this.props.WCn?.(this.ZOb)}componentDidUpdate(){this.props.WCn?.(this.ZOb)}get xql(){return{transform:`scale(${this.props.b3h}) translateZ(0)`}}get dye(){const b=this.props.sheet;var c=this.props.tA,d=b.layout.cells.get(c.row,c.column)?.span||{ec:c.column,$b:c.row,jf:c.column,df:c.row};c=b.ld(d.$b);const e=b.ld(d.df)+d.df.height,f=b.yd(d.ec);
d=b.yd(d.jf)+d.jf.width-f;return __c.Oj({top:c,left:b.direction==="rtl"?b.width-d-f:f,width:d,height:e-c})}get l3p(){const {top:b,left:c,width:d,height:e,rotation:f}=this.dye.Nb();let g={},h={};this.wsd.style?.tb&&(h=__c.de({paddingBlockStart:this.wsd.style.tb.paddingBlockStart,paddingBlockEnd:this.wsd.style.tb.paddingBlockEnd,paddingInlineStart:this.wsd.style.tb.paddingInlineStart,paddingInlineEnd:this.wsd.style.tb.paddingInlineEnd},k=>k?parseInt(k.toString(),10)-1:0));this.wsd.style?.Fnc&&(g={alignItems:this.wsd.style.Fnc.alignItems});
return{minWidth:d+2,minHeight:e+2,maxWidth:this.maxWidth,transform:`translate(${this.props.bel/this.props.b3h*c-1}px, ${this.props.bel/this.props.b3h*b-1}px) rotate(${f}deg)`,background:this.TXn,...h,...g}}get maxWidth(){var b=this.props.tA;({UK:b}=this.props.fd.ozd(this.props.sheet,b.row,b.column,__c.Ge({UK:void 0})));if(b==="wrap"&&!this.props.rIm)return this.dye.width}get TXn(){var {backgroundColor:b}=this.wsd.style?.HKj||{};return(b=this.props.Ijm||b)&&b!=="transparent"?b:"hsla(0, 0%, 100%, 1)"}render(){return z0("div",
{className:"_7_7VxQ",style:this.xql,children:z0("div",{className:"RroTZA",style:this.l3p,ref:this.ZOb,children:z0("div",{className:"Xh7VXQ",onClick:this.props.onClick,children:this.props.children})})})}constructor(b){super(b);this.wsd=(Zfx.G(this),void 0);this.ZOb=Dkx();const c=b.tA;this.wsd=new __c.jVb(b.fd,b.Mdb,b.sheet,c.column,c.row,{get:()=>1},()=>{},()=>{})}}({c:[Zfx,Rkx]}=Uex(a,[],[Lb],Skx))})(),Qkx);var Tkx,Ukx,Vkx,bgx=a=>{const b=a.zaa,c=a.Ind,d=a.draft,e=a.Jg,f=a.Vp,g=a.Tc,h=a.Pxb,k=a.ita,l=a.hta;yfx(()=>{k();return()=>{l()}},[l,k]);return d==null?null:d.type===2?z0("div",{className:"vh158A",children:z0(c,{sheet:d.sheet,wrap:!0})}):d.type===1?(a=__c.Xra(h.XZ(d.tb.column,d.tb.row),d.Sc),z0("div",{className:"FgJwqQ",children:z0(b,{Jg:e,Vp:f,Tc:g,my:a,text:a.text})})):null},Ufx;
new (Tkx=class extends Kkx{constructor(){super(Ufx);Ukx()}},(()=>{class a extends(Vkx=Tex){static G(b){O(b,{Sc:B0})}componentDidMount(){const b=this.props.ita,c=this.props.parent,d=this.props.draft.sheet;window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{setTimeout(()=>{b(d,c)})})})}componentWillUnmount(){const b=this.props.draft,c=this.props.hta;c(b.tb,b.sheet,this.props.parent)}get Sc(){const b=this.props.mc;if(b.state?.type==="focused")return b.state.Sc}render(){const b=this.props.Ind,
c=this.props.oEp,d=this.props.draft,e=this.props.mc,f=this.props.gd;return d==null?null:d.type===2?z0("div",{className:"vh158A",children:z0(b,{sheet:d.sheet,wrap:!0,fontSize:hf(this.props.parent)?"small":"medium"})}):e.state?.type==="focused"&&this.Sc?z0("div",{className:"FgJwqQ",children:z0(c,{text:this.Sc,selection:this.selection,dIa:this.dIa,TY:this.TY,gd:f})}):null}constructor(...b){super(...b);this.dIa=(Ufx.G(this),c=>{const d=this.props.dIa;var e=this.props.draft;const f=e.sheet;e=e.tb;const g=
this.props.parent,h=this.props.mc;h.state?.type==="focused"&&h.state.contentType===4&&d({tb:e,sheet:f,page:g,container:h.state.container,Sc:h.state.Sc,range:c})});this.TY=()=>{const c=this.props.TY;c()};this.selection=B0(()=>{const c=this.props.mc;return{get range(){sa(c.state?.type==="focused");return c.state.range},get attributes(){return c.attributes}}})}}({c:[Ufx,Ukx]}=Uex(a,[],[Lb],Vkx))})(),Tkx);var Wfx=D0(({content:a,CEp:b,mTb:c})=>{sa(a.type!==1);switch(a.type){case 2:return z0(c,{sheet:a.sheet,formula:a.formula,wrap:!0});case 0:return z0(b,{text:a.Sc});default:throw new u(a);}});var xfx=class{static G(a){O(a,{emg:H0.ref,tA:H0.ref,Hpo:A0,Kqg:A0})}setup(){this.fdb=Xfx(()=>this.viewport.Qq,()=>this.isComposing?this.Kqg():this.Koq());this.Kqg()}Hpo(a){this.isComposing=a}dispose(){this.fdb?.();this.fdb=void 0}Kqg(){if(this.tA&&this.Ly.RW){var a=this.Ly.sheet,b=this.Ly.gM,c=this.Ly.vB,d=this.Ly.gd;if(a.layout.cols.has(this.tA.column)&&a.layout.rows.has(this.tA.row)){var e=Ak(a,this.tA.column,this.tA.row).transform(__c.Tj(b));b=a.direction==="rtl"?sj(c.tr,b.tr):sj(c.tl,b.tl);a=
c.width+b.x-e.tl.x-uu*2;b=c.height+b.y-e.tl.y-uu*2;a<=0||b<=0||e.width<=uu*2||e.height<=uu*2||(c=this.viewport.hm(this.viewport.Vg).invert().then(this.viewport.jda()),a=Lj(0,0,a,b).transform(c).Nb(),d=__c.Uj(e.transform(c),-uu*d).Nb(),this.emg={top:d.top,left:d.left,width:Math.min(d.width,a.width),height:Math.min(d.height,a.height),rotation:d.rotation})}else this.emg=void 0}else this.emg=void 0}constructor(a,b,c){this.viewport=a;this.Ly=b;this.emg=(xfx.G(this),void 0);this.tA=this.fdb=void 0;this.isComposing=
!1;this.Koq=__c.Db(()=>{this.Kqg()},200);this.tA=c}};var Wkx,Xkx,Ykx,Vfx;new (Wkx=class extends Kkx{constructor(){super(Vfx);Xkx()}},(()=>{class a extends(Ykx=Tex){static G(b){O(b,{pQj:B0})}get pQj(){return this.props.text.Ya.replace(/\n$/,"").split("\n")}render(){return z0(Q,{children:this.pQj.map((b,c)=>F0(Fkx,{children:[b,c!==this.pQj.length-1&&z0("br",{})]},c))})}constructor(...b){super(...b);a.G(this)}}({c:[Vfx,Xkx]}=Uex(a,[],[Lb],Ykx))})(),Wkx);var Sfx=class{constructor(a,b,c){this.O1f=a;this.Im=b;this.KKm=c;this.x7r=d=>{d.startsWith("=")||Ifx(this.O1f,0,d)};this.w7r=d=>{d.startsWith("=")||Ifx(this.O1f,1,d)};this.Zcs=()=>{const d=this.O1f.store.draft;d?.type===0&&this.KKm.RYf(d.Sc).startsWith("=")&&$fx(()=>{Ifx(this.O1f,2)})};this.$cs=()=>{const d=this.O1f.store.draft;d?.type===1&&this.KKm.SYf(d.Sc).startsWith("=")&&$fx(()=>{Ifx(this.O1f,2)})}}};var Tfx=class{static G(a){O(a,{dIa:A0.bound})}$vc(){}dIa(a){const b=a.tb,c=a.sheet,d=a.page,e=a.container,f=a.Sc;a=a.range;this.mc?.select({type:"focused",contentType:4,range:a,tb:b,sheet:c,page:d,container:e,Sc:f})}TY(){}constructor(a,b){this.mc=a;this.$2j=b;this.Htf=(Tfx.G(this),void 0);this.ita=()=>{this.Htf=Cfx(this.$2j)};this.hta=()=>{this.Htf!=null&&this.Htf()}}};var agx=class{constructor(a){this.$2j=a;this.ita=()=>{this.Htf=Dfx(this.$2j)};this.hta=()=>{this.Htf!=null&&this.Htf()}}};var Qfx=class{Cme(a,b){ra(a?.type==="formula");return"="+Z8q(this.sE,b,a.value).gna}deselectAll(){this.mc?.Vld(this.selection.Ma)}$Tf(a,b,c){b=__c.EUf(c);return __c.Fg.create(__c.Fg.qd().attrs(b??{}).Xb(`${a}\n`).build())}aUf(a,b,c){b=__c.CA(c);return Qk.create(Qk.qd().attrs(b??{}).Xb(`${a}\n`).build())}RYf(a){return a.Ya.replace(/\n$/,"")}SYf(a){return Qk.snapshot(a).cells.Ya().replace(/\n$/,"")}constructor(a,b,c,d,e){this.selection=a;this.mc=b;this.sE=c;this.Im=d;this.ncf=e}};var Rfx=class{static G(a){O(a,{ute:B0})}get ute(){return this.store.ute}OIg(){return this.store.draft?.tb}e6e(a){const b=this.ase,c=m(this.fhf),d=this.ehf,e=m(this.feg),f=this.Rpj,g=m(this.Tpj),h=this.Spj,k=m(this.Upj);Object.entries(this.a3j).forEach(([l,n])=>{const p={ase:b,fhf:c,ehf:d,feg:e},q={ase:f,fhf:g,ehf:h,feg:k};n(l===a?p:q)});this.store.e6e(a)}iCb(){this.store.draft&&(Hfx(this.config,this.store.draft.tb),Gfx(this.config,this.store.draft),this.store.NDc=void 0,this.config.deselectAll(),
this.e6e())}gvb(a,b,c,d,e,f="end"){if(!(this.Pa.mode<=30)){var g=b.layout.cells.get(a.row,a.column),{ec:h,$b:k}=g?.span||{ec:a.column,$b:a.row},l={row:k,column:h};(a=d===0?Lfx(this,l,b):Mfx(this,l,b))&&e===void 0?d=a:(e=e??"",d=d===0?Jfx(this,b,l,e):Kfx(this,b,l,e));if(this.store.draft&&(e=this.store.draft.tb,this.store.draft.sheet===b&&e.row===l.row&&e.column===l.column)){this.e6e(c);return}d.type===2&&this.Im.Jhc(d.formula);this.store.NDc=d;this.e6e(c);this.vJ?.TRo(l);Ffx(this.config,d,f);if(this.xyc){const n=
this.xyc;this.undo.TZ(()=>{b.Or.set(n,{yAa:l.row.id,N3a:l.column.id,Bpb:!0})})}}}constructor(a,b,c,d,e,f,g,h,k,l,n,p,q){this.Pa=a;this.config=b;this.store=c;this.Im=d;this.T2b=e;this.undo=f;this.gye=g;this.vJ=h;this.$xa=k;this.a3j=l;this.xyc=n;this.V=p;this.P=q;this.ase=(Rfx.G(this),void 0);this.uOa=()=>{const r=m(this.store.draft);var t=r.tb;const v=t.row,w=t.column,x=r.sheet;if(x.layout.rows.has(v)&&x.layout.cols.has(w)){var y=x.layout.cells.get(v,w);t=this.V.wb("commit_sheet_cell_draft",{Hb:{name:"editor.editing.sheet.commit_draft",
type:r.type===2?"formula":"richtext"}});var z=this.V.startSpan("do_commit",t);switch(r.type){case 2:var B=this.V.startSpan("set_from_formula",z);this.gye.Ew(L=>{L.RIa(x,{row:v,column:w},this.Im.formula)});B.end();break;case 0:B=this.V.startSpan("set_from_richtext",z);const H={column:w,row:v};this.gye.Ew(L=>{const N=y?.ref?.Cb.ref?.type!=="select";Ofx(this.config.RYf(r.Sc),H,x)&&L.KEb(x,H,r.Sc,{uWe:N,IWe:N?"merge":"replace"})});var C=x.layout.cells.get(v,w);B?.setAttribute("content_type",C?.ref.content.ref?.type);
B?.setAttribute("formatting_type",C?.ref.Cb.ref?.type);(C=x.layout.attrs.get(Ee.ht,H.row,H.column))&&Object.keys(C).length>0&&B?.setAttribute("attributes_found",!0);B.end();break;case 1:B=this.V.startSpan("set_from_richtext",z);const K={column:w,row:v};this.gye.Ew(L=>{const N=y?.ref?.Cb.ref?.type!=="select";Ofx(this.config.SYf(r.Sc),K,x)&&L.Khc(x,K,r.Sc,{uWe:N,IWe:N?"merge":"replace"})});C=x.layout.cells.get(v,w);B?.setAttribute("content_type",C?.ref.content.ref?.type);B?.setAttribute("formatting_type",
C?.ref.Cb.ref?.type);(C=x.layout.attrs.get(Ee.ht,K.row,K.column))&&Object.keys(C).length>0&&B?.setAttribute("attributes_found",!0);B.end()}t.ob().addEvent("infer_end");Gfx(this.config,r);this.store.NDc=void 0;this.config.deselectAll();this.e6e();B=this.V.startSpan("reflow",z);__c.Nfg(this.$xa,x,[{row:v,column:w}]);t.ob().addEvent("reflow_end");B.end();if(this.xyc){const H=this.xyc;this.undo.TZ(()=>{x.Or.set(H,{yAa:v.id,N3a:w.id,Bpb:!1})})}y=x.layout.cells.get(v,w);var G=(B=y?.ref.content.ref?.type)?
new Map([[B,1]]):new Map([]);z.end();t.ob().wk(({Oi:H})=>{this.P.track(Akx,{action:"cell_committed",Oe:G,Tb:H()})});t.qe()}else Gfx(this.config,r),this.store.NDc=void 0}}};var Pfx=class{static G(a){O(a,{NDc:H0.ref,G$l:H0.ref,draft:B0,ute:B0})}e6e(a){this.G$l=a}get draft(){return this.NDc}get ute(){return this.G$l}constructor(){this.NDc=(Pfx.G(this),void 0)}};var Kgx=class{static G(a){O(a,{T7c:H0.ref,span:H0.ref,selection:B0,Byf:B0})}get selection(){if(this.Ly.RW){var a=this.config.selection;if(a){var b=a.page,c=a.sheet,d=a.cells.map(k=>k);if(d=__c.Afe(c,d)){if(this.vJ.active&&this.vJ.anchor&&c.layout.rows.has(this.vJ.anchor.row)&&(!this.vJ.focus||c.layout.rows.has(this.vJ.focus.row))){const {qGj:k,UPl:l}=this.vJ.J_p(this.Ly.sheet,this.vJ.anchor,this.vJ.focus??this.vJ.anchor);var e=__c.Mj(l,k);return new Zkx(b,c,d,e,e.tl,e.br,this.nEe(c,e),a.gkh)}e=c.yd(d.ec);
var f=c.ld(d.$b),g=c.yd(d.jf)+d.jf.width,h=c.ld(d.df)+d.df.height;e=Lj(e,f,g,h);return new Zkx(b,c,d,e,e.tl,e.br,this.nEe(c,e),a.gkh)}}}}nEe(a,{tr:b,br:c,Tn:d,tl:e,r:f,Ub:g,t:h,b:k}){return[c,b,d,e,f,g,k,h].find(l=>Lj(0,0,a.width,a.height).GH(l,-1))}get Byf(){if(this.T7c&&this.selection){var a=this.selection.sheet,b=this.T7c.$b,c=this.T7c.df,d=this.T7c.jf,e=a.yd(this.T7c.ec);b=a.ld(b);d=a.yd(d)+d.width;a=a.ld(c)+c.height;return Lj(e,b,d,a)}}constructor(a,b,c){this.config=a;this.Ly=b;this.vJ=c;this.T7c=
(Kgx.G(this),void 0)}},Zkx=class{constructor(a,b,c,d,e,f,g,h){this.page=a;this.sheet=b;this.source=c;this.K5e=d;this.aLm=e;this.$Km=f;this.nEe=g;this.GVi=h;this.gkh=k=>{this.GVi(k.sort((l,n)=>this.sheet.layout.rows.dj(l.row,n.row)||this.sheet.layout.cols.dj(l.column,n.column)))}}},ggx=class{static G(a){O(a,{selection:B0})}get selection(){const a=this.QA.Uu();if(a?.inner?.cells&&a.inner.cells.size>0){const b=a.container;return{page:a.page,sheet:a.sheet,cells:a.inner.cells,gkh:c=>this.QA.IAa(b,c,c[0],
c[c.length-1],[],[])}}}constructor(a){this.QA=a;ggx.G(this)}};var dgx=D0(function(a){const b=a.lPa;a=a.K5e.scale(a.scale).Nb();return F0("div",{ref:b,style:{top:a.top,left:a.left,width:a.width,height:a.height},className:"ORUegw",children:[z0("div",{className:"_2BLrqQ"}),z0("div",{className:"trr8Kg"}),z0("div",{className:"BVO6cQ"}),z0("div",{className:"_2dSY_g"})]})}),egx=D0(function(a){const b=a.e5h;if(!b)return null;a=b.scale(a.scale).Nb();return z0("div",{style:{top:a.top,left:a.left,width:a.width,height:a.height},className:"T4f3Cg",children:z0("div",{className:"b_GQwg"})})});var igx=class{constructor(a,b){this.store=a;this.BKo=b;this.onDragStart=()=>{this.BKo(!0)};this.pe=()=>{};this.onDragEnd=()=>{this.BKo(!1)}}};var hgx=class extends Kgx{};var $kx='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M21.02 3.607a3 3 0 0 1 0 4.242L10.805 18.066a6 6 0 0 1-2.147 1.38l-4.002 1.49a.75.75 0 0 1-.964-.964l1.49-4.002a6 6 0 0 1 1.38-2.147L16.779 3.607a3 3 0 0 1 4.243 0ZM8.134 18.04a4.5 4.5 0 0 0 1.48-.91l-2.116-2.116c-.396.43-.705.932-.91 1.48l-.486 1.307.725.726 1.307-.487Zm9.937-9.361-7.394 7.393-2.121-2.121 7.393-7.394L18.07 8.68Zm1.06-1.061.83-.83a1.5 1.5 0 1 0-2.121-2.12l-.83.829 2.122 2.121ZM6.825 3.021a.18.18 0 0 0 .01-.043.268.268 0 0 0-.267-.29H4.5a.536.536 0 0 0-.527.441l-.859 3.24a.536.536 0 0 0 .527.63h.95c.343 0 .598.32.522.655l-.69 3.032c-.068.294.326.457.487.203l3.103-4.901a.536.536 0 0 0-.453-.823h-.73a.536.536 0 0 1-.533-.577.359.359 0 0 1 .02-.088l.507-1.479Z" fill="currentColor"/></svg>';var Pgx=Uq({medium:$kx});var Ogx=class{static G(a){O(a,{EIj:B0})}get EIj(){var a=this.store.selection;if(!a)return!1;const b=a.source;return(a=kgx(a.sheet,b))?!(a.$b===b.$b&&a.df===b.df&&a.ec===b.ec&&a.jf===b.jf):!1}constructor(a,b){this.store=a;this.oBl=b;this.i9o=(Ogx.G(this),[2,3,0,1])}};var alx,Qgx,blx=class extends Tex{render(){const a=this.props.isDragging;var b=this.props.scale;const c=this.props.ko,d=__c.yj(b,this.props.bLm);b=this.props.Byf?.scale(b).Nb();return F0(I0,{children:[z0("div",{ref:this.XB.Gq,className:G0("ZmHc_g","h86poQ",{vI27XQ:a,_0i2wHQ:!c,TW_1JQ:c}),style:{transform:`translate(${d.x*(c?-1:1)}px, ${d.y}px)`}}),b&&z0("div",{style:{top:b.top,left:c?void 0:b.left,right:c?b.left:void 0,width:b.width,height:b.height},className:"kntbPA",children:z0("div",{className:"Dnm7JQ"})})]})}constructor(...a){super(...a);
this.XB=new dd([new __c.ed({yt:A0(b=>this.props.onDragStart(new pj(b.Li,b.zj))),IF:A0(b=>this.props.pe(new pj(b.Li,b.zj))),tx:A0(()=>this.props.onDragEnd())})])}};({c:[Qgx,alx]}=Uex(blx,[],[Lb],Tex));alx();var Ngx=class{static G(a){O(a,{Qh:H0.ref,isDragging:B0})}get isDragging(){return!!this.Qh}constructor(a,b,c,d,e,f,g,h){this.store=a;this.YA=b;this.Gia=c;this.Ih=d;this.oBl=e;this.Xaf=f;this.V=g;this.P=h;this.Qh=(Ngx.G(this),void 0);this.onDragStart=k=>{const l=this.store.selection;if(l){this.store.span=this.V.wb("sheets_drag_to_fill_used",{Hb:{name:"editor.editing.sheet.cell.editing"}});var n=l.sheet,p=l.source,q=this.YA.gM,r=this.YA.vB,t=this.YA.$R;this.Ih.SL(v=>{const w=Gv(n,t,r,n.direction==="rtl"?
sj(r.tr,q.tr):sj(r.tl,q.tl),k),x=yk(n).find(y=>y.box.GH(w));this.store.T7c=mgx(n,p,w);this.Xaf(!0);this.Qh={stop:v,B$a:k,lug:x,mub:setInterval(()=>this.CSk(),500)}})}};this.pe=k=>{var l=this.store.selection,n=this.Qh;if(l&&n){var p=l.sheet;l=l.source;var q=this.YA.gM,r=this.YA.vB;n=n.lug;q=p.direction==="rtl"?sj(r.tr,q.tr):sj(r.tl,q.tl);var t=Gv(p,this.YA.$R,r,q,k);r=yk(p).find(w=>w.box.GH(t));var v=t;if(r?.vsa!==n?.vsa||r?.Hva!==n?.Hva)n=zk(p,q,n),v=zk(p,q,r).then(n.invert()).transformPoint(t),Aix(this.Gia,
{sheet:p,point:v});this.Qh&&(this.Qh.lug=r,this.Qh.B$a=k);this.store.T7c=mgx(p,l,v)}};this.CSk=()=>{var k=this.store.selection;if(this.Gia&&this.Qh&&k){k=k.sheet;var l=this.YA,n=l.gM,p=l.vB,q=k.direction==="rtl";l=Gv(k,l.$R,p,sj(q?p.tr:p.tl,q?n.tr:n.tl),this.Qh.B$a);Aix(this.Gia,{sheet:k,point:l})}};this.onDragEnd=()=>{const k=this.store.selection;var l=this.store.T7c;const n=this.store.span;if(this.Qh){var p=this.Qh.stop,q=this.Qh.mub;p();clearInterval(q);this.Qh=void 0}this.store.T7c=void 0;this.Xaf(!1);
if(k&&l){p=k.sheet;var r=k.source;ygx(this.oBl,p,r,l);q=lgx(r.$b,r.df,p.layout.rows);var t=lgx(l.$b,l.df,p.layout.rows);r=lgx(r.ec,r.jf,p.layout.cols);l=lgx(l.ec,l.jf,p.layout.cols);q=new Set([...t,...q]);var v=new Set([...l,...r]),w=[];q.forEach(z=>v.forEach(B=>w.push({row:z,column:B})));k.gkh(w);var {Oe:x,Zci:y}=zgx(w,p);n?.ob().wk(({Oi:z})=>{this.P.track(Akx,{action:"filled",mi:"drag_to_fill",L3g:w.length,Oe:x,Zci:y,mb:"drag",Tb:z()})});n?.end();this.store.span=void 0}}}};var Lgx=class{hmh(a,b,c,d,e,f){const g=rgx(a,b.$b,b.ec);g?g.ref.Cb.set(d):a.layout.cells.set(b,{...__c.ws,Cb:d});switch(c?.type){case void 0:case "content":f.JEb(a,{row:b.$b,column:b.ec},c?.value);break;case "formula":f.faa(a,{row:b.$b,column:b.ec},__c.Vge(c.value.gna));break;default:throw new u(c);}a.layout.attrs.set(Ee.ht,b,e)}constructor(a,b,c,d,e,f){this.vn=a;this.sE=b;this.Nma=c;this.fd=d;this.hj=e;this.lVq=f}};var clx=class{lec(){var a=this.DCb;this.DCb+=1;if(this.sequence.length!==0){a=this.sequence[a%this.sequence.length].content;switch(a.type){case "formula":a=uv(__c.iNc.snapshot(a));break;case "boolean":a=uv(__c.jNc.snapshot(a));break;case "number":a=uv(__c.lNc.snapshot(a));break;case "plaintext":a=uv(__c.mNc.snapshot(a));break;case "media":a=uv(__c.oNc.snapshot(a));break;case "mention":a=uv(__c.pNc.snapshot(a));break;case "embed":a=uv(__c.rNc.snapshot(a));break;case "text2":a=uv(__c.BSc.snapshot(a));
break;case "text3":a=uv(__c.VUc.snapshot(a));break;default:throw new u(a);}return{type:"content",value:a}}}constructor(a){this.sequence=a;this.DCb=0}},Igx=class{Zxd(a){return new clx(a)}constructor(){this.type="duplicate"}};var dlx=class{lec(a){var b=this.sequence[this.DCb%this.sequence.length];this.DCb+=1;if(a=this.dGc(b.location,a??b.location))return b=Z8q(this.sE,this.sheet,b.content.value),{type:"formula",value:this.Nma.CVd(this.sheet,b,a)}}dGc(a,b){const c=this.sheet.kL(a.row);a=this.sheet.zL(a.column);const d=this.sheet.kL(b.row);b=this.sheet.zL(b.column);if(![c,a,d,b].some(e=>e===-1))return{Pt:d-c,xT:b-a}}constructor(a,b,c,d){this.sE=a;this.Nma=b;this.sheet=c;this.sequence=d;this.DCb=0}},Hgx=class{Zxd(a){a=Agx(a);
if(a!=null)return new dlx(this.sE,this.Nma,this.sheet,a)}constructor(a,b,c){this.sheet=a;this.sE=b;this.Nma=c;this.type="formula"}};var elx=class{lec(){const a=this.DCb;this.DCb+=1;return{type:"content",value:{...__c.sYc,value:this.sequence.length>1?Number((this.m*(a+this.sequence.length)+this.b).toPrecision(15)):this.sequence[0]+this.DCb}}}constructor(a){this.sequence=a;this.DCb=0;const b=a.length;let c=0,d=0,e=0,f=0;a.forEach((g,h)=>{c+=h;d+=g;e+=h*g;f+=h*h});this.m=(b*e-c*d)/(b*f-c*c);this.b=(d-this.m*c)/b}},Ggx=class{Zxd(a){if(a.length!==0){var b=[];for(const c of a){if(c.content.type!=="number")return;b.push(c.content.value)}return new elx(b)}}constructor(){this.type=
"number"}};var flx=class{lec(){this.DCb+=1;return{type:"content",value:{...__c.vYc,value:this.Vuh[(this.gDr+this.DCb*this.aRs)%this.Vuh.length]}}}constructor(a,b,c){this.Vuh=a;this.gDr=b;this.aRs=c;this.DCb=0}},Fgx=class{Zxd(a){var b=[];for(const c of a){if(c.content.type!=="plaintext"&&c.content.type!=="text2"&&c.content.type!=="text3")return;b.push(this.getText(c.content))}a=Cgx(this,b);if(a!=null)return b=m(Bgx(this,b[b.length-1])),new flx(this.Vuh,b,a)}getText(a){switch(a.type){case "plaintext":return a.value;
case "text2":return a.value.Ya;case "text3":return Qk.snapshot(a.value).cells.Ya();default:throw new u(a);}}constructor(a){this.Vuh=a;this.type="text_sequence"}};var Mgx=class{Zxd(a,b){if(b.length===1){if(b[0]==null)return this.YPo;if(b[0]?.content.type!=="formula")return(new Igx).Zxd([b[0]])}let c=0;const d=Egx(this,a,b);return{lec:e=>{const f=c;c+=1;return d[f%d.length].lec(e)}}}constructor(a,b,c){this.vn=a;this.sE=b;this.Nma=c;this.YPo={lec:()=>{}}}};var glx=()=>F0("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F0("g",{filter:"url(#filter0_d_2040_48098)",children:[z0("path",{d:"M6 7C6 5.34315 7.34315 4 9 4H16C17.1046 4 18 4.89543 18 6V6C18 7.10457 17.1046 8 16 8H10V14C10 15.1046 9.10457 16 8 16V16C6.89543 16 6 15.1046 6 14V7Z",fill:"currentColor"}),z0("path",{d:"M16 3.5H9C7.067 3.5 5.5 5.067 5.5 7V14C5.5 15.3807 6.61929 16.5 8 16.5C9.38071 16.5 10.5 15.3807 10.5 14V8.5H16C17.3807 8.5 18.5 7.38071 18.5 6C18.5 4.61929 17.3807 3.5 16 3.5Z",
stroke:"#394C60",strokeOpacity:"0.15"})]}),z0("defs",{children:F0("filter",{id:"filter0_d_2040_48098",x:"0",y:"0",width:"24",height:"24",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[z0("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),z0("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),z0("feOffset",{dy:"2"}),z0("feGaussianBlur",{stdDeviation:"2.5"}),z0("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.054902 0 0 0 0 0.0745098 0 0 0 0 0.0941176 0 0 0 0.15 0"}),
z0("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_2040_48098"}),z0("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_2040_48098",result:"shape"})]})})]}),hlx=()=>F0("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F0("g",{filter:"url(#filter0_d_2040_48096)",children:[z0("path",{d:"M18 13C18 14.6569 16.6569 16 15 16H8C6.89543 16 6 15.1046 6 14V14C6 12.8954 6.89543 12 8 12H14V6C14 4.89543 14.8954 4 16 4V4C17.1046 4 18 4.89543 18 6V13Z",
fill:"currentColor"}),z0("path",{d:"M8 16.5H15C16.933 16.5 18.5 14.933 18.5 13V6C18.5 4.61929 17.3807 3.5 16 3.5C14.6193 3.5 13.5 4.61929 13.5 6V11.5H8C6.61929 11.5 5.5 12.6193 5.5 14C5.5 15.3807 6.61929 16.5 8 16.5Z",stroke:"#394C60",strokeOpacity:"0.15"})]}),z0("defs",{children:F0("filter",{id:"filter0_d_2040_48096",x:"0",y:"0",width:"24",height:"24",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[z0("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),z0("feColorMatrix",
{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),z0("feOffset",{dy:"2"}),z0("feGaussianBlur",{stdDeviation:"2.5"}),z0("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.054902 0 0 0 0 0.0745098 0 0 0 0 0.0941176 0 0 0 0.15 0"}),z0("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_2040_48096"}),z0("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_2040_48096",result:"shape"})]})})]});var ilx,Sgx=D0(a=>{const b=a.hmm,c=a.hK,d=a.scale,e=a.onDragStart,f=a.pe,g=a.onDragEnd;return F0(I0,{children:[z0(jlx,{handle:a.xwh,isActive:c?.position==="top-start",scale:d,onDragStart:e,pe:f,onDragEnd:g}),z0(jlx,{handle:b,isActive:c?.position==="bottom-end",scale:d,onDragStart:e,pe:f,onDragEnd:g})]})}),jlx,klx=class extends Tex{render(){var a=__c.yj(this.props.scale,this.props.handle.point);const b=this.props.handle.position==="top-start",c=a.x-__c.Uc*5/2;a=a.y-__c.Uc*5/2;const d=b?"FMRnCA":"IjKrcA";
return z0("div",{ref:this.XB.Gq,className:G0("FQxwyQ"),style:{transform:`translate(${c}px, ${a}px)`},children:z0("div",{className:G0(d,"kUa5KQ",{OwrdhA:this.props.isActive}),children:b?z0(glx,{}):z0(hlx,{})})})}constructor(...a){super(...a);this.XB=new dd([new __c.ed({yt:A0(b=>this.props.onDragStart({point:new pj(b.Li,b.zj),position:this.props.handle.position})),IF:A0(b=>this.props.pe({point:new pj(b.Li,b.zj),position:this.props.handle.position})),tx:A0(()=>this.props.onDragEnd())})])}};
({c:[jlx,ilx]}=Uex(klx,[],[Lb],Tex));ilx();var Rgx=class{static G(a){O(a,{Qh:H0.ref,ruj:H0.ref,hK:B0})}get hK(){return this.ruj}constructor(a,b,c,d,e,f){this.store=a;this.YA=b;this.Gia=c;this.vJ=d;this.Ih=e;this.Xaf=f;this.Qh=(Rgx.G(this),void 0);this.onDragStart=g=>{const h=this.store.selection;if(h){var k=h.sheet,l=this.YA.gM,n=this.YA.vB,p=this.YA.$R;this.Ih.SL(q=>{const r=Gv(k,p,n,k.direction==="rtl"?sj(n.tr,l.tr):sj(n.tl,l.tl),g.point),t=yk(k).find(v=>v.box.GH(r));this.ruj=g;this.Qh={stop:q,B$a:g.point,lug:t,mub:setInterval(A0(()=>this.CSk()),
500)}})}};this.CSk=()=>{var g=this.store.selection,h=this.Qh;if(this.Gia&&h&&g){g=g.sheet;var k=this.YA,l=k.gM,n=k.vB,p=g.direction==="rtl";h=Gv(g,k.$R,n,sj(p?n.tr:n.tl,p?l.tr:l.tl),h.B$a);Aix(this.Gia,{sheet:g,point:h})}};this.pe=g=>{const h=this.store.selection;var k=this.Qh;if(h&&k){var l=h.sheet,n=h.source,p=this.YA.gM,q=this.YA.vB;k=k.lug;p=l.direction==="rtl"?sj(q.tr,p.tr):sj(q.tl,p.tl);var r=Gv(l,this.YA.$R,q,p,g.point);q=yk(l).find(v=>v.box.GH(r));var t=r;if(q?.vsa!==k?.vsa||q?.Hva!==k?.Hva)k=
zk(l,p,k),t=zk(l,p,q).then(k.invert()).transformPoint(r),Aix(this.Gia,{sheet:l,point:t});this.Qh&&(this.Qh.lug=q,this.Qh.B$a=g.point);this.vJ.active?this.vJ.$ar(g,{row:h.source.$b,column:h.source.ec},{row:h.source.df,column:h.source.jf},l,this.YA):(g=Jgx(l,n,g,r),h.gkh(g))}};this.onDragEnd=()=>{if(this.Qh){const g=this.Qh.stop,h=this.Qh.mub;g();clearInterval(h);this.Qh=void 0}this.ruj=void 0;this.Xaf(!1)}}};var llx='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.083 17.769c-.332 0-.597-.094-.794-.281-.193-.193-.289-.44-.289-.744 0-.298.099-.544.296-.736.197-.197.46-.296.787-.296.332 0 .596.096.794.289.197.187.296.433.296.736s-.1.55-.296.743c-.198.193-.462.289-.794.289ZM8.463 17.856c-.818 0-1.542-.188-2.172-.563-.626-.38-1.12-.975-1.48-1.783-.36-.809-.541-1.836-.541-3.082 0-1.247.18-2.274.541-3.082.36-.809.854-1.4 1.48-1.776C6.92 7.19 7.645 7 8.463 7c.818 0 1.54.19 2.166.57.63.376 1.123.967 1.48 1.776.36.808.54 1.835.54 3.082 0 1.246-.18 2.273-.54 3.082-.357.808-.85 1.403-1.48 1.783-.626.375-1.348.563-2.166.563Zm0-1.458c.54 0 .99-.125 1.35-.376.366-.255.645-.673.837-1.256.198-.587.296-1.366.296-2.338s-.098-1.75-.296-2.332c-.192-.587-.471-1.005-.837-1.255-.36-.255-.81-.383-1.35-.383-.543 0-.998.128-1.364.383-.36.25-.64.668-.837 1.256-.193.582-.289 1.359-.289 2.33 0 .973.096 1.752.289 2.34.197.582.476 1 .837 1.255.366.25.82.376 1.364.376ZM18.814 17.856c-.818 0-1.543-.188-2.173-.563-.625-.38-1.119-.975-1.48-1.783-.36-.809-.54-1.836-.54-3.082 0-1.247.18-2.274.54-3.082.361-.809.854-1.4 1.48-1.776.63-.38 1.355-.57 2.173-.57.818 0 1.54.19 2.165.57.63.376 1.124.967 1.48 1.776.36.808.541 1.835.541 3.082 0 1.246-.18 2.273-.541 3.082-.356.808-.85 1.403-1.48 1.783-.625.375-1.347.563-2.165.563Zm0-1.458c.539 0 .988-.125 1.35-.376.365-.255.644-.673.837-1.256.197-.587.296-1.366.296-2.338s-.1-1.75-.296-2.332c-.193-.587-.472-1.005-.838-1.255-.36-.255-.81-.383-1.35-.383-.543 0-.998.128-1.363.383-.361.25-.64.668-.838 1.256-.192.582-.288 1.359-.288 2.33 0 .973.096 1.752.288 2.34.198.582.477 1 .838 1.255.365.25.82.376 1.364.376Z" fill="currentColor"/></svg>';var mhx=Uq({medium:llx});var lhx=()=>M("l5xPAA");var ghx=({gMc:a,yBs:b,mq:c,OXe:d,wUb:e,rIi:f})=>F0(__c.Qo,{role:"menu",className:"mJZZvA",children:[a.map((g,h)=>z0(mlx,{Xik:g,oc:c?e(g,c):!1,OXe:d},h)),z0(__c.Tt,{}),b.length>0&&F0(I0,{children:[b.map((g,h)=>z0(mlx,{Xik:g,oc:c?e(g,c):!1,OXe:d},h)),z0(__c.Tt,{})]}),z0(St,{onClick:f,children:M("o7LtTw")})]}),hhx=({categories:a,mq:b,wUb:c,OXe:d})=>F0(__c.pA,{height:"fill",O4c:b?.Cb?.type==="date"?"dates":"currencies",children:[z0(__c.qA,{align:"stretch",children:a.map(({id:e,label:f})=>z0(__c.rA,{id:e,
children:f},e))}),z0(__c.sA,{children:a.map(({id:e,options:f})=>z0(__c.tA,{id:e,children:z0(__c.Qo,{role:"menu",className:"mJZZvA",children:f.map((g,h)=>z0(mlx,{Xik:g,oc:b?c(g,b):!1,OXe:d,fQp:!0,KYs:g.hPc},h))})},e))})]}),jhx=ihx(({f2r:a})=>z0(Wi,{variant:"linkButton",onClick:a,size:"medium",alignment:"start",children:F0($q,{Fa:"start",spacing:"0",align:"start",children:[z0(jd,{size:"2u"}),z0(Q,{size:"small",tone:__c.cr,alignment:"start",weight:"bold",children:M("P+MqfA")})]})})),mlx=({Xik:a,oc:b,
OXe:c,fQp:d,KYs:e})=>{const f=a.label,g=a.Icon,h=a.nd,k=mfx(()=>c(a),[a,c]),[l,n]=Hkx(!1),p=z0(__c.Nu,{text:h,tone:"infoLow"});let q=z0(jd,{size:"3u"});b?(q=z0(__c.sr,{size:"medium"}),l&&h&&(q=p)):(l||d)&&h&&(q=p);return z0(St,{start:g&&z0(g,{size:"medium"}),end:z0("div",{className:"_3Z8hvg",children:q}),onClick:k,ariaLabel:f,onFocus:()=>n(!0),onBlur:()=>n(!1),onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:F0(br,{spacing:"1u",Fa:"center",children:[z0(Q,{children:f}),e&&z0(__c.Nu,{text:M("qIH9+Q"),
tone:"neutralLow"})]})})},nhx=({uya:a,onChange:b})=>z0(__c.Hu,{value:a,className:"UjMECQ",step:1,min:0,max:10,onChange:b,t6d:!0,ariaLabel:M("q4S/TQ"),sfa:M("avH0UA"),Vea:M("Vi3amQ")});var nlx='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.963 14.405c0 1.233-.43 2.227-1.291 2.98-.854.753-2.062 1.201-3.626 1.345L11.562 21h-1.453l.485-2.27c-1.413-.093-2.611-.38-3.594-.86v-2.25c.56.302 1.201.553 1.926.754.732.2 1.427.308 2.087.322l.904-4.163c-1.119-.402-1.922-.897-2.41-1.485-.48-.595-.721-1.313-.721-2.152 0-1.198.423-2.155 1.27-2.873.853-.724 2.019-1.147 3.496-1.27L13.95 3h1.453l-.377 1.775c1.155.115 2.192.41 3.11.882l-.926 1.99c-.96-.472-1.836-.738-2.625-.795l-.86 3.991c.918.366 1.585.707 2 1.023.424.315.736.677.937 1.086.2.409.3.893.3 1.453Zm-4.476 2.248c.617-.079 1.105-.294 1.463-.645.366-.352.55-.804.55-1.356 0-.724-.413-1.244-1.238-1.56l-.775 3.561Zm.624-9.801c-.638.079-1.119.287-1.442.624-.315.33-.473.767-.473 1.312 0 .703.395 1.202 1.184 1.496l.731-3.432Z" fill="currentColor"/></svg>';var olx=Uq({medium:nlx});var plx='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m18.835 6.01-.843-.843a.16.16 0 0 0-.225 0L5.165 17.765a.16.16 0 0 0 0 .225l.843.843a.16.16 0 0 0 .225 0l12.6-12.6a.155.155 0 0 0 .002-.223ZM7.864 10.727a2.867 2.867 0 0 0 2.863-2.863A2.867 2.867 0 0 0 7.864 5 2.867 2.867 0 0 0 5 7.864a2.867 2.867 0 0 0 2.864 2.863Zm0-4.295c.79 0 1.431.642 1.431 1.432 0 .79-.642 1.431-1.431 1.431-.79 0-1.432-.642-1.432-1.431 0-.79.642-1.432 1.432-1.432Zm8.272 6.84a2.867 2.867 0 0 0-2.863 2.864A2.867 2.867 0 0 0 16.136 19 2.867 2.867 0 0 0 19 16.136a2.867 2.867 0 0 0-2.864-2.863Zm0 4.296c-.79 0-1.431-.642-1.431-1.432 0-.79.642-1.431 1.431-1.431.79 0 1.432.642 1.432 1.431 0 .79-.642 1.432-1.432 1.432Z" fill="currentColor"/></svg>';var qlx=Uq({medium:plx});var Vgx=({symbol:a})=>z0(R,{className:"GsETTQ",children:z0(Q,{children:a})});var rlx=[{type:"symbol",value:"dollar"},{type:"symbol",value:"euro"},{type:"locale",value:"en-AU"},{type:"locale",value:"es-AR"},{type:"locale",value:"pt-BR"},{type:"locale",value:"en-GB"},{type:"locale",value:"en-CA"},{type:"locale",value:"zh-CN"},{type:"locale",value:"es-CO"},{type:"locale",value:"en-IN"},{type:"locale",value:"id-ID"},{type:"locale",value:"ja-JP"},{type:"locale",value:"ms-MY"},{type:"locale",value:"es-MX"},{type:"locale",value:"zh-TW"},{type:"locale",value:"es-PE"},{type:"locale",
value:"en-PH"},{type:"locale",value:"pl-PL"},{type:"locale",value:"ko-KR"},{type:"locale",value:"th-TH"},{type:"locale",value:"tr-TR"},{type:"locale",value:"en-US"},{type:"locale",value:"vi-VN"}],slx=["yMd","yMMMd","yMMM"];var Ygx=["plain_number","currency","percentage","date"],ehx=class{static G(a){O(a,{Jeh:H0.ref,idl:B0,rcl:B0,Itg:B0,Qug:B0,n1h:B0,zCm:B0,dateFormats:B0,Wik:B0,Bem:B0,aea:B0,Vtl:B0,Hie:B0,hTh:B0,KPl:B0,IPl:B0,gEm:B0})}get idl(){return{label:M("UeTlZw"),Icon:__c.J9r,nd:__c.Hyb(this.OT,1234.56,{Dw:2,dr:!0}),Cb:{type:"plain_number",Fj:{type:"plain",Dw:2,dr:!0}},hPc:!0}}get rcl(){return{label:M("Kn0x6g"),Icon:qlx,nd:__c.Iyb(this.OT,.1234,{Dw:2,dr:!1}),Cb:{type:"percentage",Fj:{type:"percentage",Dw:2,dr:!1}},
hPc:!0}}get Itg(){const a=this.vn.vX.t4c.Dw,b=this.vn.vX.t4c.symbol,c=this.vn.vX.t4c.position,d=this.vn.vX.t4c.dr,e=this.vn.vX.t4c.locale;return{label:M("xd7C1g"),Icon:olx,nd:__c.Jyb(this.OT,1234.56),Cb:{type:"currency",Fj:{type:"currency",Dw:a,symbol:b,position:c,dr:d,locale:e}},hPc:!0}}get Qug(){const a={type:"date",Fj:{type:"date",format:this.vn.vX.dateFormat}};return{label:M("FJQ0JA"),Icon:__c.ro,nd:__c.Myb(this.OT,new Date,a.Fj),Cb:a,hPc:!0}}get n1h(){return[this.BEm,this.idl,this.rcl,this.Itg,
this.Qug]}get zCm(){let a;const b=[];rlx.forEach(c=>{c=c.type==="symbol"?__c.iu[c.value]:__c.PPd[__c.kyb(c.value)||"en"];const d={type:"currency",Fj:{type:"currency",...c}};c={label:c.name,Icon:Wgx(c.symbol),nd:__c.Jyb(this.OT,1234.56,c),Cb:d,hPc:this.Itg.hPc&&this.OT.wUb(d,this.Itg.Cb)};c.hPc?a=c:b.push(c)});a&&b.unshift(a);return{id:"currencies",label:M("F+8VxA"),options:b}}get dateFormats(){let a;const b=[];slx.forEach(c=>{var d=this.vn.vX.H9b.dateFormats[c];c={type:"date",Fj:{type:"date",format:d}};
d=m(__c.Sna(d));var e="";for(var f of d){if(f.type===0)d=e+f.value;else{d=e;a:switch(e=f.value,e){case "d":case "dd":e=M("CfK8Xw");break a;case "M":case "MM":case "MMM":case "MMMM":e=M("GEb+BA");break a;case "yy":case "yyyy":e=M("jJY0sg");break a;default:throw new u(e);}d+=e}e=d}f={label:e,Icon:__c.ro,nd:__c.Myb(this.OT,new Date,c.Fj),Cb:c,hPc:this.Qug.hPc&&this.OT.wUb(c,this.Qug.Cb)};f.hPc?a=f:b.push(f)});a&&b.unshift(a);return{id:"dates",label:M("hg33uQ"),options:b}}get Wik(){return[this.zCm,this.dateFormats]}get Bem(){return[...this.n1h,
...this.Wik.flatMap(a=>a.options)]}get aea(){const a=this.QA.Uu();if(a!=null){if(a.inner==null){if(a.container.type==="fixed-page")return;var b=a.sheet.layout.rows;const c=a.sheet.layout.cols;return{sheet:a.sheet,anchor:{row:b.first(),column:c.first()},cells:b.flatMap(d=>c.map(e=>({row:d,column:e})))}}b=Xgx(a.inner.cells,a.inner.anchor);return{sheet:a.sheet,anchor:b[0],cells:b}}}get Vtl(){var a=this.aea;if(a==null)return[];const b=a.sheet;var c=a.anchor;a=a.cells;return this.flags.M6||this.flags.N6&&
a.length>500?(c=this.fd.getContent(b,c.row,c.column)?.Cb,c!=null?[c]:[]):a.map(d=>this.fd.getContent(b,d.row,d.column)?.Cb).filter(__c.sb)}get Hie(){const a=new Set;for(const b of this.Vtl){if(!Zgx(b))return;const c=this.Bem.find(d=>this.OT.wUb(d.Cb,b));if(c&&(a.add(c),a.size>1))return}return a.size===0?this.BEm:a.values().next().value}get hTh(){return this.aea!=null&&this.aea.cells.length>0}get KPl(){return this.Hie?.Cb?.type==="currency"?olx:this.Hie?.Cb&&this.Hie.Icon?this.Hie.Icon:__c.J9r}get IPl(){return!!this.Hie?.Cb}get gEm(){for(var a of this.Vtl)if(a!=
null){a=a.Fj;if(!a)return 0;switch(a.type){case "plain":case "currency":case "percentage":return a.Dw;case "date":return 0;default:throw new u(a);}}return $gx(this)}constructor(a,b,c,d,e){this.vn=a;this.QA=b;this.fd=c;this.OT=d;this.flags=e;this.Jeh=(ehx.G(this),[]);this.BEm={label:M("+m/pkw"),Icon:void 0,nd:void 0,Cb:void 0,hPc:!0};this.wUb=(f,g)=>this.OT.wUb(f.Cb,g.Cb);this.wfn=(f,{row:g,column:h})=>{f=f.layout.cells.get(g,h);if(f?.ref?.content.ref?.type==="number"&&(f.ref.Cb.ref&&__c.tAb(f.ref.Cb.ref))?.type!==
"date")return f=(f=__c.Cyb(this.OT,f.ref.content.ref.value.toString()))?f.format?.Dw??0:void 0,f}}},fhx=class{static G(a){O(a,{SMe:A0,xNg:A0,Dtm:A0,Hgm:A0})}SMe(a,b){this.ZU.store.draft!=null&&this.ZU.uOa();chx(this,a,b.Cb);dhx(this,a,b)}xNg(a,b){switch(b){case "plain_number":return this.SMe(a,a.idl);case "currency":return this.SMe(a,a.Itg);case "percentage":return this.SMe(a,a.rcl);case "date":return this.SMe(a,a.Qug);case "select":case "mention":case "embed":case "checkbox":break;default:throw new u(b);
}}Dtm(a){a.Jeh=[]}Hgm(a,b){if(a.aea!=null){var c=this.V.wb("sheets_decimal_places_menu_used",{Hb:{name:"editor.editing.sheet.cell.formatting"}}),d=new Map,e=new Map,f=a.aea.sheet,g=a.aea.cells;this.fd.Ew(h=>{g.forEach(k=>{const l=this.fd.getContent(f,k.row,k.column),n=l?.Cb;({Oe:d,bVf:e}=ahx(l,d,e));if(n==null)h.m2(f,k,{type:"plain_number",Fj:{type:"plain",Dw:b,dr:!1}});else switch(n.type){case "plain_number":h.m2(f,k,{...n,Fj:{...n.Fj,type:"plain",Dw:b}});break;case "percentage":h.m2(f,k,{...n,Fj:{...n.Fj,
type:"percentage",Dw:b}});break;case "currency":h.m2(f,k,{...n,Fj:{...n.Fj,type:"currency",Dw:b}});break;case "date":case "select":case "mention":case "embed":case "checkbox":break;default:throw new u(n);}})});c?.ob().wk(({Oi:h})=>{this.P.track(__c.EMe,{action:"decimal_precision_changed",Qik:new Map([["precision",b.toString()]]),L3g:g.length,Oe:d,bVf:e,location:"toolbar",Tb:h()})});c?.end()}}constructor(a,b,c,d,e){this.fd=a;this.ZU=b;this.OT=c;this.V=d;this.P=e;fhx.G(this)}};var khx=({yi:a,icon:b,selected:c,...d})=>z0(a,{...d,zh:"icon",icon:b,xqc:()=>z0("div",{className:"bG_qvA",children:z0(__c.Rt,{size:"small"})}),selected:c,pressed:d.open,ariaLabel:M("2hmRmg"),tooltip:M("2hmRmg"),children:M("2hmRmg")});var tlx;tlx=Symbol.iterator;var ulx=class{static G(a){O(a,{size:B0})}get size(){return this.items.get().length}[tlx](){return this.items.get().values()}forEach(a){this.items.get().forEach(a)}map(a){return[...this.items.get()].map(a)}constructor(a){this.items=a;ulx.G(this)}};var phx=class{$Zf(a){const b=this.vg.Ma,c=this.vg.Kb;if(c?.container.type==="sheet-item"){const d=c.container;setTimeout(A0(()=>{__c.xv(this.vg,d,a,a,[a])}),0)}else b&&(b.type==="elements"&&b.inner?.type==="sheet"?this.vg.L7a(b.inner.container,a,a,[a]):b.type==="pages"&&b.inner?.type==="sheet"&&this.vg.u1a(b.inner.container,a,a,[a]),this.Gg?.iS())}constructor(a,b,c,d,e,f,g){this.vg=a;this.Gg=b;this.ZU=c;this.W1f=d;this.vJ=e;this.QA=f;this.Gia=g;this.uOa=h=>{var k=this.ZU.store.draft;if(k){const l=
k.sheet;k=k.tb;this.ZU.uOa();h=this.W1f.j5a(l,k,h)??k;this.$Zf(h)}};this.Ngg=()=>{var h=this.ZU.store.draft;h&&(h=h.tb,this.W1f.Ngg(),this.$Zf(h))};this.oQi=(h,k)=>{h.preventDefault();if(this.vJ.iIf){var l=this.ZU.store.draft;const t=l?.sheet;if(t&&l?.tb){var n=this.vJ.focus,p=this.vJ.anchor;l=l.tb;var q=n&&this.vJ.jsi(n,t),r=p&&this.vJ.jsi(p,t);h.shiftKey&&q?l=n:!h.shiftKey&&r&&(l=p);(k=this.W1f.j5a(t,l,k)??l)&&this.vJ.AKn(k,t,h);(h=this.QA.Uu(Ol.Sw))&&this.Gia.h3b(h.container,{type:"cell",tb:k})}}};
this.yUh=(h,k)=>{h.preventDefault();if(this.vJ.iIf){var l=this.ZU.store.draft,n=l?.sheet;if(n&&l?.tb){var p=this.vJ.focus,q=p&&this.vJ.jsi(p,n)?p:l.tb;l=this.vJ.anchor;l&&this.vJ.jsi(l,n)||(this.vJ.anchor=q);var r=this.vJ.anchor||q;l=new ulx(B0(()=>[q,r]));(k=this.W1f.Mqb(n,q,r,k,l))&&this.vJ.AKn(k.Iu,n,h)}}};this.zUh=h=>{h.preventDefault();this.vJ.ket()}}};var uhx=a=>{const b=a.wz,c=a.NBa;if(!a.isOpen)return null;const d=c.left;return z0(Yz,{wz:b,page:a.page,Amc:a.tA,overflow:!0,children:z0("div",{className:"PnFaJQ",style:{transform:`translate(${b.sheet.direction==="rtl"?-d:d}px, ${c.top+c.height}px) rotate(${c.rotation}deg)`},children:a.children})})};var vlx=a=>{const b=a.isDisabled;a=a.onClick;return z0(__c.pr,{ib:M("Ch3jsw"),disabled:b,onClick:a})},wlx=a=>{const b=a.isDisabled;a=a.onClick;return z0(__c.hd,{ib:M("FTDHig"),disabled:b,onClick:a})},xlx=a=>z0(Wi,{variant:"tertiary",size:"xsmall",Qc:"small",ib:a.label,...a}),ylx=a=>z0(Wi,{className:"EjBHAg",variant:"secondary",...a,children:z0(Q,{tagName:"span",tone:__c.cr,children:a.label})}),zlx=a=>{const b=a.kind,c=a.isDisabled;a=a.onClick;const d=M("zWsr5g");return b==="decorator"?z0(xlx,{icon:__c.tD,
label:d,disabled:c,onClick:a}):z0(Wi,{variant:"secondary",icon:__c.tD,ib:d,disabled:c,onClick:a})},Alx=a=>{const b=a.kind,c=a.isDisabled;a=a.onClick;const d=M("B+nttQ");return b==="decorator"?z0(xlx,{icon:__c.yE,label:d,disabled:c,onClick:a}):b==="pill"?z0(ylx,{label:d,disabled:c,onClick:a}):z0(Wi,{variant:"secondary",icon:__c.yE,ib:d,disabled:c,onClick:a})},Blx=a=>{const b=a.kind,c=a.isDisabled;a=a.onClick;const d=M("xcLRBg");return b==="pill"?z0(ylx,{label:d,disabled:c,onClick:a}):z0(Wi,{variant:"tertiary",
disabled:c,onClick:a,children:d})},Clx=a=>{var b=a.tb;const c=a.stretch,d=a.isDisabled;a=a.onClick;const e=$hx(null);yfx(()=>{e.current?.focus()},[]);b=b?J("mFKgsg",[b]):M("tFf+lQ");return z0(Wi,{ref:e,variant:"primary",stretch:c,disabled:d,onClick:a,children:b})};var Dlx=a=>{const b=a.wPc,c=a.QZb,d=a.Svc;a=a.CGd;return F0(br,{spacing:"1u",Fa:"center",children:[z0(__c.bci,{size:"medium"}),d&&z0(Blx,{kind:"pill",isDisabled:b,onClick:d}),a&&z0(Alx,{kind:"pill",isDisabled:c,onClick:a})]})};var Elx=a=>{const {alignment:b="center",sce:c}=a;return z0(R,{Pc:"1u",display:"flex",justifyContent:b,children:z0(Q,{size:"small",children:c?z0(__c.ak,{message:M("TKhttg"),Kx:"subtle",uf:d=>c(d)}):M("5DN/iQ")})})};var Flx=({message:a})=>z0(Q,{size:"small",tone:"critical",children:a});var Hlx=a=>{const b=a.Nzb,c=a.B8d,d=a.QZb,e=a.mPf,f=a.CGd;a=a.qgf;return F0(I0,{children:[z0(Q,{children:b?z0(__c.Zj,{message:J("wLl6iw",[__c.sx(b)])}):M("2ywUoQ")}),z0(Glx,{content:z0(a,{}),end:F0(I0,{children:[e&&z0(zlx,{kind:"decorator",isDisabled:c,onClick:e}),f&&z0(Alx,{kind:"decorator",isDisabled:d,onClick:f})]}),Jtr:!0})]})},Ilx=a=>{a=a.iPa;return z0(Glx,{content:z0(R,{Lb:"0.5u",Pc:"1u",children:F0(Tc,{spacing:"0.5u",children:[z0(__c.dr,{tone:"tertiary",size:"xxsmall",children:M("GbNwhw")}),
z0(Q,{size:"small",children:z0("span",{className:"Fhe6Zg",children:a})})]})})})},Glx=a=>{const {content:b,end:c,Jtr:d=!1}=a;return z0(__c.Sc,{SK:"light",dark:"light",children:e=>z0(R,{className:d?e.className:void 0,borderRadius:"element",background:d?"surface":void 0,children:F0(R,{borderRadius:"element",padding:"0.5u",background:"neutralLow",display:"flex",justifyContent:"spaceBetween",alignItems:"center",children:[z0(R,{className:"IQ4k2g",tp:"0.5u",children:b}),c!=null?z0(R,{gxb:"start",display:"flex",
flexWrap:"noWrap",children:c}):null]})})})};var Jlx=a=>z0(R,{background:"criticalLow",borderRadius:"elementSmall",Lb:"0.5u",children:z0(__c.$yc,{tone:"critical",size:"xsmall",lineClamp:1,children:a.text})}),Klx=a=>{const b=a.LZb,c=a.Dpi,d=a.odd,e=a.U2r;return F0("div",{className:"UShmdA",children:[z0(__c.id,{title:z0(R,{tp:"0.5u",children:z0(Jlx,{text:a.formula||""})}),end:z0(wlx,{isDisabled:b,onClick:d}),padding:"1.5u",Wu:!1}),z0(R,{Lb:"2u",children:z0(Q,{size:"small",tone:"secondary",children:M("3mwS/g")})}),z0(R,{Lb:"2u",Pc:"1.5u",children:z0(Wi,
{variant:"primary",stretch:!0,icon:__c.tB,disabled:c,onClick:e,children:M("ZyZidw")})})]})},Llx=a=>{const {layout:b="compact",error:c,Nzb:d,iPa:e,XLl:f,LZb:g,QZb:h,wPc:k,odd:l,mPf:n,CGd:p,sce:q,Svc:r,i0k:t,qgf:v}=a;return F0("div",{className:"E7kETw",children:[z0(__c.id,{title:z0(R,{tp:"0.5u",children:z0(__c.dr,{size:"xsmall",lineClamp:1,children:M("epc7ew")})}),end:z0(wlx,{isDisabled:g,onClick:l}),padding:"1.5u"}),d&&z0(R,{padding:"2u",paddingTop:"1.5u",children:F0(Tc,{spacing:"1u",children:[z0(Hlx,
{Nzb:d,QZb:h,mPf:b==="comfortable"?n:void 0,CGd:b==="comfortable"?p:void 0,qgf:v}),e&&z0(Ilx,{iPa:e}),b==="compact"&&(r||!e&&p)&&z0(Dlx,{wPc:k,QZb:h,Svc:r,CGd:e?void 0:p})]})}),z0(R,{borderTop:"low",Lb:"2u",Pc:"1.5u",children:b==="compact"?F0(Tc,{spacing:"1u",children:[F0($q,{Fa:"start",spacing:"1u",align:"spaceBetween",children:[n&&z0(Yq,{width:"content",children:z0(zlx,{onClick:n})}),t&&z0(Yq,{children:z0(Clx,{tb:f,stretch:!0,onClick:t})})]}),z0(Elx,{sce:q})]}):F0($q,{spacing:"1u",Fa:"center",children:[F0(Yq,
{children:[!c&&z0(Elx,{alignment:"start",sce:q}),c&&z0(Flx,{message:c})]}),r&&z0(Yq,{width:"content",children:z0(Blx,{isDisabled:k,onClick:r})}),t&&z0(Yq,{width:"content",children:z0(Clx,{tb:f,onClick:t})})]})})]})};var Mlx=class{PMe(){this.store.formula&&(this.UG("copy"),xhx(this.Nha,this.store.formula))}async Mii(){this.UG("explain_formula");this.store.error=void 0;this.store.iPa=void 0;this.store.UD=!0;if(!await rhx(this)&&this.XRc)$fx(()=>{this.dispose();this.XRc()});else{var a=await this.Nha.k$h({formula:this.store.formula||""});$fx(()=>{this.store.UD=!1;a.status==="failure"?(this.UG("explain_formula_error",{Bqc:a.error}),this.store.error=a.error):(this.UG("explain_formula_success"),this.store.iPa=a.iPa)})}}V5d(){this.UG("insert");
yhx(this.Nha,this.store.formula||"");this.dispose()}handleClose(){this.dispose()}ZCa(){this.reset();this.UG("opened");this.store.isOpen=!0}reset(){this.store.state=0;this.store.error=void 0;this.store.formula=void 0;this.store.Nzb=void 0;this.store.iPa=void 0;this.store.UD=!1}dispose(){this.UG("exit");this.reset();this.store.isOpen=!1;this.x5?.()}UG(a,b){this.Nha.UG({action:a,feature:"formula_fixer",HUk:this.store.state===0?"input":"output",...b})}constructor(a,b,c,d){this.Nha=a;this.store=b;this.XRc=
c;this.x5=d}};var Nlx=class{static G(a){O(a,{_state:H0.ref,state:B0,error:H0.ref,formula:H0.ref,Nzb:H0.ref,iPa:H0.ref,isOpen:H0.ref,UD:H0.ref,Dpi:B0,B8d:B0,QZb:B0,wPc:B0,yHf:B0,LZb:B0})}get state(){return this._state}set state(a){a!==this._state&&(this._state=a)}get Dpi(){return this.UD}get B8d(){return!this.formula||this.UD}get QZb(){return!this.formula||this.UD||this.iPa!=null}get wPc(){return this.UD}get yHf(){return!this.formula||this.UD}get LZb(){return this.UD}constructor(){this._state=(Nlx.G(this),0);this.UD=
this.isOpen=!1}};var Olx=a=>{const {width:b="large",gxr:c=!0,onClose:d,children:e}=a;return z0(c?__c.C$d:R,{className:G0("gq5gkA",b==="large"&&"xqApGA"),borderRadius:"container",background:"surface",shadow:"surface",children:z0(__c.kr,{Tza:d,children:e})})};var thx=({Nub:a,mTb:b,Nha:c,x5:d,XRc:e,Yvf:f})=>{const g=new Nlx,h=new Mlx(c,g,e,d),k=A0(()=>h.handleClose()),l=A0(()=>shx(h)),n=A0(()=>h.PMe()),p=A0(()=>h.Mii()),q=A0(()=>h.V5d()),r=A0(y=>{y==="terms"?h.UG("terms_cta"):h.UG("feedback_cta")}),t=D0(()=>z0(Klx,{formula:c.Wle,LZb:g.LZb,Dpi:g.Dpi,odd:k,U2r:l})),v=D0(()=>c.target&&g.formula?z0(b,{sheet:c.target.sheet,formula:g.formula,wrap:!0}):null),w=D0(({layout:y})=>z0(Llx,{layout:y,error:g.error,Nzb:g.Nzb,iPa:g.iPa,XLl:c.Zth,LZb:g.LZb,QZb:g.QZb,wPc:g.wPc,
odd:k,mPf:g.B8d?void 0:n,CGd:f?p:void 0,sce:r,i0k:g.yHf?void 0:q,qgf:v})),x=D0(({layout:y})=>g.state===0?z0(t,{}):z0(w,{layout:y}));d=D0(()=>z0(Olx,{width:g.state===0?"small":void 0,gxr:g.state===1,onClose:k,children:z0(x,{layout:"comfortable"})}));e=D0(()=>z0(a.FJa,{open:g.isOpen,oa:k,children:z0(x,{layout:"compact"})}));return{store:g,L:h,Fhp:d,Ghp:e}};var Plx={eventType:"magic_formulas_interacted",Oa(a){return __c.jf({action:a.action,feature:a.feature,modal_stage:a.HUk,source:a.source,location:a.location,prompt_source:a.vO,credits_remaining:a.D_t,credits_used:a.u_h,word_count:a.GC,character_count:a.wJ,error_category:a.Bqc,error_id:a.Mya,editing_context:a.Ca==null?void 0:__c.mf(a.Ca),performance_context:a.Tb==null?void 0:__c.pf(a.Tb),formula_context:a.Y3d==null?void 0:__c.jf({functions:a.Y3d.functions})})}};var Qlx=F(()=>({}));var Rlx=F(()=>({wc:__c.S(1)}));var Slx=F(()=>({wc:__c.S(1)}));var Ghx=class{static G(a){O(a,{Kxa:H0.ref,target:B0,Zth:B0,Wle:B0,qgg:H0.ref,bUg:B0,ate:H0.ref,heh:B0,yRe:B0,qPi:B0({equals:__c.gk(__c.Qj)}),dif:H0.ref,B1e:B0,Kwo:B0})}get target(){return this.Kxa}get Zth(){if(this.Kxa){var a=this.Kxa.tA,b=this.Kxa.sheet,{ec:c,$b:d}=b.layout.cells.get(a.row,a.column)?.span||{ec:a.column,$b:a.row};return __c.Nm({column:c,row:d},b)}}get Wle(){if(this.Kxa){var a=this.Kxa.tA,b=this.Kxa.sheet;a=b.layout.cells.get(a.row,a.column);if(a?.ref?.content.ref?.type==="formula")return`=${Z8q(this.sE,
b,a.ref.content.ref.value).gna}`}}get bUg(){return this.qgg}get heh(){return this.ate}eZi(a){this.ate=a}get yRe(){if(!this.Kxa||!this.ate)return!1;try{return!!__c.rAb(this.ate,this.Kxa.sheet)}catch(a){return!1}}get qPi(){if(this.Kxa&&this.yRe){var a=this.Kxa.sheet,b=__c.rAb(this.ate,a),{start:c,end:d}=__c.sAb(a,b);switch(c.type){case 0:sa(d.type===0);b=c.value.row;var e=c.value.column;var f=d.value.row;var g=d.value.column;break;case 2:sa(d.type===2);b=c.value;e=m(a.layout.cols.first());f=d.value;
g=m(a.layout.cols.last());break;case 1:sa(d.type===1);b=m(a.layout.rows.first());e=c.value;f=m(a.layout.rows.last());g=d.value;break;default:throw new u(c);}return Lj(a.yd(e),a.ld(b),a.yd(g)+g.width,a.ld(f)+f.height)}}get B1e(){if(this.g9f&&this.mba){var a=this.mba.ega.status;switch(a){case "success":a=this.mba.ega.response;const b=a.HT?Math.floor((a.HT-Date.now())/1E3):void 0;return{state:"loaded",quota:{...a,expires:b}};case "loading":case "uninitialized":case "error":return{state:"loading"};default:throw new u(a);
}}return this.dif}async tgd(){if(this.g9f&&this.mba)await this.mba.Apa();else{$fx(()=>this.dif={state:"loading"});new Qlx;var {quota:a}=await this.YJe.h4m();$fx(()=>this.dif={state:"loaded",quota:a})}}get Kwo(){if(this.g9f&&this.mba)switch(this.mba.ega.status){case "loading":return!0;case "success":return this.mba.ega.response.qG<=50;case "error":case "uninitialized":return!1;default:throw new u(this.mba.ega);}if(this.dif.state==="loading")return!0;const a=this.dif.quota;return a?a.qG<=50:!1}async k$h({formula:a,
PCa:b}){const c=new __c.v7c({content:this.Rzd()});a=new __c.uQn({formula:a,sheet:c,selection:this.Zth,rZo:b,Sxg:this.document?.language});try{const d=(await this.YJe.Thm(a)).wc,e=(await __c.Rh(async()=>{const g=await this.YJe.r2n(new Rlx({wc:d}));if(g.status.type!=="PENDING")return g},{initialDelay:300,sN:1.2,oH:3E3,Js:2E4}).result).status;if(e.type!=="COMPLETE"||e.result.type!=="SUCCESS")throw Error("Unexpected status");const f=e.result.explanation;await zhx(this);return{status:"success",iPa:f}}catch(d){return d instanceof
__c.uh?{status:"failure",error:"throttled",endUserMessage:M("bCo9UQ")}:d instanceof __c.rh?{status:"failure",error:"forbidden",endUserMessage:d.endUserMessage}:{status:"failure",error:"unknown",endUserMessage:M("LEcD9A")}}}async Igk({formula:a}){return this.zej({PCa:`Fix this formula: "${a}"`})}async zej({PCa:a,JTc:b}){const c=new __c.v7c({content:this.Rzd()});a=new __c.wQn({PCa:a,sheet:c,selection:this.Zth,DE:this.yRe?this.heh:void 0,Sxg:this.document?.language,JTc:b});try{const d=(await this.YJe.Whm(a)).wc,
e=await __c.Rh(async()=>{const k=await this.YJe.u2n(new Slx({wc:d}));if(k.type!=="PENDING")return k},{initialDelay:300,sN:1.2,oH:3E3,Js:2E4}).result;if(e.type==="ERROR")return{status:"failure",error:"formula",endUserMessage:e.pqt};const f=e.result.formula;await zhx(this);const g=__c.Gde(this.sE,{type:0,Ora:f.slice(1)});if(g==null)return{status:"failure",error:"invalid"};const h="="+g.gna;return vhx(this,h)?{status:"success",formula:h}:{status:"failure",error:"invalid"}}catch(d){return d instanceof
__c.Oh?{status:"failure",error:"timeout",endUserMessage:M("LEcD9A")}:d instanceof __c.rh?{status:"failure",error:"forbidden",endUserMessage:d.endUserMessage}:d instanceof __c.uh?{status:"failure",error:"throttled",endUserMessage:M("bCo9UQ")}:d instanceof __c.Sb?{status:"failure",error:d.message||"unknown",endUserMessage:d.endUserMessage||M("LEcD9A")}:{status:"failure",error:"unknown",endUserMessage:M("LEcD9A")}}}wEg(a){if(this.Kxa&&vhx(this,a))switch(a=__c.b9q(this.pAb,this.Kxa.sheet,{type:1,gna:a.slice(1)}),
a.type){case 0:return this.vIs?.(a.value,a.Cb);case 2:return a.value.toString();case 1:return a.value?"TRUE":"FALSE";case 3:return __c.jQd[a.value];case 16:return a=a.value.fYd(),a.type===2?a.value:void 0;case 15:break;case 4:throw Error();default:throw new u(a);}}Rzd(){if(this.Kxa){var a=this.Kxa.sheet,b=new Map;a.layout.cells.forEach((c,d)=>{if(c.content.ref){c=d.ec;var e=d.$b;d=__c.Nm({column:c,row:e},a);c=this.hLd(a,e,c);d&&c&&b.set(d,c)}});return b}}UG(a){this.P.track(Plx,{source:"editor",...a})}constructor(a,
b,c,d,e,f,g,h,k,l,n,p,q){this.P=a;this.ma=b;this.sE=c;this.pAb=d;this.YJe=e;this.mba=f;this.hLd=g;this.vIs=h;this.ico=k;this.resolveTarget=l;this.fd=n;this.g9f=p;this.document=q;this.Kxa=(Ghx.G(this),void 0);this.qgg=!1;this.ate="";this.dif={state:"loading"};this.dF=new __c.mu;Xfx(this.resolveTarget,r=>{this.Kxa=r;this.qgg=!1;this.ate=this.Kxa?Mex(this.dF,this.Kxa.sheet)??"":""},{fireImmediately:!0})}};var Dhx=class extends __c.VTd{gef(a){this.visit(a);return this.Y3d}l$f(a){const b=__c.BHb(a.name);b!=null&&(this.Y3d.functions?this.Y3d.functions.push(b):this.Y3d.functions=[b]);super.l$f(a)}constructor(){super();this.Y3d={}}};var Tlx=a=>{a=a.onClick;return z0(Wi,{variant:"tertiary",icon:PF,ib:M("RU0r2A"),onClick:a})},Ulx=a=>{const b=a.value,c=a.isValid;a=a.onChange;return z0(__c.er,{label:M("0DW77g"),children:z0(__c.rv,{tN:G0("_0QCk9A",{nuzGhw:!c}),value:b,error:!c,autoCorrect:"off",o8b:!0,U$a:!0,ariaLabel:M("0DW77g"),end:z0(PF,{}),onChange:a})})},Vlx=a=>{const b=a.value,c=a.isValid,d=a.onChange,e=a.kh;a=mfx(f=>{f.key==="Enter"&&c&&e()},[c,e]);return z0(__c.rv,{className:"unqi8g",tN:G0("_0QCk9A",{nuzGhw:!c}),value:b,error:!c,
autoFocus:"always",autoCorrect:"off",U$a:!0,ariaLabel:M("0DW77g"),start:z0(PF,{}),end:z0(__c.ir,{variant:"primary",size:"xsmall",icon:__c.sr,ib:M("+RR/6Q"),disabled:!c,onClick:e}),onKeyDown:a,onChange:d})},Wlx=a=>F0(R,{display:"flex",alignItems:"center",Lb:"1u",children:[z0(PF,{size:"small"}),z0(jd,{size:"0.5u"}),z0(Q,{children:z0("span",{className:"_0QCk9A",children:a.value})})]}),Ohx=a=>{const b=a.qPi,c=a.wz,d=a.page;if(!a.isOpen||!b)return null;const {top:e,left:f,width:g,height:h}=b.scale(c.gd).Nb();
return z0(Yz,{wz:c,page:d,children:z0(__c.Sc,{SK:"light",dark:"light",children:k=>z0("div",{className:G0(k.className,"UPSnHA"),style:{top:e,left:f,width:g,height:h}})})})};var Xlx='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.038 19.344c-.418 0-.764-.053-1.038-.16V17.86a2.7 2.7 0 0 0 .794.14c.623 0 1.034-.477 1.233-1.429l1.512-7.12H3.292l.146-.738 1.352-.53.146-.64c.204-.92.516-1.572.934-1.958C6.292 5.195 6.889 5 7.66 5c.534 0 1.024.1 1.47.3l-.425 1.226a2.697 2.697 0 0 0-.948-.195c-.32 0-.578.1-.773.3-.19.199-.337.526-.439.981l-.125.6h1.595l-.258 1.24H6.162L4.61 16.787c-.186.878-.49 1.524-.913 1.937-.423.413-.975.62-1.658.62Z" fill="url(#_1112687897__a)"/><path d="M8.001 13.994c0-1.593.288-3.06.864-4.403.58-1.347 1.463-2.633 2.647-3.86h1.456C10.655 8.277 9.5 11.04 9.5 14.021c0 1.528.267 2.912.801 4.152H9.025c-.682-1.212-1.024-2.605-1.024-4.18Z" fill="url(#_1112687897__b)"/><path d="m15.323 13.22-2.125 2.696h-1.88l3.308-3.963-1.609-3.741h1.707l1.003 2.598 2-2.598h1.908l-3.211 3.824 1.727 3.88h-1.713l-1.115-2.696Z" fill="url(#_1112687897__c)"/><path d="M23 9.925c0 1.589-.286 3.052-.857 4.39-.571 1.332-1.456 2.618-2.654 3.859h-1.456c2.313-2.545 3.47-5.309 3.47-8.29 0-1.52-.268-2.903-.802-4.153h1.275C22.659 6.962 23 8.361 23 9.925Z" fill="url(#_1112687897__d)"/><defs><linearGradient id="_1112687897__a" x1="-10" y1="12.172" x2="3.125" y2="32.302" gradientUnits="userSpaceOnUse"><stop stop-color="#00C4CC"/><stop offset="1" stop-color="#7D2AE8"/></linearGradient><linearGradient id="_1112687897__b" x1="-10" y1="12.172" x2="3.125" y2="32.302" gradientUnits="userSpaceOnUse"><stop stop-color="#00C4CC"/><stop offset="1" stop-color="#7D2AE8"/></linearGradient><linearGradient id="_1112687897__c" x1="-10" y1="12.172" x2="3.125" y2="32.302" gradientUnits="userSpaceOnUse"><stop stop-color="#00C4CC"/><stop offset="1" stop-color="#7D2AE8"/></linearGradient><linearGradient id="_1112687897__d" x1="-10" y1="12.172" x2="3.125" y2="32.302" gradientUnits="userSpaceOnUse"><stop stop-color="#00C4CC"/><stop offset="1" stop-color="#7D2AE8"/></linearGradient></defs></svg>';var Mhx=Uq({medium:Xlx});var Ylx=({Nha:a,xnt:b})=>{const c=A0(()=>{a.qgg=!0;b&&a.UG({action:"open_cell_selection",...b})}),d=A0(l=>{a.eZi(l);b&&a.yRe&&a.UG({action:"update_cell_selection",...b})}),e=A0(()=>{a.bUg&&(a.qgg=!1)}),f=D0(()=>z0(Tlx,{onClick:c})),g=D0(()=>z0(Ulx,{value:a.heh,isValid:a.yRe,onChange:d})),h=D0(()=>z0(Vlx,{value:a.heh,isValid:a.yRe,onChange:d,kh:e})),k=D0(()=>a.yRe?z0(Wlx,{value:a.heh}):null);return{ujj:f,P2a:g,opj:h,ppj:k}};var Zlx=a=>{var b=a.B1e,c=a.Nza,d=a.pid;a=a.Nz;if(b.state==="loading")return z0(R,{width:"full",className:"oS2_DA",children:z0(__c.Ut,{})});(b=b.quota)?b.expires==null?c=z0("div",{className:G0({tQTLVw:d}),children:F0($q,{spacing:"0.5u",Fa:"center",children:[a&&z0(Yq,{width:"content",children:z0(a,{})}),z0(Yq,{children:z0(Q,{size:"small",children:c?z0(__c.ak,{message:J("bfaP0g",[b.qG]),Kx:"subtle",uf:c}):J("aLIqiA",[b.qG])})})]})}):(c=G0({tQTLVw:d}),d=b.qG,b=b.expires,b=new Date(Date.now()+b*1E3),
d=J("2mpEbA",[d,b]),c=z0("div",{className:c,children:z0(Q,{size:"small",children:d})})):c=null;return c};var $lx=a=>{const {value:b,Ln:c=1,isDisabled:d,onChange:e,Oza:f}=a,g=__c.Kee(),h=$hx(null);yfx(()=>{!g&&h.current&&setTimeout(()=>{h.current&&(h.current.setSelectionRange(h.current.value.length,h.current.value.length),h.current.focus())},0)},[g]);a=mfx(k=>{const l=k.shiftKey;var n=k.currentTarget;const p=n.selectionStart;n=n.value;k.key!=="Enter"||l||p!==n.length||f?.()},[f]);return z0(__c.TC,{ref:h,tN:"UUDdJQ",ft:!0,Ln:c,PK:!0,cOa:0,value:b,ariaLabel:M("Vo1mIQ"),placeholder:M("vHHyQA"),disabled:d,
onChange:e,onKeyDown:a})},amx=a=>{const {layout:b="compact",PCa:c,LZb:d,lFk:e,bUg:f,VRe:g,odd:h,b2r:k,T3r:l,nDi:n,bDi:p,hpj:q,Xjj:r,pbg:t,ujj:v,P2a:w,opj:x}=a;return F0("div",{className:"Vrl2yA",children:[z0(__c.id,{start:F0(I0,{children:[z0(R,{tp:"1u",children:z0(Mhx,{size:"medium",tone:"primary"})}),z0(__c.dr,{size:"xxsmall",tone:"primary",children:M("kJvD9Q")})]}),end:z0(wlx,{isDisabled:d,onClick:h}),padding:"1.5u",Wu:b==="compact"}),z0(R,{padding:"2u",paddingTop:b==="compact"?"1.5u":"0.5u",children:z0($lx,
{value:c,Ln:b==="compact"?3:1,isDisabled:e,onChange:k,Oza:l})}),b==="compact"&&f&&x&&!r?z0(R,{Lb:"1.5u",paddingBottom:"2u",children:z0(x,{})}):z0(R,{borderTop:b==="comfortable"?"low":void 0,Lb:"2u",Pc:"1.5u",children:F0($q,{spacing:"1u",align:"end",Fa:"center",children:[F0(Yq,{children:[q&&z0(q,{}),r&&z0(r,{})]}),b==="compact"&&v&&!r&&z0(Yq,{width:"containedContent",children:z0(v,{})}),b==="comfortable"&&w&&!r&&z0(Yq,{width:"containedContent",children:z0(w,{})}),z0(Yq,{width:"content",children:t&&
z0(t,{hasError:!!r,VRe:g,nDi:n,bDi:p})})]})})]})},bmx=a=>{const {layout:b="compact",title:c,Nzb:d,iPa:e,XLl:f,EDk:g,LZb:h,B8d:k,QZb:l,wPc:n,yHf:p,S0b:q,odd:r,mPf:t,CGd:v,sce:w,Svc:x,i0k:y,Xjj:z,ppj:B,qgf:C}=a;return F0("div",{className:"PBfe8Q",children:[z0(__c.id,{title:z0(__c.Mzc,{alignment:"start",children:c}),start:q&&z0(vlx,{isDisabled:g,onClick:q}),end:F0(I0,{children:[B&&z0(B,{}),z0(wlx,{isDisabled:h,onClick:r})]}),padding:"1.5u"}),z0(R,{padding:"2u",paddingTop:"1.5u",children:F0(Tc,{spacing:"1u",
children:[z0(Hlx,{Nzb:d,B8d:k,QZb:l,mPf:b==="comfortable"?t:void 0,CGd:b==="comfortable"?v:void 0,qgf:C}),e&&z0(Ilx,{iPa:e}),b==="compact"&&(x||!e&&v)&&z0(Dlx,{wPc:n,QZb:l,Svc:x,CGd:e?void 0:v})]})}),z0(R,{borderTop:"low",Lb:"2u",Pc:"1.5u",children:b==="compact"?F0(Tc,{spacing:"1u",children:[F0($q,{Fa:"start",spacing:"1u",align:"spaceBetween",children:[t&&z0(Yq,{width:"content",children:z0(zlx,{isDisabled:k,onClick:t})}),y&&z0(Yq,{children:z0(Clx,{tb:f,stretch:!0,isDisabled:p,onClick:y})})]}),z0(Elx,
{sce:w})]}):F0($q,{spacing:"1u",Fa:"center",children:[F0(Yq,{children:[(d!==void 0||e!==void 0)&&z0(Elx,{alignment:"start",sce:w}),z&&z0(z,{})]}),x&&z0(Yq,{width:"content",children:z0(Blx,{isDisabled:n,onClick:x})}),y&&z0(Yq,{width:"content",children:z0(Clx,{tb:f,isDisabled:p,onClick:y})})]})})]})};var cmx=class{pid(){__c.tb.rd&&!this.store.pid&&(this.store.pid=!0,setTimeout(A0(()=>{this.store.pid=!1}),750))}qba(){const a=this.store.PCa;this.UG("back");this.reset();this.store.PCa=a}PMe(){this.store.formula&&(this.UG("copy"),xhx(this.Nha,this.store.formula))}async Mii(){this.UG("explain_formula");this.store.error=void 0;this.store.iPa=void 0;this.store.UD=!0;var a=this.Nha.B1e;if(a.state==="loaded"){a=a.quota;const c=a?.expires==null;if(this.XRc&&c&&a&&a.qG<=0){this.dispose();this.XRc();return}}const b=
await this.Nha.k$h({formula:this.store.formula||"",PCa:this.store.PCa});$fx(()=>{this.store.UD=!1;b.status==="failure"?(this.UG("explain_formula_error",{Bqc:b.error}),this.store.error=b.endUserMessage||M("LEcD9A")):(this.UG("explain_formula_success"),this.store.iPa=b.iPa)})}V5d(){this.UG("insert");yhx(this.Nha,this.store.formula||"");this.dispose()}handleClose(){this.dispose()}ZCa(a){this.reset();this.UG("opened",{location:a});this.store.isOpen=!0}reset(){this.store.state=0;this.store.error=void 0;
this.store.JTc=[];this.store.PCa="";this.store.formula=void 0;this.store.Nzb=void 0;this.store.iPa=void 0;this.store.UD=!1;this.store.jhh=!1;this.store.K8d=!1}dispose(){this.UG("exit");this.reset();this.store.isOpen=!1;this.store.pid=!1;this.x5?.()}UG(a,b){this.Nha.UG({action:a,feature:"formula_writer",HUk:this.store.state===0?"input":"output",...b})}constructor(a,b,c,d){this.Nha=a;this.store=b;this.XRc=c;this.x5=d}};var dmx=class{static G(a){O(a,{_state:H0.ref,state:B0,error:H0.ref,JTc:H0.ref,PCa:H0.ref,formula:H0.ref,Nzb:H0.ref,iPa:H0.ref,isOpen:H0.ref,UD:H0.ref,jhh:H0.ref,K8d:H0.ref,pid:H0.ref})}get state(){return this._state}set state(a){a!==this._state&&(this._state=a)}get lFk(){return this.UD}get VRe(){return this.UD||this.PCa.length===0||this.PCa.length>5E3}get EDk(){return this.UD}get B8d(){return!this.formula||this.UD}get QZb(){return!this.formula||this.UD||this.iPa!=null}get wPc(){return this.UD}get yHf(){return!this.formula||
this.UD}get LZb(){return this.UD}constructor(){this._state=(dmx.G(this),0);this.JTc=[];this.PCa="";this.pid=this.K8d=this.jhh=this.UD=this.isOpen=!1}};var emx='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.038 19.344c-.418 0-.764-.053-1.038-.16V17.86a2.7 2.7 0 0 0 .794.14c.623 0 1.034-.477 1.233-1.429l1.512-7.12H3.292l.146-.738 1.352-.53.146-.64c.204-.92.516-1.572.934-1.958C6.292 5.195 6.889 5 7.66 5c.534 0 1.024.1 1.47.3l-.425 1.226a2.697 2.697 0 0 0-.948-.195c-.32 0-.578.1-.773.3-.19.199-.337.526-.439.981l-.125.6h1.595l-.258 1.24H6.162L4.61 16.787c-.186.878-.49 1.524-.913 1.937-.423.413-.975.62-1.658.62ZM8.001 13.994c0-1.593.288-3.06.864-4.403.58-1.347 1.463-2.633 2.647-3.86h1.456C10.655 8.277 9.5 11.04 9.5 14.021c0 1.528.267 2.912.801 4.152H9.025c-.682-1.212-1.024-2.605-1.024-4.18ZM15.323 13.22l-2.125 2.696h-1.88l3.308-3.963-1.609-3.741h1.707l1.003 2.598 2-2.598h1.908l-3.211 3.824 1.727 3.88h-1.713l-1.115-2.696ZM23 9.925c0 1.589-.286 3.052-.857 4.39-.571 1.332-1.456 2.618-2.654 3.859h-1.456c2.313-2.545 3.47-5.309 3.47-8.29 0-1.52-.268-2.903-.802-4.153h1.275C22.659 6.962 23 8.361 23 9.925Z" fill="currentColor"/></svg>';var Qhx=Uq({medium:emx});var fmx=({disabled:a})=>F0(I0,{children:[z0(Q,{size:"medium",weight:"bold",tone:a?__c.cr:"primary",children:M("sHF9wA")}),z0(Q,{size:"small",tone:a?__c.cr:"tertiary",children:M("hbS9xw")})]}),gmx=()=>z0(R,{border:"low",borderRadius:"element",background:"neutralLow",display:"flex",alignItems:"center",justifyContent:"center",className:"_63I7iQ",children:z0(Mhx,{size:"medium"})}),hmx=()=>z0(R,{border:"low",borderRadius:"element",display:"flex",alignItems:"center",justifyContent:"center",className:"oCjpjg",
children:z0(Qhx,{size:"medium"})});var imx=({hasError:a,VRe:b,nDi:c,bDi:d})=>a?z0(Wi,{variant:"tertiary",size:"small",onClick:d,children:M("6swZ8w")}):z0(__c.ir,{variant:"primary",size:"small",icon:__c.Ot,ib:M("beXYZg"),disabled:b,onClick:c});var Lhx=({Nub:a,mTb:b,Nha:c,zNa:d,x5:e,Nza:f,XRc:g,Yvf:h,V$j:k})=>{const l=new dmx,n=new cmx(c,l,g,e),p=A0(()=>n.qba()),q=A0(()=>n.handleClose()),r=A0(ba=>{const da=n.Nha.B1e;da.state==="loaded"&&da.quota&&da.quota.qG<=0?(n.store.PCa="",n.pid()):(n.store.PCa=ba,n.store.jhh=!1)}),t=A0(()=>{n.reset()}),v=A0(()=>Khx(n)),w=A0(()=>n.PMe()),x=A0(()=>n.Mii()),y=A0(()=>n.V5d()),z=A0(ba=>{ba==="terms"?n.UG("terms_cta"):n.UG("feedback_cta")}),{ujj:B,P2a:C,opj:G,ppj:H}=Ylx({Nha:c,xnt:{feature:"formula_writer",
HUk:"input"}}),K=D0(()=>c.target&&l.formula?z0(b,{sheet:c.target.sheet,formula:l.formula,wrap:!0}):z0(__c.hv,{})),L=()=>z0(__c.Ax,{size:"small"}),N=D0(()=>!c.Kwo||l.error?null:k&&d?z0(d,{UC:f}):z0(Zlx,{B1e:c.B1e,Nza:f,Nz:L,pid:l.pid})),P=D0(()=>z0(imx,{hasError:l.jhh,VRe:l.VRe,nDi:v,bDi:t})),T=D0(()=>l.error?z0(Flx,{message:l.error}):null),V=D0(({layout:ba})=>z0(amx,{layout:ba,PCa:l.PCa,LZb:l.LZb,lFk:l.lFk,bUg:c.bUg,VRe:l.VRe,odd:q,b2r:r,T3r:v,nDi:v,hpj:N,Xjj:T,pbg:P,bDi:t,ujj:B,P2a:C,opj:G})),W=
D0(({layout:ba})=>z0(bmx,{layout:ba,title:l.K8d?M("B+nttQ"):l.PCa,Nzb:l.Nzb,iPa:l.iPa,XLl:c.Zth,EDk:l.EDk,LZb:l.LZb,B8d:l.B8d,QZb:l.QZb,wPc:l.wPc,yHf:l.yHf,S0b:l.K8d?void 0:p,odd:q,mPf:w,CGd:h&&!l.K8d?x:void 0,sce:z,Svc:l.K8d?x:v,i0k:l.K8d?void 0:y,Xjj:T,ppj:H,qgf:K})),aa=D0(({layout:ba})=>l.state===0?z0(V,{layout:ba}):z0(W,{layout:ba}));e=D0(()=>z0(Olx,{onClose:q,children:z0(aa,{layout:"comfortable"})}));g=D0(()=>z0(a.FJa,{open:l.isOpen,oa:q,children:z0(aa,{layout:"compact"})}));return{store:l,L:n,
Hhp:e,Ihp:g}},Nhx=({yis:a})=>{const b={start:gmx,onClick:A0(()=>a("formula_floating_toolbar")),children:z0(fmx,{}),disabled:!1},c={start:hmx,onClick:A0(()=>a("formula_floating_toolbar")),children:z0(fmx,{disabled:!0}),disabled:!0},d={type:"simple",key:"formula-writer",name:M("sHF9wA"),Icon:Mhx,execute:A0(async()=>a("quick_actions"))},e={type:"simple",key:"formula-writer-insert",name:M("sHF9wA"),Icon:Mhx,execute:A0(async()=>a("quick_actions"))};return{c0q:b,a0q:c,d0q:d,b0q:e}};var Whx={eventType:"sheets_quick_insights_interacted",Oa(a){return __c.jf({action:a.action,insight_type:a.itc,insight_category:a.$in,num_cells_in_sample:a.aBi,editing_context:a.Ca==null?void 0:__c.mf(a.Ca),performance_context:a.Tb==null?void 0:__c.pf(a.Tb)})}};var dix=class{oYc(a){this.P.track(Whx,{action:"menu_opened",...a})}constructor(a){this.P=a}};var gix=class{static G(a){O(a,{onChange:A0.bound,onCopy:A0.bound,Nh:A0.bound,PXe:A0,aTo:A0.bound})}onChange(a){this.N.P.track(Whx,{action:"option_selected",...this.store.Id});this.store.Rbj=a.mcc}async onCopy(a){this.N.P.track(Whx,{action:"formula_copied",...this.store.Id});if(a="="+m(__c.Gde(this.store.sE,a.Iyd)).gna)try{await __c.Zo()(a),this.ma.Ib({Db:M("rCtPEw")})}catch(b){this.ma.Ib({Db:M("CmwMXg")})}else this.ma.Ib({Db:M("CmwMXg")})}Nh(){this.N.oYc(this.store.Id)}async PXe(){this.N.P.track(Whx,
{action:"generate_magic_insights_clicked",...this.store.Id});await this.cua.H8k?.()}aTo(a){this.store.result=Xhx(this.Wd,a)}constructor(a,b,c,d,e){this.store=a;this.Wd=b;this.ma=c;this.cua=d;this.N=e;gix.G(this)}};var eix=class{constructor(a,b,c,d,e,f){var g=jmx;this.Mma=a;this.fd=b;this.upa=c;this.dF=d;this.N=e;this.V=f;this.config=g}},Zhx={sum:AHb.SUM,average:AHb.AVERAGE,min:AHb.MIN,max:AHb.MAX,earliest:AHb.MIN,latest:AHb.MAX,filled:AHb.COUNTA},Yhx={[4]:"text",[8]:"text",[6]:"text",[5]:"text",[7]:"text",[3]:"text",[1]:"number",[2]:"date",[9]:void 0,[0]:void 0},jmx={IOr:100,smr:["number","date","text"],umr:{number:["sum","average","min","max","filled"],date:["earliest","latest","filled"],text:["filled"]}};var kmx={sum:M("v7ZoRQ"),average:M("7CXYnQ"),min:M("5gtPjg"),max:M("SNOd+w"),earliest:M("XHcayw"),latest:M("7Ma8IQ"),filled:M("5t/L3g")};var fix=class{static G(a){O(a,{Rbj:H0.ref,result:H0.ref,Bji:B0,mq:B0,options:B0,e8e:B0,Id:B0})}get Bji(){return this.options.length>0}get mq(){if(this.options.length!==0)return this.options.find(a=>a.mcc===this.Rbj)??this.options[0]}get options(){return this.result?this.result.pPe.map(a=>({mcc:a.type,f1j:kmx[a.type],formattedValue:a.formattedValue,Iyd:a.Iyd})):[]}get e8e(){return this.cua.H8k!=null}get Id(){const a=this.result;if(a)return{itc:this.Rbj,$in:a.category,aBi:a.aBi}}constructor(a,b){this.sE=
a;this.cua=b;this.Rbj=(fix.G(this),void 0);this.result=void 0}};var kix=D0(a=>{const b=a.selected,c=a.options,d=a.e8e,e=a.onChange,f=a.onCopy,g=a.Nh;a=a.PXe;const [h,k]=Hkx(!1),[l,n]=Hkx(void 0),p=bix();return F0(__c.kv,{open:h,trigger:cix(b),Nh:g,Mx:mfx(()=>k(!h),[h]),eda:"bottom-end",className:"QUgzZA",children:[c.map(q=>z0(lmx,{onMouseEnter:()=>n(q),onMouseLeave:()=>n(void 0),onClick:()=>{e(q);k(!1)},children:z0("div",{className:"E_4AYQ",children:F0($q,{spacing:"1.5u",height:"full",Fa:"center",children:[z0(Yq,{width:"content",children:z0("div",{ref:r=>p.Xcm(q.mcc,
r),children:z0(Q,{weight:"bold",children:q.f1j})})}),z0(Yq,{width:"content",children:z0("div",{className:"d6FedQ",children:F0($q,{spacing:"0.5u",align:"spaceBetween",height:"full",Fa:"center",children:[z0(Yq,{width:"fluid",children:z0(__c.fr,{lineClamp:1,measure:"onRender",children:q.formattedValue})}),z0(Yq,{width:"content",children:F0(br,{spacing:"0.5u",Fa:"center",children:[q.mcc===l?.mcc?z0(Wi,{variant:"tertiary",size:"xsmall",icon:__c.tD,onClick:r=>{r.stopPropagation();f(q)}}):null,q.mcc===b.mcc?
z0(__c.sr,{}):null]})})]})})})]})})},q.mcc)),d&&F0(I0,{children:[z0(__c.Tt,{}),z0(__c.lv,{label:M("L3o8Mw"),start:z0(__c.Sig,{}),onClick:a})]})]})}),lmx=Ekx(function(a,b){const c=__c.$_b();return z0(St,{...a,tabIndex:-1,Wi:(0,Nkx["default"])(c,b),children:a.children})});var lix=D0(a=>{const b=a.options,c=a.onCopy,d=a.PXe,e=a.e8e,f=a.Nh,g=bix();yfx(()=>f(),[f]);return z0(R,{height:"unset",paddingBottom:"1u",className:"_6ktOaQ",children:F0(__c.Qo,{role:"menu",children:[b.map(h=>z0(St,{onClick:()=>c(h),children:F0($q,{spacing:"2u",height:"full",Fa:"center",children:[z0(Yq,{width:"content",children:z0("div",{ref:k=>g.Xcm(h.mcc,k),children:z0(Q,{weight:"bold",children:h.f1j})})}),z0(Yq,{width:"fluid",children:F0($q,{spacing:"0.5u",align:"spaceBetween",height:"full",Fa:"center",
children:[z0(Yq,{width:"fluid",children:z0(__c.fr,{lineClamp:1,measure:"onRender",children:h.formattedValue})}),z0(Yq,{width:"content",children:z0(br,{spacing:"0.5u",Fa:"center",children:z0(__c.tD,{size:"small"})})})]})})]})},h.mcc)),e&&F0(I0,{children:[z0(__c.Tt,{}),z0(St,{label:M("L3o8Mw"),start:z0(__c.Sig,{}),onClick:d})]})]})})});var mmx=class{static G(a){O(a,{cGh:H0.ref,Hkj:H0.ref,Sdg:H0.ref})}constructor(){this.cGh=(mmx.G(this),void 0)}};var nix=class extends Tex{render(){const a=this.props.anp,b=this.props.Sdg,c=this.props.SEi,d=this.props.children,e=this.props.ko,f={Oc_1eQ:!e,uUmvUg:e};return z0(__c.Sc,{Qm:"light",light:"light",SK:"light",dark:"light",children:g=>F0("div",{className:G0("NlRx5g",g.className),children:[z0("div",{className:"PrREkg",children:z0(Qhx,{tone:"primary"})}),F0("div",{className:"cPBR4Q",children:[z0("div",{className:"flQAQQ",onClick:c,children:z0("div",{className:"_04cBtg",children:d})}),a&&z0("div",{className:G0("dXePow",
f),children:z0(a,{})})]}),b&&z0("div",{className:G0("pdTx1g",f),children:z0(b,{})}),z0("div",{ref:this.XB.Gq,className:"LZf2jQ"})]})})}constructor(...a){super(...a);this.XB=new dd([new __c.ed({yt:()=>this.props.K7g?.(),IF:b=>this.props.J7g?.(b),tx:()=>this.props.I7g?.()})])}};var mix=class{static G(a){O(a,{J2f:H0.ref,nJj:B0,Bxo:B0,wul:B0,i5e:B0,FNd:B0,qOn:A0,lUn:A0})}get nJj(){return this.la.layout!==2&&this.viewport.ya!=null&&hf(this.viewport.ya)&&this.Pa.mode>=20}get Bxo(){return this.nJj&&this.J2f}get wul(){const a=this.QA.getSelection();if(a?.container.type==="fixed-page")return a?.container}get i5e(){const a=this.QA.getSelection();if(a?.container.type==="fixed-page")return a?.inner?.anchor}get FNd(){const a=this.ZU.store.draft;return a?.type===0&&a.Sc.isEmpty}constructor(a,
b,c,d,e,f,g){this.Pa=a;this.viewport=b;this.la=c;this.QA=d;this.ZU=e;this.Gia=f;this.Dfa=g;this.J2f=(mix.G(this),this.Dfa?.initialSettings?.qzo??!0);this.qOn=h=>{this.i5e&&this.wul&&(this.ZU.gvb(this.i5e,h,"FORMULA_BAR",0),this.Gia.h3b(this.wul,{type:"cell",tb:this.i5e},{animate:!0}))};this.lUn=()=>{this.J2f=!this.J2f}}};var oix=({tF:a,onClick:b,oa:c,CB:d})=>{const e=mfx(()=>{b?.();c?.()},[b,c]);return z0(a,{onClick:e,CB:d,children:M("QESDag")})};var qix=class{constructor(a,b){this.QA=a;this.hj=b;this.aXs=()=>{const c=this.QA.Uu();return!!c&&!!c.inner&&c.inner.cells.size>0};this.Lnc=()=>{const c=this.QA.Uu();if(c)if(c.inner){var d=c.inner.cells.map(e=>e);this.hj.Lnc(c.sheet,d)}else{const e=c.sheet.layout.cols;d=c.sheet.layout.rows.flatMap(f=>e.map(g=>({row:f,column:g})));this.hj.Lnc(c.sheet,d)}}}};var six=class{constructor(a){this.qBl=a;this.Zcp=20;this.Cnn=(b,c,d)=>{const e=this.qBl.filters.get(b)?.range;return e&&b.layout.cols.has(d)&&b.layout.rows.has(c)&&b.layout.rows.has(e.$b)&&b.layout.cols.has(e.ec)&&b.layout.cols.has(e.jf)?e.$b===c&&b.layout.cols.dj(d,e.ec)>=0&&b.layout.cols.dj(d,e.jf)<=0:!1};this.EAb=(b,c,d)=>this.Cnn(b,c,d)?{paddingInlineEnd:this.Zcp,overflow:"hidden"}:void 0;this.uAb=(b,c,d)=>this.Cnn(b,c,d)?{fontWeight:"bold"}:void 0}};var xix=D0(a=>a.cells.map((b,c)=>z0(nmx,{sheet:a.sheet,tb:b,scale:a.scale},c))),nmx=D0(a=>{var b=a.sheet;const c=a.tb;a=a.scale;const d=__c.Uj(Ak(b,c.column,c.row),-uu).scale(a).Nb();b=b.layout.attrs.get(Ee.ht,c.row,c.column)||{};b=he(Ee,b);return z0("div",{className:"Hkdm3Q",style:{top:d.top,left:d.left,width:d.width,height:d.height,backgroundColor:b.n1},children:z0("div",{className:"L6sT8w",style:{width:1/a*d.width,transform:`scale(${a})`},children:z0(__c.Zy,{index:1,shape:"textRectangle"})})})});var wix=class{OQi(a){const b=this.store;b.Jbd=[...b.Jbd,a];return()=>{b.Jbd=b.Jbd.filter(c=>c!==a)}}constructor(a){this.store=a}};var vix=class{static G(a){O(a,{Jbd:H0.ref,sBl:B0})}get sBl(){const a=[];for(const d of this.Jbd)switch(d.sheet.type){case "fixed-page":var b=d.sheet,c=new __c.Xz(b,this.viewport,this.Pa);a.push({...d,FE:c,g_i:b.ia.sheet,page:uix(d.sheet)});break;case "sheet-element":b=d.sheet;c=new __c.Wz(b,this.viewport);a.push({...d,FE:c,g_i:b.ia.config,page:uix(d.sheet)});break;case "sheet-item":b=d.sheet;c=new __c.Zz(b,this.pd,this.viewport);a.push({...d,FE:c,g_i:b.ia.config,page:uix(d.sheet)});break;default:throw new u(d.sheet);
}return a}constructor(a,b,c){this.viewport=a;this.Pa=b;this.pd=c;this.Jbd=(vix.G(this),[])}};var omx=class{scrollTo(a,b,c){switch(a.type){case "sheet-item":this.DVs.scrollTo(a.sheet,b);break;case "fixed-page":case "sheet-element":c=new pj(b,c);a=this.viewport;b=a.ya;var d=this.viewport.ey(),e=this.viewport.Qq,f=a.hm(a.Vg);const g=f.invert();f=d.transform(f);e=g.then(__c.Ej(e.x,e.y)).transformPoint(__c.qj({x:0,y:0}));d=Fj(1/this.viewport.zoom.scale).transformPoint(sj(e,d.tl));c=f.transform(__c.Ej(c.x-d.x-f.Ub.x,c.y-d.y-f.t.y));a.HC(b,a.zoom.scale,{center:c.center(),...(void 0)});break;default:throw new u(a);
}}constructor(a,b,c){this.viewport=a;this.Ly=b;this.DVs=c;this.h3b=(d,e)=>{e=e.type==="cell"?Ak(this.Ly.sheet,e.tb.column,e.tb.row):e.box;const {o9:f,cwo:g,bwo:h}=Bix(this,e);if(g!=null){e=e.transform(h);var {deltaX:k,deltaY:l}=zix(g,e);(k||l)&&this.scrollTo(d,f.x+k*(this.Ly.sheet.direction==="rtl"?-1:1),f.y+l)}}}};var pmx=Symbol("SheetSelection.SuggestionModeDraft"),Nix=class{static G(a){O(a,{O2c:H0.ref,jJb:H0.ref})}Uu(a){if(!(this.Pa.mode<40))return this.config.Rma(a)}getSelection(){return this.config.getSelection()}gvb(a,b,c,d){this.config.gvb(a,b,c);d?.addEvent("draft started");d?.qe()}JF(a){this.Gg?.iS();a?.target?.closest(".FedJ0Q")||a?.preventDefault()}BS(a,b,c,d){b=nZa(b,c,d);this.IAa(a,b,c,d,[],[])}constructor(a,b,c,d,e,f,g,h,k,l,n,p){this.config=a;this.o_i=b;this.Pa=c;this.Ih=d;this.Gg=e;this.jNd=
f;this.pma=g;this.vJ=h;this.Wk=k;this.ma=l;this.V=n;this.P=p;this.O2c=(Nix.G(this),void 0);this.IAa=(q,r,t,v,w,x)=>{const y=this.config.getSelection()?.inner;if(r.length>0&&w.length===0&&x.length===0&&y&&y.cells.size>0&&y.rows.size===0&&y.columns.size===0&&y.anchor?.row===t.row&&y.anchor?.column===t.column&&y.addCell&&y.Ufh){q=new iB;t=new iB;v=new iB;for(const C of r)q.add([C.row,C.column]),y.oc(C)||t.add([C.row,C.column]);for(const C of y.cells)q.has([C.row,C.column])||v.add([C.row,C.column]);const z=
y.addCell,B=y.Ufh;t.forEach(([C,G])=>z({row:C,column:G}));v.forEach(([C,G])=>B({row:C,column:G}))}else this.config.PMd(q,r,t,v,w,x);this.JF()};this.y6a=(q,r,t)=>{if(this.config.ATh(q,t)&&(this.vJ?.y6a(this.config.b2a,q,r,t),!this.vJ?.active)){var v=this.V?.wb("sheet_cell_selected",{Hb:{name:"editor.element.select"}});v?.ob().wk(({Oi:G})=>{this.P?.track(__c.HMa,{yB:"click",Tb:G()})});var w=this.config.b2a(new pj(t.Li,t.zj),q),x=Dfe(w,r);if(x){var y=this.jNd.contextMenu(t),z=this.jNd.Sze(t),B=this.jNd.zDe(t),
C=this.config.getSelection();if(z&&C&&C.inner?.anchor)this.BS(q,r,C.inner.anchor,x),this.JF(t),v?.addEvent("continuous selection"),v?.qe();else if(B)!C||!C.inner||C.inner.columns.size>0||C.inner.rows.size>0?(this.IAa(q,[x],x,x,[],[]),this.JF(t)):C.inner.cells?.size===1&&C.inner.oc(x)||(C.inner.oc(x)?C.inner.Ufh?.(x):C.inner.addCell?.(x),this.JF(t)),v?.addEvent("disjoint selection"),v?.qe();else if((C?.inner?.cells?C.inner.cells.map(G=>G):[]).find(G=>Cix(r,G,x))&&y)v?.addEvent("selection right click"),
v?.qe();else{z=r.layout.cells.get(x.row,x.column);if(z?.ref.content.ref?.type==="media"){B=z.ref.content.ref.value;z=__c.AXd(B,x,r);for(const G of B)if((B=z.get(G))&&B.GH(w)){this.config.Mno(q,x,{type:"media",media:[G]});this.JF(t);v?.addEvent("inner cell selection");v?.qe();return}}!y&&C&&C.inner?.cells?.size===1&&C.inner.anchor&&Cix(r,C.inner.anchor,x)&&!t?.target?.closest(".FedJ0Q")&&!t?.target?.closest(".l_S_Ng")?this.Pa.mode===30?this.ma?.Ib({Db:M("7BWJig"),group:pmx,fO:!0}):this.Pa.mode<40||
(this.gvb(q,x,r,v),t.preventDefault()):(w=this.config.Q2m()&&__c.$b(),this.IAa(q,[x],x,x,[],[]),this.JF(t),v?.addEvent("standard selection"),v?.qe(),w&&(this.gvb(q,x,r,v),t.preventDefault()))}}else v?.addEvent("invalid selection"),v?.qe()}};this.pXe=(q,r,t)=>{if(this.vJ?.active)this.vJ.pXe(q,r,t,this.config.b2a);else{var v=this.config.b2a(new pj(t.Li,t.zj),q),w=Cfe(v,r);if(w){var x=this.jNd.contextMenu(t),y=this.jNd.Sze(t),z=this.jNd.zDe(t);v=this.config.getSelection();if(y&&v&&v.inner?.anchor){v=
v.inner.anchor;const [B,C]=r.cols.dj(w,v.column)<0?[w,v.column]:[v.column,w];x=Array.from(Dix(B,C,r.cols));this.IAa(q,[],v,v,[],x);this.JF(t)}else if(z)if(v&&v.inner&&v.inner.columns.size!==0){if(x=v.inner.columns.map(B=>B),x.length!==1||x[0]!==w)y={column:w,row:m(r.rows.first())},v.inner.oc(y)?x=x.filter(B=>B!==w):x.push(w),x.sort((B,C)=>r.cols.dj(B,C)),v=v.inner.anchor||{column:x[0],row:m(r.rows.first())},this.IAa(q,[],v,v,[],x),this.JF(t)}else v={column:w,row:m(r.rows.first())},this.IAa(q,[],v,
v,[],[w]),this.JF(t);else v=(v?.inner?.columns?v.inner.columns.map(B=>B):[]).find(B=>B===w),x&&v||(v={row:m(r.rows.first()),column:w},this.IAa(q,[],v,v,[],[w]),this.JF(t))}}};this.D0k=(q,r,t)=>{this.pXe(q,r,{...t,preventDefault:()=>{}});q=this.config.b2a(new pj(t.Li,t.zj),q);this.pma?.VOb(q,"sheet","long_press");this.Wk?.tO&&this.Wk.tO(new __c.ap)};this.AYe=(q,r,t)=>{if(this.vJ?.active)this.vJ.AYe(q,r,t,this.config.b2a);else{var v=this.config.b2a(new pj(t.Li,t.zj),q),w=Bfe(v,r);if(w){var x=this.jNd.contextMenu(t),
y=this.jNd.Sze(t),z=this.jNd.zDe(t);v=this.config.getSelection();if(y&&v&&v.inner?.anchor){v=v.inner.anchor;const [B,C]=r.rows.dj(w,v.row)<0?[w,v.row]:[v.row,w];x=Array.from(Dix(B,C,r.rows));this.IAa(q,[],v,v,x,[]);this.JF(t)}else if(z)if(v&&v.inner&&v.inner.rows.size!==0){if(x=v.inner.rows.map(B=>B),x.length!==1||x[0]!==w)y={column:m(r.cols.first()),row:w},v.inner.oc(y)?x=x.filter(B=>B!==w):x.push(w),x.sort((B,C)=>r.rows.dj(B,C)),v=v.inner.anchor||{column:m(r.cols.first()),row:x[0]},this.IAa(q,[],
v,v,x,[]),this.JF(t)}else v={column:m(r.cols.first()),row:w},this.IAa(q,[],v,v,[w],[]),this.JF(t);else v=(v?.inner?.rows?v.inner.rows.map(B=>B):[]).find(B=>B===w),x&&v||(v={row:w,column:m(r.cols.first())},this.IAa(q,[],v,v,[w],[]),this.JF(t))}}};this.B5k=(q,r,t)=>{this.AYe(q,r,{...t,preventDefault:()=>{}});q=this.config.b2a(new pj(t.Li,t.zj),q);this.pma?.VOb(q,"sheet","long_press");this.Wk?.tO&&this.Wk.tO(new __c.ap)};this.GCi=(q,r,t)=>{this.config.ATh(q)&&(this.vJ?.active?this.vJ.J5r(this.config.b2a,
q,r,t):this.Ih?.SL(v=>{var w=this.config.b2a(t,q);(w=Dfe(w,r))&&this.IAa(q,[w],w,w,[],[]);this.O2c={stop:v,Uy:t,mub:setInterval(A0(()=>this.FQr(q)),500)}}))};this.N4g=(q,r,t)=>{if(this.config.ATh(q))if(this.vJ?.active)this.vJ.I5r(this.config.b2a,q,r,t);else{var v=this.config.b2a(t,q);v=Dfe(v,r);var w=this.config.getSelection()?.inner?.anchor;w&&v&&this.BS(q,r,w,v);this.O2c&&(this.O2c.Uy=t)}};this.FCi=()=>{this.vJ?.active?this.vJ.H5r():(this.O2c?.stop(),clearInterval(this.O2c?.mub),this.O2c=void 0)};
this.SOf=(q,r,t,v)=>{this.Ih?.SL(w=>{var x=this.config.b2a(t,q);switch(v){case "row":x=Bfe(x,r);if(x==null)return;var y={row:x,column:m(r.cols.first())};this.IAa(q,[],y,y,[x],[]);x={type:"row",qlr:x};break;case "column":x=Cfe(x,r);if(x==null)return;y={row:m(r.rows.first()),column:x};this.IAa(q,[],y,y,[],[x]);x={type:"column",Lkr:x};break;default:throw new u(v);}y=setInterval(A0(()=>this.EQr(q)),500);this.jJb={stop:w,Uy:t,mub:y,...x}})};this.ZWe=(q,r,t,v)=>{if(this.jJb&&this.jJb.type===v){var w=this.config.b2a(t,
q);this.jJb.Uy=t;switch(v){case "row":ra(this.jJb.type==="row");w=Bfe(w,r);if(w==null)break;t=this.jJb.qlr;v=r.rows.dj(t,w)<0?t:w;w=r.rows.dj(t,w)<0?w:t;v=xk(v,w,r.rows);r={row:t,column:m(r.cols.first())};this.IAa(q,[],r,r,[...v],[]);break;case "column":ra(this.jJb.type==="column");w=Cfe(w,r);if(w==null)break;t=this.jJb.Lkr;v=r.cols.dj(t,w)<0?t:w;w=r.cols.dj(t,w)<0?w:t;v=xk(v,w,r.cols);r={row:m(r.rows.first()),column:t};this.IAa(q,[],r,r,[],[...v]);break;default:throw new u(v);}}};this.ROf=()=>{this.jJb?.stop();
clearInterval(this.jJb?.mub);this.jJb=void 0};this.FQr=q=>{const r=this.config.getSelection(),t=this.o_i.Gia;if(t&&this.O2c&&r){var v=this.config.b2a(this.O2c.Uy,q);Aix(t,{sheet:r.sheet,point:v});this.N4g(q,r.sheet,this.O2c.Uy)}};this.EQr=q=>{const r=this.config.getSelection(),t=this.o_i.Gia;if(t&&this.jJb&&r){var v=this.config.b2a(this.jJb.Uy,q);Aix(t,{sheet:r.sheet,point:v});this.ZWe(q,r.sheet,this.jJb.Uy,this.jJb.type)}};this.M_k=(q,r,t)=>{this.Ih?.SL(v=>{const w=new pj(t.Li,t.zj);var x=this.config.b2a(w,
q);if(x=Dfe(x,r)){var y=this.Uu();y?.inner?.cells?.size&&y.inner.oc(x)||this.IAa(q,[x],x,x,[],[]);this.pma?.VOb(w,"sheet","long_press");this.Wk?.tO&&this.Wk.tO(new __c.ap)}v()})};this.btb=(q,r,t)=>{if(this.vJ?.active)this.vJ.btb(r);else{var v={row:m(r.rows.first()),column:m(r.cols.first())};this.IAa(q,[],v,v,r.rows.toArray(),r.cols.toArray());this.JF(t)}}}},Mix=class{getSelection(){var a=this.vg.Ma;const b=this.vg.Kb;if(a?.type==="elements"){var c=a.inner,d=a.Fp,e=a.container;if(c&&c.type==="sheet")return{page:d,
container:e.Me(c.sheet),sheet:c.sheet.config,inner:new qmx(c)};if((c=a.Pd)&&c.type==="sheet")return{page:d,container:e.Me(c),sheet:c.config}}if(b?.type===4)return{page:b.container.container.type==="responsive-page"?b.container.container.page:void 0,container:b.container.container.ew(b.container.sheet),sheet:b.container.sheet.config,inner:new rmx(b,this.vg,(f,g,h)=>this.PMd(b.container.container.ew(b.container.sheet),f,g,h,[],[]))};if(b?.type===1&&b.only&&b.only.type==="sheet")return sa(TVc(b.container)),
{page:b.container.type==="responsive-page"?b.container.page:void 0,container:b.container.ew(b.only),sheet:b.only.config};if(b?.type===0&&b.container.type==="sheet-item-cell-richtext"){e={column:b.container.container.column,row:b.container.container.row};a=b.container.container.sheet;d=b.container.container.Kqa;e=this.Mub.Foh(b.container.container.container,e,e,[e],[],[]);c=b.container.container.container.container;const f=c.ew(d);return{page:c.type==="responsive-page"?c.page:void 0,container:f,sheet:a,
inner:new rmx(e,this.vg,(g,h,k)=>this.PMd(f,g,h,k,[],[]))}}if(a?.type==="pages"){if((d=a.inner)&&d.type==="sheet")return{page:d.page,container:a.container.xb(d.page),sheet:d.page.sheet,inner:new smx(d)};switch(a.Pd?.type){case "fixed":if(hf(a.Pd))return{page:a.Pd,container:a.container.xb(a.Pd),sheet:a.Pd.sheet};break;case "concatenated-fixed":case "responsive":case void 0:break;default:throw new u(a.Pd);}}}Rma(a){const b=this.vg.Ma;if(!b||b.Ri(a))return this.getSelection()}ATh(a,b){const c=this.vg.Ma;
return c?.type==="elements"&&!c.inner&&a.type==="sheet-element"&&(b?.shiftKey||this.vg.oc(a)&&!c.Pd)?!1:!0}PMd(a,b,c,d,e,f){switch(a.type){case "sheet-element":this.vg.L7a(a,c,d,b,e,f);break;case "sheet-item":__c.xv(this.vg,a,c,d,b,e,f);break;case "fixed-page":b=this.vg.u1a(a,c,d,b,e,f);sa(b.type==="pages"&&b.inner?.type==="sheet");this.c1n.set(a.page,b.inner);break;default:throw new u(a);}}Mno(a,b,c){switch(a.type){case "sheet-element":var d=a.ia.config.layout.cells.get(b.row,b.column);switch(c.type){case "media":if(!d)return;
this.vg.Jtl(a.XZ(b.column,b.row),d.ref,c.media);break;default:throw new u(c.type);}break;case "sheet-item":const e=a.ia.config.layout.cells.get(b.row,b.column);switch(c.type){case "media":if(!e)return;d=this.vg;a=a.XZ(b.column,b.row);d.Mub&&__c.g2a(d,d.Mub.Xvo(a,e.ref,c.media));break;default:throw new u(c.type);}break;case "fixed-page":d=a.page.sheet.layout.cells.get(b.row,b.column);switch(c.type){case "media":if(!d)return;this.vg.Ctl(a.XZ(b.column,b.row),d.ref,c.media);break;default:throw new u(c.type);
}break;default:throw new u(a);}}Q2m(){return this.fwo.ZU?.OIg()}gvb(a,b,c){const d=this.fwo.ZU;d?.OIg()&&d?.uOa();d?.gvb(b,c,"CELL_OVERLAY",a.type==="sheet-item"?1:0)}constructor(a,b,c,d,e,f){this.Pa=a;this.viewport=b;this.pd=c;this.vg=d;this.fwo=e;this.Mub=f;this.c1n=new WeakMap;this.b2a=(g,h)=>{let k;switch(h.type){case "sheet-element":k=new __c.Wz(h,this.viewport);break;case "sheet-item":k=new __c.Zz(h,this.pd,this.viewport);break;case "fixed-page":k=new __c.Xz(h,this.viewport,this.Pa);break;default:throw new u(h);
}h=this.T8q(h);const l=k.vB,n=k.gM;return Gv(h,k.$R,l,h.direction==="rtl"?sj(l.tr,n.tr):sj(l.tl,n.tl),g)};this.T8q=g=>{switch(g.type){case "sheet-element":case "sheet-item":return g.ia.config;case "fixed-page":return g.ia.sheet;default:throw new u(g);}}}},tmx=class{get anchor(){return this.x9a.anchor}get Iu(){return this.x9a.Iu}get cells(){return this.x9a.cells}get rows(){return this.x9a.rows}get columns(){return this.x9a.columns}constructor(a){this.x9a=a}},qmx=class extends tmx{constructor(a){super(a);
this.inner=a;this.oc=b=>this.inner.oc(this.inner.sheet,b);this.addCell=b=>this.inner.fae(this.inner.sheet,b);this.Ufh=b=>this.inner.lae(this.inner.sheet,b)}},smx=class extends tmx{constructor(a){super(a);this.inner=a;this.oc=b=>this.inner.oc(this.inner.page,b);this.addCell=b=>this.inner.fae(this.inner.page,b);this.Ufh=b=>this.inner.lae(this.inner.page,b)}},rmx=class extends tmx{constructor(a,b,c){super(a);this.inner=a;this.vg=b;this.PMd=c;this.oc=d=>this.inner.has(d);this.addCell=d=>{const e=[...this.inner.cells.map(f=>
f),d];this.PMd(e,this.inner.anchor||e[0],d);d=this.vg.Kb;sa(d?.type===4);this.x9a=this.inner=d};this.Ufh=d=>{var e=this.inner.cells.map(h=>h).filter(h=>h.column!==d.column||h.row!==d.row);const f=this.inner.anchor,g=this.inner.Iu;this.PMd(e,f&&f.column!==d.column&&f.row!==d.row?f:e[0],g&&g.column!==d.column&&g.row!==d.row?g:e[e.length-1]);e=this.vg.Kb;sa(e?.type===4);this.x9a=this.inner=e}}},Jix=class{static CHg(a){const b=/Mac/.test(a.platform);return new Jix(c=>c.shiftKey,c=>b?c.metaKey:c.ctrlKey,
c=>(b?c.ctrlKey:c.metaKey)||c.button===2)}constructor(a,b,c){this.Sze=a;this.zDe=b;this.contextMenu=c}};var Kix=class{static G(a){O(a,{ZU:H0.ref,Gia:H0.ref})}constructor(){this.ZU=(Kix.G(this),void 0)}};var umx=class{static G(a){O(a,{box:B0,Pd:B0,only:B0,isEmpty:B0})}oc(a,b){return this.parent===a&&this.apd.has(b)?this.tb.content.ref?.type==="media"&&this.tb.content.ref.value.some(c=>c===b):!1}fae(a,b){if(this.parent!==a||this.oc(a,b))return!1;this.apd.add(b);return!0}lae(a,b){if(this.parent!==a||!this.oc(a,b))return!1;this.apd.delete(b);return!0}get box(){if(this.media.size&&this.tb.content.ref?.type==="media"){var a=__c.AXd(this.tb.content.ref.value,this.location,this.Qla),b=this.media.map(c=>
a.get(c)).filter(__c.sb);if(b.length>0)return __c.Sj(0,b)}}get Pd(){return this.media.size===1?this.media.map(a=>a)[0]:void 0}get only(){return this.Pd}get isEmpty(){return this.media.size===0}forEach(a){this.media.forEach(a)}has(a){return this.oc(this.parent,a)}map(a){return this.media.map(a)}constructor(a,b,c,d,e){this.parent=a;this.Qla=b;this.tb=c;this.location=d;this.apd=(umx.G(this),void 0);this.apd=H0.set(e,{deep:!1});this.media=new ulx(B0(()=>c.content.ref?.type==="media"?c.content.ref.value.filter(f=>
this.apd.has(f)):[]))}},vmx=class extends umx{static G(a){O(a,{$za:B0})}get $za(){return this.box}constructor(a,b,c){super(b,a.sheet,b,{row:a.row,column:a.column},c);this.type=(vmx.G(this),"sheet-cell-media");this.page=a.container.page;this.container=a}},wmx=class extends umx{static G(a){O(a,{$za:B0})}get Hg(){return this.sheet}get $za(){const a=__c.Tj(__c.Oj(this.sheet));return this.box?.transform(a)}constructor(a,b,c){super(b,a.sheet,b,{row:a.row,column:a.column},c);this.type=(wmx.G(this),"sheet-cell-media");
this.sheet=a.container.sheet;this.container=a}},xmx=class extends umx{static G(a){O(a,{Rz:B0})}get Rz(){return __c.a2a(this.container)}constructor(a,b,c,d){super(c,b.sheet,c,{row:b.row,column:b.column},d);this.document=a;this.container=b;this.type=(xmx.G(this),5)}};var ymx=class{static G(a){O(a,{box:B0,isEmpty:B0,cOk:B0,zrh:B0({equals:__c.ek(Yfx.shallow)}),Pd:B0,anchor:B0({equals:Yfx.shallow}),Iu:B0({equals:Yfx.shallow})})}Whb(a){var b=this.Qla.layout.cells.get(a.row,a.column)?.span||{ec:a.column,$b:a.row,jf:a.column,df:a.row},c=b.ec;a=b.jf;var d=b.df;b=this.Qla.ld(b.$b);d=this.Qla.ld(d)+d.height;c=this.Qla.yd(c);a=this.Qla.yd(a)+a.width;return Lj(c,b,a,d)}get box(){var a=this.Pd;if(a)return this.Whb(a);if(this.zrh.length&&(a=this.zrh.map(b=>this.Whb(b)).filter(__c.sb),
a.length>0))return __c.Sj(this.yCb,a)}get yCb(){return 0}get isEmpty(){return!this.cells.size&&!this.rows.size&&!this.columns.size}get cOk(){return new Set([...this.rra].map(a=>Fix(a)))}get selection(){if(!this.rra.size&&!this.rows.size&&!this.columns.size)return[];if(this.rra.size===1&&!this.rows.size&&!this.columns.size){var a=this.rra.values().next().value;if(!a||!Iix(a,this.Qla))return[];var b=this.Qla.layout.cells.get(a.row,a.column);return b?[{column:b.span.ec,row:b.span.$b}]:[a]}a=new iB;for(b of this.Qla.rows)for(const d of this.Qla.cols)if(this.cOk.has(Fix({column:d,
row:b}))){var c=this.Qla.layout.cells.get(b,d)?.span||{$b:b,ec:d};a.add([c.$b,c.ec])}else if(this.Buj.has(d)||this.qUd.has(b))c=this.Qla.layout.cells.get(b,d)?.span||{$b:b,ec:d},c.$b===b&&c.ec===d&&a.add([c.$b,c.ec]);return a.map(([d,e])=>({column:e,row:d}))}get zrh(){if(!this.rows&&!this.columns)return this.selection;const a=new iB;this.rows.forEach(b=>this.Qla.layout.cols.map(c=>{a.add([b,c])}));this.columns.forEach(b=>this.Qla.layout.rows.map(c=>{a.add([c,b])}));this.cells.forEach(({row:b,column:c})=>
a.add([b,c]));return a.map(([b,c])=>({row:b,column:c})).sort((b,c)=>this.Qla.layout.rows.dj(b.row,c.row)||this.Qla.layout.cols.dj(b.column,c.column))}get Pd(){const a=this.selection;return a.length===1?a[0]:void 0}oc(a,b){if(this.parent!==a||!Iix(b,this.Qla))return!1;a=this.Qla.layout.cells.get(b.row,b.column)?.span||{ec:b.column,$b:b.row,jf:b.column,df:b.row};if(this.qUd.has(a.$b)||this.Buj.has(a.ec))return!0;for(const c of xk(a.$b,a.df,this.Qla.layout.rows))for(const d of xk(a.ec,a.jf,this.Qla.layout.cols))if(this.cOk.has(Fix({column:d,
row:c})))return!0;return!1}fae(a,b){if(this.parent!==a||this.oc(a,b))return!1;this.rra.add(b);this.p0c=b;Hix(this);return!0}lae(a,b){if(this.parent!==a)return!1;var c=this.Qla.layout.cells.get(b.row,b.column)?.span||{ec:b.column,$b:b.row,jf:b.column,df:b.row};const d=new Set(xk(c.$b,c.df,this.Qla.layout.rows));c=new Set(xk(c.ec,c.jf,this.Qla.layout.cols));let e=!1;for(const f of this.rra)if(f.column===b.column&&f.row===b.row||c.has(f.column)&&d.has(f.row))this.rra.delete(f),e=!0;if(e&&!this.Iu)for(const f of[...this.rra].reverse())if(this.oc(a,
f)){this.p0c=f;break}Hix(this);return e}onSelect(){Hix(this)}KCb(){Gix(this)}get anchor(){var a=this.Whf.row;const b=this.Whf.column,{$b:c,ec:d}=this.Qla.layout.cells.get(a,b)?.span||{ec:b,$b:a};a={row:c,column:d};if(this.oc(this.parent,a))return a;if(this.zrh.length)return this.zrh[0]}get Iu(){const a=this.p0c.row,b=this.p0c.column,{$b:c,ec:d}=this.Qla.layout.cells.get(a,b)?.span||{ec:b,$b:a};if(this.oc(this.parent,{row:c,column:d}))return this.p0c}constructor(a,b,c,d,e,f,g,h,k,l){this.parent=a;
this.Qla=b;this.Whf=c;this.p0c=d;this.MNd=h;this.undo=k;this.xyc=l;this.qUd=(ymx.G(this),void 0);this.qUd=H0.set(f,{deep:!1});this.rows=new ulx(B0(()=>this.Qla.rows.filter(n=>this.qUd.has(n))));this.Buj=H0.set(g,{deep:!1});this.columns=new ulx(B0(()=>this.Qla.cols.filter(n=>this.Buj.has(n))));this.rra=H0.set(e,{deep:!1});this.cells=new ulx(B0(()=>this.selection))}},zmx=class extends ymx{static G(a){O(a,{$za:B0})}get $za(){return this.box}constructor(a,b,c,d,e,f,g,h,k,l){super(b,b.sheet,c,d,e,f,g,
h,k,l);this.container=a;this.page=b;this.type=(zmx.G(this),"sheet")}},Amx=class extends ymx{static G(a){O(a,{$za:B0})}get Hg(){return this.sheet}get sheet(){return this.container.sheet}get $za(){const a=__c.Tj(__c.Oj(this.sheet));return this.box?.transform(a)}constructor(a,b,c,d,e,f,g,h,k){super(a.ia,a.ia.config,b,c,d,e,f,g,h,k);this.container=a;this.type=(Amx.G(this),"sheet")}},Bmx=class extends ymx{static G(a){O(a,{Rz:B0})}get Rz(){return __c.a2a(this.container)}get only(){return this.Pd}forEach(a){this.selection.forEach(a)}has(a){return this.oc(this.container.sheet,
a)}map(a){return this.selection.map(a)}constructor(a,b,c,d,e,f,g,h,k){super(a.sheet,a.sheet.config,b,c,d,e,f,g,h,k);this.container=a;this.type=(Bmx.G(this),4)}};var Oix=class{Rns(a,b,c,d,e,f){const g=this.session.undo,h=this.session.mk,k=a.container;a=a.page;sa(this.Ai.type==="fixed-document");return new zmx(k?k.xb(a):this.Ai.xb(a),a,b,c,d,e,f,this.Pa.mode,g,h)}Qns(a,b,c){return new vmx(a.container.XZ(a.column,a.row),b,c)}yVs(a,b,c,d,e,f){const g=this.session.undo,h=this.session.mk;return new Amx(a.container.Me(a.sheet),b,c,d,e,f,this.Pa.mode,g,h)}wVs(a,b,c){return new wmx(a.container.XZ(a.column,a.row),b,c)}constructor(a,b,c){this.Pa=a;this.session=b;this.Ai=
c}},Lix=class{Foh(a,b,c,d,e,f){return new Bmx(a,b,c,d,e,f,this.Pa.mode,this.session.undo,this.session.mk)}Xvo(a,b,c){return new xmx(this.session.document,a,b,c)}constructor(a,b){this.Pa=a;this.session=b}};var Uix=D0(({scale:a,uob:b,wz:c,children:d})=>{const e=c.gM.scale(a);a=c.vB.scale(a);const f=b?__c.Rj(__c.Nj(a.transform(a.Fn())),__c.Nj(e.transform(a.Fn())))?.transform(__c.Tj(a)).Nb():a.Nb();if(f!=null)return z0(__c.Sc,{SK:"light",dark:"light",Qm:"light",children:g=>z0("div",{style:{width:f.width,height:f.height,transform:`translate(${f.left}px, ${f.top}px) rotate(${f.rotation}deg`},className:G0("FpbtRg",g.className),children:d})})});var Tix=class{N9c(){const a=this.store;a.position=void 0;a.target=void 0}constructor(a,b,c,d){this.store=a;this.hj=b;this.Ly=c;this.V=d;this.x6g=(e,f,g)=>{const h=this.store;var k=this.Ly;if(e===k.sheet&&h.xYa){var l=k.vB;k=k.gM;l=e.direction==="rtl"?sj(l.tr,k.tr):sj(l.tl,k.tl);switch(f.type){case "row":var n=e.ld(f.row);k=n+f.row.height;var p=n+f.offsetY,q;p-n<24/g?q="before":k-p<24/g&&(q="after");if(q){const r=new pj(0,q==="before"?n:k);g=yk(e).find(t=>t.box.GH(r));g=zk(e,l,g).transformPoint(r);
h.position={left:0,top:g.y};h.target={type:"row",row:f.row,sheet:e,position:q}}else h.position=void 0,h.target=void 0;break;case "column":q=e.yd(f.column);k=q+f.column.width;p=q+f.offsetX;p-q<24/g?n="before":k-p<24/g&&(n="after");if(n){const r=new pj(n==="before"?q:k,0);g=yk(e).find(t=>t.box.GH(r));g=zk(e,l,g).transformPoint(r);h.position={left:g.x,top:0};h.target={type:"column",column:f.column,sheet:e,position:n}}else h.position=void 0,h.target=void 0;break;default:throw new u(f);}}};this.z6g=()=>
{this.N9c()}}};var Six=class{static G(a){O(a,{position:H0.ref,target:H0.ref,xYa:B0})}get xYa(){return this.Ly.RW&&!this.VIa.value}constructor(a,b){this.Ly=a;this.VIa=b;this.position=(Six.G(this),void 0)}};var ejx=class extends __c.mUr{constructor(a){super();this.store=a;this.y6g=[];this.KEi=[];this.onMouseMove=(b,c,d,e,f)=>{this.store.uZd={sheet:c,wz:d,oVp:e,scale:f};this.y6g.length<1||Wix(this,b)};this.onMouseLeave=b=>{const c=this.KEi;b.relatedTarget instanceof HTMLElement&&(b.relatedTarget?.classList.contains("J_StUw")||b.relatedTarget?.closest(".J_StUw")||b.relatedTarget?.classList.contains("yfwv_Q")||b.relatedTarget?.classList.contains("o_DvqA")||b.relatedTarget?.classList.contains("_93roJg")||
b.relatedTarget?.classList.contains("Vt2_4w"))||(c.forEach(d=>d(b)),this.store.uZd=void 0)};this.Hii=b=>{switch(b.type){case "mousemove":Wix(this,b);break;case "mouseleave":this.onMouseLeave(b)}};this.b4q=b=>{const c=new Set;b.z8.map(d=>{if(d.Taa&&(d=b.layout.GA.get(d.Taa)))for(const e of xk(d.start,d.end,b.layout.cols))c.add(e)});return c}}};var djx=class{static G(a){O(a,{uZd:H0.ref})}constructor(){this.uZd=(djx.G(this),void 0)}};var Yix=D0(a=>{const b=a.sheet,c=a.placement,d=a.p0;var e=a.Ly;const f=a.aTb,g=a.onTouchStart,h=a.onMouseDown,k=a.IZd;if(e.RW){e=e.gd;var l=a.Yqb.Nva({size:a.size,scale:e,Ybb:d}),n=b.direction==="rtl";l=c==="absolute"?{transform:`translate(${-l*(n?-1:1)}px, ${-l}px)`}:void 0;return z0("div",{className:G0("M_PYXw",{xeNX_A:c==="absolute"},{KwLdqA:!n,Gkf9sQ:n}),style:l,children:z0(f,{sheet:b,scale:e,p0:d,selection:a.selection,Oef:a.Oef,size:a.size,onMouseMove:a.onMouseMove,onMouseLeave:a.onMouseLeave,
o0:a.o0,onMouseDown:h,onTouchStart:g,IZd:k})})}}),Zix=D0(a=>{const b=a.sheet,c=a.Yqb,d=a.placement,e=a.scrollMode,f=a.p0;var g=a.size;const h=a.GYb,k=a.Ly,l=a.AVc,n=a.$Sb,p=mfx(()=>e==="native"?h?.(b,!0,!1):B0(()=>{var y=k.gd,z=k.vB.scale(y);const B=k.gM.scale(y);z=(y=b.direction==="rtl")?sj(z.tr,B.tr):sj(z.tl,B.tl);return y?{position:"relative",right:`${-z.x}px`}:{position:"relative",left:`${z.x}px`}}),[b,k,e,h]),q=E0(()=>B0(()=>{const y=new Map;for(const z of c.b4q(b))y.set(z,__c.ezj);return y}),
[c,b]);if(k.RW){var r=k.gd,t=b.direction==="rtl",v={KwLdqA:!t,Gkf9sQ:t};if(d==="absolute"){var w=k.vB.scale(r);var x=k.gM.scale(r);t=t?sj(w.tr,x.tr):sj(w.tl,x.tl);g=c.Nva({size:g,scale:r,Ybb:f});w=d==="absolute"?{width:`${w.width}px`,transform:`translate(0, ${-g}px)`}:void 0;x=e==="transform"?{transform:`translateX(${-t.x}px)`}:void 0}return z0("div",{className:G0("M_PYXw",{xeNX_A:d==="absolute"},v),style:w,children:z0("div",{className:"gSxDBQ",style:x,children:z0(n,{sheet:b,scale:r,p0:f,fKg:p,icons:q,
selection:a.selection,size:a.size,onMouseMove:a.onMouseMove,onMouseLeave:a.onMouseLeave,onMouseDown:a.onMouseDown,onTouchStart:a.onTouchStart,o0:a.o0,AVc:l})})})}}),$ix=D0(a=>{const b=a.sheet;var c=a.Yqb;const d=a.placement,e=a.scrollMode,f=a.p0,g=a.size,h=a.Ly,k=a.AVc,l=a.GYb,n=a.bTb,p=mfx(()=>e==="native"?l?.(b,!1,!0):B0(()=>{var x=h.gd;const y=h.vB.scale(x);x=h.gM.scale(x);return{position:"relative",top:`${(b.direction==="rtl"?sj(y.tr,x.tr):sj(y.tl,x.tl)).y}px`}}),[b,h,e,l]);if(h.RW){var q=h.gd,
r=b.direction==="rtl",t={KwLdqA:!r,Gkf9sQ:r};if(d==="absolute"){var v=h.vB.scale(q);var w=h.gM.scale(q);w=r?sj(v.tr,w.tr):sj(v.tl,w.tl);c=c.Nva({size:g,scale:q,Ybb:f});v=d==="absolute"?{height:`${v.height}px`,transform:`translate(${-c*(r?-1:1)}px, 0)`}:void 0;w=e==="transform"?{transform:`translateY(${-w.y}px)`}:void 0}return z0("div",{className:G0("M_PYXw",{xeNX_A:d==="absolute"},t),style:v,children:z0("div",{className:"gSxDBQ",style:w,children:z0(n,{sheet:b,scale:q,p0:f,fKg:p,selection:a.selection,
size:a.size,onMouseMove:a.onMouseMove,onMouseLeave:a.onMouseLeave,onMouseDown:a.onMouseDown,onTouchStart:a.onTouchStart,o0:a.o0,AVc:k})})})}});var rjx=D0(({width:a,height:b,top:c,left:d,ko:e,onMouseMove:f,onMouseLeave:g,onDragStart:h,pe:k,onDragEnd:l,Rza:n})=>{const p=E0(()=>A0(v=>f(v)),[f]),q=E0(()=>A0(v=>g(v)),[g]),r=E0(()=>{const v=[new __c.qr({yt:A0(w=>n(w))})];return new dd(v)},[n]),t=E0(()=>new Tq({onDragStart:A0(v=>h(v)),pe:A0(v=>k(v)),onDragEnd:A0(()=>l())}),[h,k,l]);return z0("div",{ref:r?.Gq,style:{width:a,height:b,transform:`translate(${d*(e?-1:1)}px, ${c}px)`},className:G0("o_DvqA",{sXUuSQ:!e,s14v9Q:e}),onMouseDown:t.onMouseDown,
onMouseMove:p,onMouseLeave:q,onTouchStart:t.onTouchStart})});var sjx=D0(({d6o:a,cjj:b,mbp:c,vbp:d})=>F0(I0,{children:[z0(d,{}),z0(a,{}),z0(c,{}),z0(b,{})]}));var Cmx=class{wVl(a){this.zeh.apply(a)}close(){this.Kia();this.zeh.complete()}constructor(a,b,c,d){this.zeh=a;this.sBd=b;this.axis=c;this.Kia=d}};var Dmx=class{static G(a){O(a,{B$a:H0.ref,dropTarget:H0.ref})}apply(a){this.B$a=a;const b=this.YA.sheet;var c=this.YA.$R;const d=this.YA.vB;var e=this.YA.gM;e=b.direction==="rtl"?sj(d.tr,e.tr):sj(d.tl,e.tl);this.B$a=a;a=Gv(b,c,d,e,a);a=Cfe(a,b);a==null||this.MR.includes(a)?this.dropTarget=void 0:(c=b.cols.dj(a,this.MR[0])===-1?"before":"after",this.dropTarget=this.hj.$rd(b,this.MR,a,c)?{type:"column",column:a,position:c}:void 0);this.mub||(this.mub=setInterval(()=>this.dv(),200))}complete(){const a=
this.YA,b=this.dropTarget;this.mub&&clearInterval(this.mub);this.mub=void 0;if(b&&b.type==="column"){const c=this.V.wb("sheets_move_used",{Hb:{name:"editor.editing.sheet.move",type:"column"}});this.hj.HVe(a.sheet,this.MR,b.column,b.position,c,"drag");c.end()}}dv(){var a=this.YA;const b=a.sheet,c=a.gM,d=a.vB,e=b.direction==="rtl";a=Gv(b,a.$R,d,sj(e?d.tr:d.tl,e?c.tr:c.tl),this.B$a);Aix(this.Gia,{sheet:b,point:a,scrollX:!0,scrollY:!1})}constructor(a,b,c,d,e){this.YA=b;this.Gia=c;this.hj=d;this.V=e;this.B$a=
(Dmx.G(this),void 0);this.B$a=a;this.MR=b.selection?.columns?.map(f=>f)??[]}},Emx=class{static G(a){O(a,{B$a:H0.ref,dropTarget:H0.ref})}apply(a){this.B$a=a;const b=this.YA.sheet;var c=this.YA.$R;const d=this.YA.vB;var e=this.YA.gM;e=b.direction==="rtl"?sj(d.tr,e.tr):sj(d.tl,e.tl);this.B$a=a;a=Gv(b,c,d,e,a);a=Bfe(a,b);a==null||this.vG.includes(a)?this.dropTarget=void 0:(c=b.rows.dj(a,this.vG[0])===-1?"before":"after",this.dropTarget=this.hj.bsd(b,this.vG,a,c)?{type:"row",row:a,position:c}:void 0,this.mub||
(this.mub=setInterval(()=>this.dv(),200)))}complete(){const a=this.YA,b=this.dropTarget;this.mub&&clearInterval(this.mub);this.mub=void 0;if(b&&b.type==="row"){const c=this.V.wb("sheets_move_used",{Hb:{name:"editor.editing.sheet.move",type:"row"}});this.hj.LVe(a.sheet,this.vG,b.row,b.position,c,"drag");c.end()}}dv(){var a=this.YA;const b=a.sheet,c=a.gM,d=a.vB,e=b.direction==="rtl";a=Gv(b,a.$R,d,sj(e?d.tr:d.tl,e?c.tr:c.tl),this.B$a);Aix(this.Gia,{sheet:b,point:a,scrollX:!1,scrollY:!0})}constructor(a,
b,c,d,e){this.YA=b;this.Gia=c;this.hj=d;this.V=e;this.B$a=(Emx.G(this),void 0);this.B$a=a;this.vG=b.selection?.rows?.map(f=>f)??[]}};var qjx=class{static G(a){O(a,{d_b:B0})}get d_b(){return!!this.store.Qh}constructor(a,b,c,d,e,f,g,h,k){this.store=a;this.YA=b;this.ee=c;this.Ih=d;this.Gia=e;this.hj=f;this.V=g;this.pma=h;this.Wk=k;this.x6g=(qjx.G(this),()=>{this.store.Qpi=!0});this.z6g=()=>{this.store.Qpi=!1};this.B6g=l=>{this.ee.Hii(l)};this.C6g=l=>{this.ee.Hii(l)};this.onDragStart=l=>{const n=m(this.store.SPg);this.Ih.SL(p=>{const q=this.store;var r=this.YA,t=r.sheet,v=r.$R;const w=r.vB;var x=r.gM;const y=J0(new pj(l.clientX,l.clientY),
n.type,r);var z=new pj(0,0);const B=t.direction==="rtl";x=B?sj(w.tr,x.tr):sj(w.tl,x.tl);v=v.then(__c.Kj(w.center(),w.rotation,B,!1)).then(w.Fn());switch(n.type){case "row":if(q.vG.length>0){const C=new pj(0,t.ld(q.vG[0]));z=yk(t).find(G=>G.box.GH(C));t=zk(t,x,z).transformPoint(C);z=v.transformPoint(y);z=new pj(0,z.y-t.y)}r=new Emx(y,r,this.Gia,this.hj,this.V);break;case "column":if(q.k3b.length>0){const C=new pj(t.yd(q.k3b[0]),0);z=yk(t).find(G=>G.box.GH(C));t=zk(t,x,z).transformPoint(C);z=v.transformPoint(y);
z=new pj(z.x-t.x,0)}r=new Dmx(y,r,this.Gia,this.hj,this.V);break;default:throw new u(n);}q.Qh=new Cmx(r,z,n.type,p)})};this.pe=l=>{var n=this.store;const p=this.YA;n.Qh!=null&&(n=n.Qh,l=J0(new pj(l.clientX,l.clientY),n.axis,p),n.wVl(l))};this.onDragEnd=()=>{const l=this.store;l.Qh?.close();l.Qh=void 0};this.Rza=l=>{const n=this.store.SPg;l.pointerType==="touch"&&n&&(this.pma?.VOb(new pj(l.Li,l.zj),"sheet","long_press"),this.Wk?.tO&&this.Wk.tO(new __c.ap))}}};var pjx=class{static G(a){O(a,{Qh:H0.ref,Qpi:H0.ref,SPg:B0,UKm:B0,$bn:B0,dropTarget:B0,xYa:B0,vG:B0,k3b:B0})}get SPg(){const a=this.vG,b=this.k3b,c=this.Ly.sheet;if(a.length>0)return{type:"row",top:this.osc(new pj(0,c.ld(a[0]))).y,height:a.reduce((d,e)=>d+e.height,0)};if(b.length>0)return{type:"column",left:this.osc(new pj(c.yd(b[0]),0)).x,width:b.reduce((d,e)=>d+e.width,0)}}get UKm(){const a=this.Qh,b=this.vG,c=this.k3b;if(a!=null){if(b.length>0)return{type:"row",top:ojx(this,a.zeh.B$a).y-a.sBd.y,
height:b.reduce((d,e)=>d+e.height,0)};if(c.length>0)return{type:"column",left:ojx(this,a.zeh.B$a).x-a.sBd.x,width:c.reduce((d,e)=>d+e.width,0)}}}get $bn(){const a=this.vG,b=this.k3b;if(this.Qh!=null){var c=this.Ly.sheet;if(a.length>0)return{type:"row",top:this.osc(new pj(0,c.ld(a[0]))).y,height:a.reduce((d,e)=>d+e.height,0)};if(b.length>0)return{type:"column",left:this.osc(new pj(c.yd(b[0]),0)).x,width:b.reduce((d,e)=>d+e.width,0)}}}get dropTarget(){const a=this.Qh;if(a)return a.zeh.dropTarget}get xYa(){return this.Qh!=
null?!0:!this.VIa.value&&this.Ly.RW&&(this.Wa.hover?this.Qpi:!0)&&this.SPg!=null}get vG(){return this.Ly.selection?.rows?.map(a=>a)??[]}get k3b(){return this.Ly.selection?.columns?.map(a=>a)??[]}osc(a){const b=this.Ly.sheet;var c=this.Ly.vB,d=this.Ly.gM;c=b.direction==="rtl"?sj(c.tr,d.tr):sj(c.tl,d.tl);d=yk(b).find(e=>e.box.GH(a));return zk(b,c,d).transformPoint(a)}constructor(a,b,c){this.Ly=a;this.VIa=b;this.Wa=c;this.Qh=(pjx.G(this),void 0);this.Qpi=!1}};var zjx=D0(({sheet:a,row:b,scale:c,offset:d,width:e,headerSize:f,Om:g,osc:h,onDoubleClick:k,onMouseMove:l,onMouseLeave:n,onDragStart:p,pe:q,onDragEnd:r})=>{const t=E0(()=>A0(B=>k(B)),[k]),v=E0(()=>A0(B=>l(B)),[l]),w=E0(()=>A0(B=>n(B)),[n]),x=E0(()=>new Tq({onDragStart:A0(B=>p(B,{type:"row",sheet:a,row:b})),pe:A0(B=>q(B,{type:"row",sheet:a,row:b})),onDragEnd:A0(B=>r(B,{type:"row",sheet:a,row:b}))}),[b,a,p,q,r]);var y=a.direction==="rtl";const z={_4h3wAQ:!y,agAT6w:y};y=d.left*(y?-1:1);c=h(new pj(0,
a.ld(b)+b.height)).y*c+d.top;return F0("div",{style:{transform:`translate(${y}px, ${c}px)`},className:G0("J2v8PQ",z),children:[z0("div",{style:{width:e+f},className:G0("yfwv_Q","HKcVkQ",z),onDoubleClick:t,onMouseDown:x.onMouseDown,onMouseMove:v,onMouseLeave:w,onTouchStart:x.onTouchStart}),z0(g,{})]})}),Ajx=D0(({sheet:a,column:b,scale:c,headerSize:d,height:e,offset:f,Om:g,osc:h,onDoubleClick:k,onMouseMove:l,onMouseLeave:n,onDragStart:p,pe:q,onDragEnd:r})=>{const t=E0(()=>A0(B=>k(B)),[k]),v=E0(()=>
A0(B=>l(B)),[l]),w=E0(()=>A0(B=>n(B)),[n]),x=E0(()=>new Tq({onDragStart:A0(B=>p(B,{type:"column",sheet:a,column:b})),pe:A0(B=>q(B,{type:"column",sheet:a,column:b})),onDragEnd:A0(B=>r(B,{type:"column",sheet:a,column:b}))}),[b,a,p,q,r]),y=a.direction==="rtl",z={_4h3wAQ:!y,agAT6w:y};c=(h(new pj(a.yd(b)+b.width,0)).x*c+f.left)*(y?-1:1);return F0("div",{style:{transform:`translate(${c}px, ${f.top}px)`},className:G0("J2v8PQ",z),children:[z0("div",{style:{height:e+d},className:G0("yfwv_Q","O98RGg",z),onDoubleClick:t,
onMouseDown:x.onMouseDown,onMouseMove:v,onMouseLeave:w,onTouchStart:x.onTouchStart}),z0(g,{})]})});var Bjx=D0(({eEb:a,enp:b,lIp:c,P1o:d})=>F0(I0,{children:[a.map((e,f)=>{switch(e.type){case "row":return z0(b,{target:e},`row-${f}`);case "column":return z0(c,{target:e},`column-${f}`);default:throw new u(e);}}),z0(d,{})]}));var Fmx=class{wVl(a){this.Eol.apply(a)}close(){this.Eol.complete();this.Eol.destroy();this.Kia();this.Z9a.stop()}constructor(a,b,c,d,e){this.target=a;this.Eol=b;this.Z9a=c;this.Kia=d;this.span=e}};var Gmx=class{apply(a){const b=this.CAk;var c=this.sheet;const d=this.column,e=this.YA;c===e.sheet&&(c=c.direction==="rtl",a=ujx(e,a).x-ujx(e,b).x,d.width=Math.max(36,this.qHa+a*(c?-1:1)))}complete(){var a=this.YA;const b=this.sheet,c=this.column;b===a.sheet&&((a=a.selection?.columns)&&a.size>1&&a.forEach(d=>{d.width=c.width}),__c.egg(this.$xa,b,[c,...(a?a.map(d=>d):[])]))}destroy(){}constructor(a,b,c,d,e){this.CAk=a;this.sheet=b;this.column=c;this.YA=d;this.$xa=e;this.qHa=c.width}},Hmx=class{apply(a){const b=
this.CAk,c=this.row,d=this.YA;this.sheet===d.sheet&&(a=ujx(d,a).y-ujx(d,b).y,a=Math.max(36,this.KUa+a),c.height=a,c.minHeight=a)}complete(){var a=this.YA;const b=this.row;this.sheet===a.sheet&&(a=a.selection?.rows)&&a.size>1&&a.forEach(c=>{c.height=b.height;c.minHeight=b.minHeight})}destroy(){}constructor(a,b,c,d){this.CAk=a;this.sheet=b;this.row=c;this.YA=d;this.KUa=c.height}};var yjx=class{static G(a){O(a,{YUa:B0})}get YUa(){return!!this.store.Qh}osc(a,b){const c=b.sheet;var d=b.vB;b=b.gM;d=c.direction==="rtl"?sj(d.tr,b.tr):sj(d.tl,b.tl);b=yk(c).find(e=>e.box.GH(a));return zk(c,d,b).transformPoint(a)}constructor(a,b,c,d,e,f,g,h,k,l){this.store=a;this.YA=b;this.undo=c;this.Ih=d;this.ee=e;this.hj=f;this.$xa=g;this.ZU=h;this.V=k;this.P=l;this.x6g=(yjx.G(this),(n,p,q)=>{const r=this.store;var t=this.YUa;if(n===this.YA.sheet&&!t)switch(t=r.zgr/2,p.type){case "row":var v=n.ld(p.row)*
q,w=v+p.row.height*q;q=v+p.offsetY*q;if(q-v<t)var x=n.rows.previous(p.row);else w-q<t&&(x=p.row);x&&(r.erb={type:"row",row:x,sheet:n});break;case "column":x=n.yd(p.column)*q;w=x+p.column.width*q;q=x+p.offsetX*q;q-x<t?v=n.cols.previous(p.column):w-q<t&&(v=p.column);v&&(r.erb={type:"column",column:v,sheet:n});break;default:throw new u(p);}});this.z6g=()=>{this.YUa||(this.store.erb=void 0)};this.onDoubleClick=()=>{if(this.store.erb){this.ZU.store.draft&&this.ZU.uOa();var n=this.store.erb;switch(n.type){case "row":var p=
this.YA.selection?.rows?.size?new Set(this.YA.selection.rows.map(q=>q)):new Set([n.row]);this.hj.WSi(n.sheet,p.has(n.row)?[...p]:[n.row]);break;case "column":p=this.YA.selection?.columns?.size?new Set(this.YA.selection.columns.map(q=>q)):new Set([n.column]);this.hj.phe(n.sheet,p.has(n.column)?[...p]:[n.column]);break;default:throw new u(n);}}};this.B6g=n=>{this.ee.Hii(n)};this.C6g=n=>{const p=this.YUa;this.ee.Hii(n);p||(this.store.erb=void 0)};this.onDragStart=(n,p)=>{this.Ih.SL(q=>{const r=this.store;
var t=this.YA;const v=new pj(n.clientX,n.clientY),w=this.undo.startBuffering(),x=this.V.wb("sheets_resize_used",{Hb:{name:"editor.editing.sheet.resize",type:p.type}});switch(p.type){case "row":t=new Hmx(v,p.sheet,p.row,t);break;case "column":t=new Gmx(v,p.sheet,p.column,t,this.$xa);break;default:throw new u(p);}r.Qh=new Fmx(p,t,w,q,x)})};this.pe=n=>{const p=this.store,q=m(p.Qh);n=new pj(n.clientX,n.clientY);q.wVl(n);p.aum=n};this.onDragEnd=()=>{const n=this.store;n.Qh?.close();n.Qh?.span.ob().wk(({Oi:p})=>
{this.P.track(__c.W8g,{action:"resized",Tb:p(),Dzc:n.Qh?{Pt:n.Qh.target.sheet.layout.rows.count(),UL:n.Qh.target.sheet.layout.cols.count()}:void 0})});n.Qh?.span.end();n.Qh=void 0;this.store.erb=void 0}}};var xjx=class{static G(a){O(a,{Qh:H0.ref,aum:H0.ref,erb:H0.ref,xYa:B0,eEb:B0,tooltip:B0})}get xYa(){return!this.VIa.value&&this.Ly.RW&&this.eEb.length>0}get eEb(){var a=this.Wa,b=this.Ly;const c=this.erb,d=b.sheet,e=[];a.hover&&c&&e.push(c);a.pua&&(a=b.selection?.rows,b=b.selection?.columns,a&&a.size>0&&a.forEach(f=>e.push({type:"row",row:f,sheet:d})),b&&b.size>0&&b.forEach(f=>e.push({type:"column",column:f,sheet:d})));return e}get tooltip(){const a=this.aum;if(this.Qh&&a)return{label:this.ib,position:a,
placement:this.ek}}get ib(){const a=m(this.Qh);switch(a.target.type){case "row":return`h:${Math.round(a.target.row.height)}`;case "column":return`w:${Math.round(a.target.column.width)}`;default:throw new u(a.target);}}get ek(){const a=this.Ly,b=m(this.Qh).target,c=b.sheet.direction==="rtl";return vjx((b.type==="column"?c?90:-90:0)+a.gM.rotation)}constructor(a,b,c){this.Ly=a;this.Wa=b;this.VIa=c;this.zgr=(xjx.G(this),parseInt("16px",10)||16)}};var Kmx=class{constructor(a,b,c){this.hj=a;this.ZU=b;this.V=c;this.Ngg=()=>{this.ZU.iCb()};this.U8c=(d,e,f,g,h)=>{let k=this.j5a?.(d,e,g);const l=h.map(r=>r);if(!k)return{range:l,Iu:e};var n;__c.Afe(d,l)||(n=e);const p=new iB;n?(e=d.layout.cells.get(n.row,n.column),(e==null||e.span.$b===n.row&&e.span.ec===n.column)&&p.add([n.row,n.column])):h.forEach(r=>{const t=d.layout.cells.get(r.row,r.column);(t==null||t.span.$b===r.row&&t.span.ec===r.column)&&p.add([r.row,r.column])});n=k&&nZa(d,f,k);for(e=n?.filter(r=>
{const t=d.layout.cells.get(r.row,r.column);return t==null||t.span.$b===r.row&&t.span.ec===r.column});e&&e.length===p.size&&e.every(r=>p.has([r.row,r.column]));)n=(k=k&&this.j5a?.(d,k,g))&&nZa(d,f,k),e=n?.filter(r=>{const t=d.layout.cells.get(r.row,r.column);return t==null||t.span.$b===r.row&&t.span.ec===r.column});f=k?d.layout.cells.get(k.row,k.column)?.span||{$b:k.row,ec:k.column,df:k.row,jf:k.column}:void 0;let q;if(f&&k)switch(g){case "left":q={row:k.row,column:f.ec};break;case "right":q={row:k.row,
column:f.jf};break;case "up":q={row:f.$b,column:k.column};break;case "down":q={row:f.df,column:k.column};break;default:throw new u(g);}return{range:n,Iu:q}};this.Mqb=(d,e,f,g,h)=>{h=h.map(n=>n);h=__c.Afe(d,h);var k=e;if(h)switch(k=f,g){case "up":case "down":k={...k,row:e.row};break;case "left":case "right":k={...k,column:e.column};break;default:throw new u(g);}var l=this.CMc(d,k,g);if(l){k=e;if(h)switch(k=f,g){case "up":case "down":l={...l,column:e.column};break;case "left":case "right":l={...l,row:e.row};
break;default:throw new u(g);}return{range:nZa(d,k,l),anchor:k,Iu:l}}};this.gMe=(d,e,f,g,h)=>{if(e){var k=d.layout.rows;d=d.layout.cols;switch(h){case "vertical":var l=new Set;for(const n of g)l.add(n.column);g=[];for(const n of l)for(const p of k)g.push({row:p,column:n});return{range:g,anchor:e,Iu:f};case "horizontal":k=new Set;for(const n of g)k.add(n.row);g=[];for(l of k)for(const n of d)g.push({row:l,column:n});return{range:g,anchor:e,Iu:f};default:throw new u(h);}}};this.DLe=d=>{const e=d.rows.first();
d=d.cols.first();if(e&&d)return{row:e,column:d}};this.j5a=(d,e,f,g={xSm:!0})=>{var h=g.xSm;const k=d.direction==="rtl",l=d.layout.cells.get(e.row,e.column)?.span||{$b:e.row,ec:e.column,df:e.row,jf:e.column},n=l.ec===d.cols.first()&&l.jf===d.cols.last(),p=l.$b!==l.df;g=e.row;e=e.column;if(n&&p){if(f==="next"||f==="down")g=l.df;if(f==="previous"||f==="up")g=l.$b}switch(f){case "left":f=k?Imx(d,l.jf,g):Jmx(d,l.ec,g);break;case "right":f=k?Jmx(d,l.ec,g):Imx(d,l.jf,g);break;case "next":e=l.jf;f=Imx(d,
e,g,h);!f&&g===d.rows.last()&&h&&(f=this.V.wb("sheets_get_next_cell_shortcut_used",{Hb:{name:"editor.editing.sheet.adding",type:"row"}}),this.hj.addRows(d,g,"after",1,f,"shortcut"),f?.qe(),f=Imx(d,e,g,h));break;case "previous":e=l.ec;f=Jmx(d,e,g,h);break;case "up":g=l.$b;h=e;f=(d=d.rows.previous(g))&&{column:h,row:d};break;case "down":g=l.df;h=e;f=(d=d.rows.next(g))&&{column:h,row:d};break;default:throw new u(f);}return f};this.CMc=(d,e,f,g)=>{const h=this.j5a(d,e,f);if(!h)return e;const k=(h?d.layout.cells.get(h.row,
h.column):void 0)?.ref?.content.ref!=null;let l;g===void 0&&(l=d.layout.cells.get(e.row,e.column)?.ref.content.ref!=null);if(k&&h)return g===!1?h:l===!1?this.CMc(d,h,f,!1):this.CMc(d,h,f,!0);if(!k)return g?e:this.CMc(d,h,f,!1)}}},Jmx=(a,b,c,d)=>{b=a.cols.previous(b);return!b&&d?(c=a.rows.previous(c),(a=a.cols.last())&&c&&{column:a,row:c}):b&&{column:b,row:c}},Imx=(a,b,c,d)=>{b=a.cols.next(b);return!b&&d?(c=a.rows.next(c),a=a.cols.first(),c&&a&&{column:a,row:c}):b&&{column:b,row:c}};var Lmx=class{static G(a){O(a,{RW:B0,vB:B0})}get RW(){return!!this.YA.get()?.RW}get sheet(){return m(this.YA.get()).sheet}get selection(){return m(this.YA.get()).selection}get $R(){return m(this.YA.get()).$R}get gM(){return m(this.YA.get()).gM}get vB(){return m(this.YA.get()).vB}get o9b(){return m(this.YA.get()).o9b}get gd(){return m(this.YA.get()).gd}constructor(a,b,c,d){this.QA=a;this.viewport=b;this.pd=c;this.Pa=d;this.YA=(Lmx.G(this),void 0);this.YA=B0(()=>{const e=this.viewport,f=this.Pa,g=this.QA,
h=g.Uu();if(h?.container.type==="sheet-element")return this.Vvo??(this.Vvo=new Mmx(g,e)),this.Vvo;if(e.uh&&hf(e.ya)||h?.container.type==="fixed-page")return this.awo??(this.awo=new Nmx(g,e,f)),this.awo;if(h?.container.type==="sheet-item")return this.Zvo??(this.Zvo=new Omx(g,c,e)),this.Zvo})}},Nmx=class{static G(a){O(a,{FE:B0,RW:B0,sheet:B0,selection:B0})}get FE(){return this.selection?new __c.Xz(this.selection.container,this.viewport,this.Pa):void 0}get RW(){return this.selection!=null&&this.viewport.uh&&
hf(this.viewport.ya)&&this.viewport.ya.sheet===this.selection.sheet}get sheet(){return m(this.FE).sheet}get selection(){var a=this.QA.Uu();if(a?.container.type==="fixed-page")return{sheet:a.sheet,container:a.container,cells:a.inner?.cells,rows:a.inner?.rows,columns:a.inner?.columns};a=this.viewport.Vg;if(this.viewport.uh&&a.type==="fixed-page"&&rf(a))return{sheet:a.page.sheet,container:a,cells:void 0,rows:void 0,columns:void 0}}get $R(){return this.FE?.$R??__c.Dj()}get gM(){return m(this.FE).gM}get vB(){return m(this.FE).vB}get gd(){return m(this.FE).gd}get o9b(){return"large"}constructor(a,
b,c){this.QA=a;this.viewport=b;this.Pa=c;Nmx.G(this)}},Mmx=class{static G(a){O(a,{FE:B0,RW:B0,sheet:B0,selection:B0})}get FE(){return this.selection?new __c.Wz(this.selection.container,this.viewport):void 0}get RW(){return this.selection!=null&&this.viewport.uh}get sheet(){return m(this.FE).sheet}get selection(){const a=this.QA.Uu();if(a&&a.container.type==="sheet-element")return{sheet:a.sheet,container:a.container,cells:a.inner?.cells,rows:a.inner?.rows,columns:a.inner?.columns}}get $R(){return this.FE?.$R??
__c.Dj()}get gM(){return m(this.FE).gM}get vB(){return m(this.FE).vB}get gd(){return m(this.FE).gd}get o9b(){return"small"}constructor(a,b){this.QA=a;this.viewport=b;Mmx.G(this)}},Omx=class{static G(a){O(a,{FE:B0,RW:B0,sheet:B0,selection:B0})}get FE(){return this.selection?new __c.Zz(this.selection.container,this.pd,this.viewport):void 0}get RW(){var a=this.selection?.container.sheet;if(!a)return!1;const b=this.pd.DF(a);a=this.pd.vUa(a);return b!=null&&a!=null}get sheet(){return m(this.FE).sheet}get selection(){const a=
this.QA.Uu();if(a&&a.container.type==="sheet-item")return{sheet:a.sheet,container:a.container,cells:a.inner?.cells,rows:a.inner?.rows,columns:a.inner?.columns}}get $R(){return this.FE?.$R??__c.Dj()}get gM(){return m(this.FE).gM}get vB(){return m(this.FE).vB}get gd(){return m(this.FE).gd}get o9b(){return"small"}constructor(a,b,c){this.QA=a;this.pd=b;this.viewport=c;Omx.G(this)}};var Gjx=class{nUc(){}getContextAttributes(){return __c.ye(Be)}SD(){return this.vid.XIg(this.tb,this.sheet)}ogi(){var a=this.sheet.layout.attrs.get(__c.TNc.ht,this.tb.row,this.tb.column)||{};a=__c.EUf(a);return[he(Be,a)]}setAttributes(a){this.g9a(b=>{this.vid.cje(this.tb,this.sheet,a,b)})}Zta(a){this.g9a(b=>{this.vid.cje(this.tb,this.sheet,a,b)})}H8a(a){this.g9a(b=>{this.vid.iQd(this.tb,this.sheet,a,b)})}a6(a){this.g9a(b=>{this.vid.iQd(this.tb,this.sheet,a,b)})}destroy(){}constructor(a,b,c,d){this.g9a=
a;this.vid=b;this.sheet=c;this.tb=d}},Fjx=class{nUc(){}getContextAttributes(a,b,c){return this.rjl.getContextAttributes(a,b,c)}SD(a,b,c){return this.rjl.SD(a,b,c)}ogi(a,b){return this.rjl.ogi(a,b)}setAttributes(a){this.g9a(b=>{this.cells.forEach(c=>{this.vid.cje(c,this.sheet,a,b)})})}Zta(a){this.g9a(b=>{this.cells.forEach(c=>{this.vid.cje(c,this.sheet,a,b)})})}H8a(a){this.g9a(b=>{this.cells.forEach(c=>{this.vid.iQd(c,this.sheet,a,b)})})}a6(a){this.g9a(b=>{this.cells.forEach(c=>{this.vid.iQd(c,this.sheet,
a,b)})})}destroy(){}constructor(a,b,c,d,e){this.g9a=a;this.vid=b;this.sheet=c;this.rjl=d;this.cells=e}};var Hjx=class{YIg(a){const b=[];for(const c of this.cells(a))b.push(this.dRb.XIg(c,a.sheet.config));return Ejx(b.flatMap(c=>Object.keys(c)),c=>new Set(b.flatMap(d=>[...d[c]])))}cells(a){if(a.cells!=null)return a.cells;const b=a.sheet.config.layout.cols;return a.sheet.config.layout.rows.flatMap(c=>b.map(d=>({row:c,column:d})))}y1a(a,b){this.fd.Ew(c=>{for(const d of this.cells(a))this.dRb.cje(d,a.sheet.config,b,c)})}tYc(a,b){this.fd.Ew(c=>{for(const d of this.cells(a))this.dRb.iQd(d,a.sheet.config,
e=>b(e,"sheet-item-cell-richtext"),c)})}j7f(a,b){this.fd.Ew(c=>{for(const d of this.cells(a))this.dRb.iQd(d,a.sheet.config,e=>{const f=__c.ye(Ae);__c.ina(Ae,f,"all",e);return b(f,"sheet-item-cell-richtext")},c)})}constructor(a,b){this.fd=a;this.dRb=b}};var Pmx=class{static G(a){O(a,{xvi:B0})}async dhi(a,b){try{return await Kjx(this,a,b),(0,__c.La)({spreadsheets:this.spreadsheets,continuation:this.continuation})}catch(c){return this.errorService.ra(c),(0,__c.Ma)(__c.o3g(c))}}async pCf(a,b){try{const {cvb:c,sheets:d}=await Pjx(this,a,b);return(0,__c.La)({...c,id:a,sheets:d})}catch(c){return this.errorService.ra(c),(0,__c.Ma)(__c.o3g(c))}}async Rzd({spreadsheetId:a,h_i:b,range:c}){try{const {sheet:d}=await this.$gi(a,b),e=__c.Kex(this.L4c,d,c);return e==
null?(0,__c.Ma)(__c.o3g(new __c.n3g(`Unable to collect data for range: "${c}"`))):(0,__c.La)(this.kla?.Sol(d,e)??[])}catch(d){return this.errorService.ra(d),(0,__c.Ma)(__c.o3g(d))}}sheetName(a){return __c.Wps(a)}get Hpq(){const a=this.document.Ka;switch(a){case "fixed":return J("gM5Y+A",[this.nr??""]);case "responsive":return M("CCRqXA");default:throw new u(a);}}get nr(){return this.ea.document.Ka==="responsive"?this.ea.doctype?.name:this.hb.c6>1?M("54tboA"):this.ea.doctype?.name}get xvi(){return{id:this.ka,
name:this.document.title||this.Hpq,nr:this.nr??"",url:__c.sB.xzd({id:this.ka}),modifiedTime:new Date}}async getDocumentContent(a){a=m(await this.xAa.smk({ka:a.id,body:{ka:a.id,extension:a.extension}}));if(a.Llh)return Tjx(this,a.Llh);a=m(a.content);return __c.$g.create(__c.Wg.deserialize(a))}async $gi(a,b){const c=await Ljx(this,a),d=await Vjx(this,c,b);if(!d)throw new __c.m3g(`No sheet found for Spreadsheet[${a}] with Id:[${b}]`);Ojx(this,c,[d]);return{sheet:d}}constructor(a){this.errorService=(Pmx.G(this),
void 0);this.spreadsheets=[];this.type="sheets";this.errorService=a.errorService;this.Wp=a.Wp;this.Gb=a.Gb;this.xAa=a.xAa;this.C7a=a.C7a;this.Ff=a.Ff;this.ka=a.ea.id;this.document=a.ea.document;this.X=a.X;this.ea=a.ea;this.kla=a.kla;this.KWc=new __c.Xps(a.ea.document);this.tlb=new __c.rVb(a.ea.document);this.L4c=a.L4c;this.hb=a.hb;this.lq=a.lq}};var Yjx=class{static G(a){O(a,{pje:A0})}constructor(a,b){this.store=a;this.ffc=b;this.dF=(Yjx.G(this),void 0);this.Gso=(c,d)=>{if(d){var e=__c.rAb(d,c);this.Pso(c,e)&&this.ffc&&this.ffc(d)}else this.store.selection=void 0};this.iid=(c,d)=>{d?(d=this.Pso(c,d))&&this.ffc&&(c=d&&__c.kAb(d,c),this.ffc(c)):this.store.selection=void 0};this.Pso=(c,d)=>{d=__c.sAb(c,d);if(d.start.type===0&&d.end.type===0){var e=__c.mZa(c,{start:d.start.value,end:d.end.value});this.store.selection={sheet:c,cells:new ulx(B0(()=>
e)),rows:new ulx(B0(()=>[])),columns:new ulx(B0(()=>[])),anchor:d.start.value,Iu:d.end.value};return d}};this.pje=(c,d)=>{d?this.Gso(c,d):this.lSs(c)};this.lSs=c=>{var d=c.layout.cols.first();var e=c.layout.rows.first();if(e&&d)b:{d={row:e,column:d};for(d={current:{...d},edge:{...d}};d;){if(c.layout.cells.get(d.current.row,d.current.column)?.ref?.content.ref&&(e=__c.lZa(c,{start:d.current,end:d.current}),e.start.row.id!==e.end.row.id||e.start.column.id!==e.end.column.id)){d=e;break b}d=Wjx(c,d)}d=
void 0}else d=void 0;this.iid(c,d?{start:{type:0,value:d.start},end:{type:0,value:d.end}}:void 0)};this.Pzd=()=>{const c=this.store.selection;if(c&&c.cells.size!==0){var d=c.cells,e=c.sheet,f=d.map(g=>g.column).sort((g,h)=>e.layout.cols.dj(g,h));d=d.map(g=>g.row).sort((g,h)=>e.layout.rows.dj(g,h));return __c.kAb({start:{type:0,value:{column:f[0],row:d[0]}},end:{type:0,value:{column:f[f.length-1],row:d[d.length-1]}}},c.sheet)}};this.dF=new __c.mu}};var Xjx=class{static G(a){O(a,{sUd:H0.ref})}get xRe(){return this.S_f||!this.selection?!1:this.selection.cells.size>1}get selection(){return this.S_f?void 0:this.sUd}set selection(a){this.S_f||(this.sUd=a)}constructor(a){this.S_f=a;this.sUd=(Xjx.G(this),void 0)}},Qmx=new ulx(B0(()=>[])),Zjx=class{getSelection(){if(!this.store.S_f){var a=this.store.selection;if(a)return{page:void 0,container:a.sheet,sheet:a.sheet,inner:{anchor:a.anchor,Iu:a.Iu,cells:a.cells,rows:a.rows||Qmx,columns:a.columns||Qmx,
oc:this.oc}}}}Rma(){return this.getSelection()}b2a(a){return a}PMd(a,b,c,d,e,f){if(!this.store.S_f){var g=new iB;for(var h of a.layout.rows)for(var k of f){const n=a.layout.cells.get(h,k)?.span||{$b:h,ec:k};g.add([n.$b,n.ec])}h=new iB;for(const n of e)for(const p of a.layout.cols)k=a.layout.cells.get(n,p)?.span||{$b:n,ec:p},g.add([k.$b,k.ec]);var l=__c.md([...b,...h.map(([n,p])=>({row:n,column:p})),...g.map(([n,p])=>({row:n,column:p}))],n=>`${n.column.id}:${n.row.id}`);this.store.selection={sheet:a,
cells:new ulx(B0(()=>l)),anchor:c,Iu:d,rows:e.length?new ulx(B0(()=>e)):Qmx,columns:f.length?new ulx(B0(()=>f)):Qmx}}}Mno(a,b){this.PMd(a,[b],b,b,[],[])}Q2m(){}gvb(){}ATh(){return!0}constructor(a){this.store=a;this.oc=b=>{if(this.store.S_f||!this.store.selection)return!1;const c=this.store.selection.sheet;return this.store.selection.cells.map(d=>d).some(d=>{if(d.column===b.column&&d.row===b.row)return!0;if(d=c.layout?.cells.get(d.row,d.column)?.span)return c.layout.rows.dj(d.$b,b.row)<=0&&c.layout.rows.dj(d.df,
b.row)>=0&&c.layout.cols.dj(d.ec,b.column)<=0&&c.layout.cols.dj(d.jf,b.column)>=0})}}};var Rmx,akx,Smx=class extends Tex{render(){return z0(this.props.Aea,{sheet:this.props.sheet,MSb:this.props.MSb,P4g:this.P4g,P7g:this.P7g,q5g:this.q5g,btb:this.btb,onDragStart:this.onDragStart,pe:this.pe,onDragEnd:this.onDragEnd,aod:this.aod})}constructor(...a){super(...a);this.P4g=(b,c)=>{this.props.P4g(b,c,this.props.sheet)};this.q5g=(b,c)=>{this.props.q5g(b,c,this.props.sheet)};this.P7g=(b,c)=>{this.props.P7g(b,c,this.props.sheet)};this.btb=(b,c)=>{this.props.btb(b,c,this.props.sheet)};this.onDragStart=
b=>{this.props.onDragStart(b,this.props.sheet)};this.pe=b=>{this.props.pe(b,this.props.sheet)};this.onDragEnd=()=>{this.props.onDragEnd(this.props.sheet)};this.aod=B0(()=>[this.props.$Ap,this.props.Lbp])}};({c:[akx,Rmx]}=Uex(Smx,[],[Lb],Tex));Rmx();var $jx=parseInt("2px",10);var ckx=a=>{const b=Gkx();return F0(Tc,{spacing:"1u",children:[z0(__c.rv,{ariaLabel:M("3a/lYw"),value:a.value,disabled:!a.onChange||a.disabled,U$a:!0,autoCorrect:"off",placeholder:a.aJd??M("cr48yA"),onChange:a.onChange,error:!!a.error,start:F0(I0,{children:[z0("div",{className:"zI984Q",children:z0(__c.fr,{tone:"tertiary",children:a.sheetName?a.sheetName:M("fHosOA")})}),z0(__c.Qt,{direction:"vertical"}),z0(jd,{size:"1u"})]}),end:a.DSc&&!a.Hki&&z0(__c.h$d,{label:M("KIS0bA"),icon:PF,onClick:a.DSc})}),
a.error&&z0(__c.DC,{id:b,tone:"critical",children:a.error})]})};var dkx=class{pje(a,b){this.FVs.pje(a,b)}constructor(a){this.FVs=a}};var Tmx=a=>z0(__c.Ko,{ariaLabel:a.name,onClick:a.onClick,OF:"primary",selected:a.id===a.DAa,thumbnail:a.thumbnail,title:z0(__c.Do,{size:"small",children:a.name}),layout:"vertical",oRa:"thumbnail"});var gkx=({onSelect:a,store:b,Dqj:c})=>{function d(f){return z0(Okx,{client:!0,children:({measureRef:g,contentRect:h})=>h.client&&z0(R,{className:"HCyOFw",ref:g,children:z0(__c.Vu,{aspectRatio:16/9,children:f&&z0(f,{clientHeight:h.client.height,clientWidth:h.client.width})})})})}const e=Dkx();yfx(()=>{e.current?.d0a(b.VNd.findIndex(f=>f.id===b.m9e),"nearest")},[e,b]);return z0(__c.$y,{name:M("EhKjGw"),kZ:e,children:b.VNd.map(function(f){const g=f.name,h=f.id;var k=f.yUb;k=k&&fkx(h,k,c);const l=()=>
a(f),n=d(k);k=D0(()=>z0(Tmx,{name:g??h,id:h,DAa:b.m9e,onClick:l,thumbnail:n},h));return z0(k,{})})})};var lkx=()=>z0(__c.Ck,{tone:"critical",size:"small",children:M("lCe2lQ")});var ikx=({title:a})=>F0(Q,{size:"small",weight:"bold",margins:"legacy",children:[z0(PF,{size:"medium"})," ",a]});var jkx=({sheets:a,vMd:b,onSelect:c,Dqj:d,...e})=>z0(__c.JEe,{...e,tZb:!1,children:z0(__c.ar,{columns:2,spacing:"1.5u",children:a.length>0?a.map(f=>{const g=f.name,h=f.id;var k=f.yUb;const l=k&&fkx(h,k,d);k=z0(Okx,{client:!0,children:({measureRef:n,contentRect:p})=>p.client&&z0(Tc,{spacing:"1u",ref:n,children:z0(__c.Vu,{aspectRatio:16/9,children:l&&z0(l,{clientHeight:p.client.height,clientWidth:p.client.width})})})});return z0("div",{style:{height:"100%"},children:z0(Tmx,{name:g??h,id:h,DAa:b?.id,
onClick:()=>c(f),thumbnail:k})},h)}):z0(__c.Ck,{tone:"warn",size:"small",children:M("YNvCxQ")})})});var Umx=()=>z0("div",{children:z0(__c.Ko,{title:z0(__c.Ut,{size:"medium",variant:"regular"}),thumbnail:z0(__c.Uu,{aspectRatio:16/9,fit:"coverCrop",padding:"none",children:z0(__c.Wu,{border:"none",aspectRatio:16/9})}),un:"bgColorTransition",layout:"vertical",Xm:"thumbnail"})});var kkx=()=>z0(__c.ar,{columns:2,spacing:"1.5u",children:Array(10).fill(void 0).map((a,b)=>z0(Umx,{},b))});var mkx=class extends Tex{get pa(){switch(this.props.loadState){case "loading":return this.props.Ngf;case "ready":return this.props.rpj;case "error":return this.props.Wjj;default:throw new u(this.props.loadState);}}render(){return F0("div",{className:"ZfckVQ",children:[z0(jd,{size:"2u"}),z0(this.props.Ge,{}),z0(jd,{size:"0.5u"}),z0("div",{className:"CMGa2Q",children:z0(this.pa,{})})]})}};var qkx=class{static G(a){O(a,{Bio:A0,lto:A0,mto:A0,Kzl:A0,kto:A0})}async uai(a){this.lto();a=await okx(this,a);a.ok?this.mto(a.value):this.Kzl(a.error);return a}Bio({id:a}){this.kto(a);this.store.vMd||this.Kzl(0)}lto(){this.store.E3f="loading"}mto({sheets:a}){this.store.E3f="ready";this.store.VNd=a}Kzl(){this.store.E3f="error"}kto(a){this.store.m9e=a}constructor(a,b){this.store=a;this.jCa=b;qkx.G(this)}};var pkx=class{static G(a){O(a,{VNd:H0.ref,vMd:B0,E3f:H0.ref,m9e:H0.ref})}get vMd(){if(this.m9e)return this.VNd.find(a=>a.id===this.m9e);if(this.VNd.length===1)return this.VNd[0]}constructor(){this.VNd=(pkx.G(this),[]);this.E3f="ready"}};var vkx=()=>z0(Q,{size:"small",weight:"bold",margins:"legacy",children:M("y+UyKA")});var Vmx=()=>z0(__c.Ck,{tone:"critical",size:"small",children:M("lCe2lQ")});var Wmx=a=>{const [b,c]=Hkx(!1),d=mfx(f=>{f==="error"?c(!0):f==="loaded"&&c(!1)},[]);yfx(()=>{c(!1)},[a.thumbnailUrl]);const e=E0(()=>a.mLc?!a.thumbnailUrl||b?z0(__c.Xu,{Icon:a.mLc,size:"medium",background:"secondary",aspectRatio:16/9}):z0(__c.Yu,{src:a.thumbnailUrl,aspectRatio:16/9,wwa:d}):z0(__c.Yu,{src:a.thumbnailUrl,aspectRatio:16/9}),[a.mLc,a.thumbnailUrl,b,d]);return z0(__c.Ko,{title:z0(__c.Do,{size:"small",children:a.name}),description:a.nr,onClick:()=>{a.onSelect(a.id)},OF:"primary",selected:a.selected,
thumbnail:e,layout:"vertical",oRa:"thumbnail"})};var Xmx=()=>z0("div",{children:z0(__c.Ko,{title:F0(I0,{children:[z0(__c.Ut,{size:"medium",variant:"regular"}),z0(__c.Ut,{size:"small",variant:"regular"})]}),thumbnail:z0(__c.Uu,{aspectRatio:16/9,fit:"coverCrop",padding:"none",children:z0(__c.Wu,{border:"none",aspectRatio:16/9})}),un:"bgColorTransition",layout:"vertical",Xm:"thumbnail"})});var wkx=({spreadsheets:a,glb:b,onSelect:c,loadState:d,mLc:e,...f})=>d==="error"?z0(Vmx,{}):z0(__c.JEe,{...f,tZb:!0,Hik:!0,children:F0(__c.ar,{columns:2,spacing:"1.5u",children:[a.map(({name:g,nr:h,id:k,thumbnailUrl:l})=>z0(Wmx,{name:g??"",id:k,nr:h,onSelect:c,selected:b?.id===k,thumbnailUrl:l,mLc:e},k)),d==="loading"&&Array(10).fill(void 0).map((g,h)=>z0(Xmx,{},h))]})});var ukx=a=>z0(__c.iD,{className:"_7Bqi3Q",onChange:a.onChange,kh:a.kh,o8b:!0,$i:a.$i,border:"solid",placeholder:a.placeholder,value:a.AS});var xkx=a=>F0("div",{className:"DbbuwQ",children:[z0(a.L2,{}),z0(jd,{size:"2u"}),z0(a.Ge,{}),z0(jd,{size:"0.5u"}),z0("div",{className:"OiVHQA",children:z0(a.pa,{})})]});var tkx=class{static G(a){O(a,{IVl:A0,gMd:A0,Lzl:A0,Mzl:A0,AZi:A0,pto:A0,Iji:B0})}IVl(a){this.store.AS=a}async ryf(){if(this.store.hFb!=="loading"){this.Lzl();var a=await this.jCa.qGg({filter:this.store.AS});a.ok?this.Mzl(a.value):this.AZi(a.error);return a}}async myf(){if(this.store.hFb!=="loading"&&this.store.continuation){this.Lzl();var a=await this.jCa.qGg({continuation:this.store.continuation,filter:this.store.AS});a.ok?this.Mzl(a.value):this.AZi(a.error);return a}}gMd({id:a}){this.pto(a);this.store.glb||
this.AZi(0)}Lzl(){this.store.hFb="loading"}Mzl({spreadsheets:a,continuation:b}){this.store.hFb="ready";this.store.continuation=b;this.store.spreadsheets=a}AZi(){this.store.hFb="error";this.store.continuation=void 0}pto(a){this.store.spreadsheetId=a}get Iji(){return!!this.store.continuation}constructor(a,b){this.store=a;this.jCa=b;tkx.G(this)}};var skx=class{static G(a){O(a,{spreadsheets:H0.ref,glb:B0,hFb:H0.ref,AS:H0.ref,spreadsheetId:H0.ref,continuation:H0.ref})}get glb(){return this.spreadsheets.find(a=>a.id===this.spreadsheetId)}constructor(){this.spreadsheets=(skx.G(this),[]);this.hFb="ready";this.AS=""}};var Ymx=class{mBm({store:a,ffc:b,DSc:c,I:d}){return ekx({store:a,Pa:this.Pa,Aea:this.HTb,dF:this.dF,ffc:b,DSc:c,I:d})}get TIa(){var a={errorService:this.errorService,Wp:this.Wp,Gb:this.Gb,xAa:this.xAa,C7a:this.C7a,Ff:this.Ff,vn:this.vn,X:this.X,ea:this.ea,hb:this.hb,kla:this.kla,lq:this.lq};return new Pmx({...a,L4c:new __c.Lex(new __c.mu,new __c.Hex(a.vn))})}get BBm(){const a=this.njq;return({TIa:b,onSelect:c,variant:d="list"})=>{const {qhf:e}=a({I:{Ifr:!0,n5c:!0,H6d:!0}});return rkx({TIa:b,qhf:e,
onSelect:c,variant:d})}}get CBm(){return a=>ykx({TIa:a.TIa,onSelect:a.onSelect,mLc:a.mLc})}OQi(a){return this.rBl.OQi(a)}constructor(a,b,c,d,e,f,g,h,k,l,n,p,q,r,t,v){this.Pa=a;this.HTb=b;this.rBl=c;this.dF=d;this.errorService=e;this.Wp=f;this.Gb=g;this.xAa=h;this.C7a=k;this.Ff=l;this.vn=n;this.X=p;this.ea=q;this.hb=r;this.kla=t;this.lq=v;this.njq=({ffc:w,I:x})=>bkx({Pa:this.Pa,Aea:this.HTb,ffc:w,I:x})}};__c.Lgg={Pqr:function(a){const b=a.X,c=a.session,d=a.qa,e=a.viewport,f=a.rm,g=a.pd,h=a.kb,k=a.sZ,l=a.Vb,n=a.Ih,p=a.HH,q=a.vn,r=a.Dfa,t=a.Jf,v=a.V,w=a.P,x=a.Rt,y=a.GJa,z=a.selection,B=a.ps,C=a.Gg,G=a.nq,H=a.U7d,K=a.qOc,L=a.wPe,N=a.gSg,P=a.gr,T=a.U2b,V=a.zaa,W=a.N6b,aa=a.mc,ba=a.STi,da=a.kJa,la=a.Aia,ja=a.V2b,oa=a.ncf,ma=a.hk,na=a.ee,qa=a.HCe,ua=a.Nub,za=a.Pa,va=a.Kc,xa=a.canvas,Ba=a.la,pa=a.keyboardShortcuts,ia=a.Jd,wa=a.toolbar,Ca=a.pg,Ha=a.ma,Oa=a.he,Ka=a.Se,Ua=a.eo,cb=a.Kh,ab=a.jqa,Ta=a.Mma,mb=
a.sE,pb=a.Nma,xb=a.pAb,nb=a.QCa,qb=a.Y_q,Ob=a.ZKf,Rb=a.NFf,Va=a.mZ,yb=a.cua,Jb=a.dRb,Nb=a.Ldb,ub=a.SEb,Yb=a.kla,hc=a.hj,jc=a.OT,Ec=a.Pub,Qc=a.Oub,bd=a.o2,sc=a.gdh,dc=a.xAa,vb=a.C7a,fc=a.Ff,wc=a.Wp,yc=a.Gb,Fc=a.errorService,cd=a.Wk,wd=a.kBb,ce=a.hb,xe=a.lq,Se=a.EM,ad=a.Mgb,se=a.fI,De=a.kQm,sd=a.M6,Ne=a.N6,Fe=c.undo,Zd=qb.Ind,Kd=qb.mTb,Nd=qb.cHb,Rd=qb.vJ,Sd=qb.Im,Ud=qb.ZHg,ng=qb.jcg,Ie=qb.XJe,Yf=sc.qBl,Hd=sc.fd,lf=sc.T2b,gg=sc.$xa,rd=new mmx,{QA:pe,tKr:$e,rKr:Xg,sKr:uf,o_i:og}=Qix({session:c,Pa:za,
Kc:va,viewport:e,selection:z,pd:g,Ih:n,Gg:C,vJ:Rd,U7d:H,qOc:K,wPe:L,pma:cb,pg:Ca,Wk:cd,ma:Ha,V:v,P:w});rix({QA:pe,hj:hc,pma:cb});const nf=new __c.pVb(l),od=new Lmx(pe,e,g,za),{fse:yd,jBl:Gc}=gfx({Pa:za,mZ:Va,fd:Hd,Gg:C,kNl:T,Rt:x,GJa:y,hk:xh=>{if(za.mode!==40&&ma)return ma(xh)},KGe:__c.zo.uAg}),zd=ja({g0e:void 0}),Yc=la(),be=new __c.IVr,{ZU:Id,lkk:me,SKj:Hg}=cgx({session:c,canvas:xa,Pa:za,viewport:e,selection:z,mc:aa,sE:mb,Im:Sd,Ind:Zd,mTb:Kd,uzp:V,wzp:P,vzp:W,xzp:zd,T2b:lf,ncf:oa,hk:ma,QA:pe,a3j:{CELL_OVERLAY:({ase:xh,
fhf:gj})=>{Gc.MIh=xh;Gc.Pqj=gj},FORMULA_BAR:({ehf:xh})=>{rd.cGh=xh}},fd:Hd,jBl:Gc,Ly:od,Goh:be,Mdb:nf,vJ:Rd,kJa:da,ps:B,undo:Fe,$xa:gg,ma:Ha,V:v,P:w});ba&&(ba.ZU=Id);og.ZU=Id;Va.OIg=()=>Id.OIg();Va.iCb=()=>Id.iCb();Va.xPr=()=>{Id.store.draft&&Id.uOa()};const Ff=()=>!!Id.store.draft;__c.zo.uAg&&Oa?.ym(()=>pe.Uu()!=null,{type:"simple",key:"checkbox-insert",name:M("CvOqKQ"),Icon:__c.aAj,execute:async()=>{const xh=pe.Uu();xh&&(Id.store.draft&&Id.uOa(),Hd.Ew(gj=>{xh.inner?.cells.forEach(qk=>{Hd.getContent(xh.sheet,
qk.row,qk.column)?.NC?.type!==3&&gj.faa(xh.sheet,qk,__c.Uge(!1));gj.m2(xh.sheet,qk,{type:"checkbox",Fj:void 0})})}))}});const ef=(xh,gj)=>{let qk=!1;Hd.Ew(hg=>{gj.forEach(al=>{const ej=Hd.getContent(xh,al.row,al.column);ej?.Dya?.type==="checkbox"&&ej.NC?.type===3&&ej.Nr?.type!=="formula"&&za.mode>=40&&(hg.faa(xh,al,__c.Uge(!ej.NC.value)),qk=!0)})});return qk};k.KOa(Ff);const {qKr:zj,oKr:Jh,pKr:Em}=Ugx({Pa:za,cua:yb,viewport:e,pd:g,QA:pe}),{Xrg:qh,sVs:$k}=Ijx({fd:Hd,Ldb:Nb,SEb:ub,M6:sd,N6:Ne});N($k);
ba&&(ba.Xrg=qh,ba.fd=Hd);const pl=__c.IUr({Mma:Ta,UZc:yd,fd:Hd,Mdb:nf,YXl:B0(()=>za.mode===10)}),Jg=__c.EUr({Aea:pl}),ki=__c.sUr({Aea:pl}),{OIh:Pi,udb:Cf}=__c.BUr({Aea:pl,gr:Yc,Goh:be,onScroll:xh=>__c.lde(g,xh)});xa.Fjj=zj(tix(Yf,$e(Jg)));xa.afa.sTd=Jh(tix(Yf,Xg(ki)));f.Noa.Ejj=Em(tix(Yf,uf(Pi)));const $i=new omx(e,od,Cf);og.Gia=$i;const Sk=new Kmx(hc,Id,v);B.Q5.DLe=Sk.DLe;B.Q5.j5a=Sk.j5a;B.Q5.CMc=Sk.CMc;B.Q5.gMe=Sk.gMe;B.Q5.U8c=Sk.U8c;B.Q5.Mqb=Sk.Mqb;B.Q5.Rzi=(xh,gj)=>{const qk=pe.Uu(Ol.Sw);qk?.container.type!==
"sheet-element"&&qk?.container.type!=="fixed-page"||Id.gvb(gj,xh,"CELL_OVERLAY",0)};B.Q5.Lxi=ef;B.Q5.ofa=(xh,gj,qk)=>{const hg=pe.Uu(Ol.Sw);hg?.container.type!=="sheet-element"&&hg?.container.type!=="fixed-page"||Id.gvb(gj,xh,"CELL_OVERLAY",0,qk?.gFf,qk?.gFf==null?"all":"end")};B.Q5.x4b=Sk.Ngg;B.Q5.uOa=Id.uOa;B.Q5.h3b=$i.h3b;B.KAa.DLe=Sk.DLe;B.KAa.j5a=Sk.j5a;B.KAa.CMc=Sk.CMc;B.KAa.U8c=Sk.U8c;B.KAa.gMe=Sk.gMe;B.KAa.Mqb=Sk.Mqb;B.KAa.Rzi=(xh,gj)=>{Id.gvb(gj,xh,"CELL_OVERLAY",1)};B.KAa.Lxi=ef;B.KAa.ofa=
(xh,gj,qk)=>{Id.gvb(gj,xh,"CELL_OVERLAY",1,qk?.gFf)};B.KAa.uOa=Id.uOa;B.KAa.x4b=Sk.Ngg;B.KAa.h3b=$i.h3b;qhx({ZHg:Ud,ZU:Id,W1f:Sk,Gg:C,selection:z,vJ:Rd,QA:pe,Gia:$i});xa.jc(()=>{const xh=pe.Uu(Ol.Sw);return xh?.container.type==="sheet-element"||xh?.container.type==="fixed-page"?xh:void 0},(xh,gj)=>{xh.Bg.cHb=gj?D0(qk=>{const hg=Id.store.draft;return me()&&qk.page.page===gj.page&&od.RW?z0(I0,{children:hg?.type===2&&z0(Yz,{wz:od,page:qk.page.page,children:z0(Nd,{sheet:hg.sheet,gd:qk.Tc.scale})})}):
null}):void 0});xa.jc(()=>{const xh=pe.Uu(Ol.Sw);return xh?.container.type==="sheet-item"?xh:void 0},(xh,gj)=>{xh.Bn.FL.cHb=gj?D0(()=>{if(!me())return null;const qk=Id.store.draft;return qk!=null&&qk.type===2&&od.RW?z0(I0,{children:qk?.type===2&&z0(Yz,{wz:od,page:void 0,children:z0(Nd,{gd:od.gd,sheet:qk.sheet})})}):null}):void 0});pix({canvas:xa,Pa:za,viewport:e,la:Ba,ee:na,QA:pe,ZU:Id,Gia:$i,WHg:rd,Dfa:r});const {tTd:kf,vTd:zg,rTd:Yg}=Djx({canvas:xa,Pa:za,viewport:e,undo:Fe,hj:hc,Gia:$i,QA:pe,ZU:Id,
Ly:od,$xa:gg,Ih:n,HH:p,nq:G,V:v,P:w,pma:cb,Wk:cd});Tgx({canvas:xa,Pa:za,vn:q,viewport:e,Mgb:ad,Ly:od,QA:pe,fd:Hd,hj:hc,Gia:$i,Ih:n,sE:mb,Nma:pb,vJ:Rd,JEk:Ff,he:Oa,V:v,P:w});jB.cGq&&jgx({canvas:xa,viewport:e,Pa:za,Mgb:ad,Ih:n,vJ:Rd,Ly:od,QA:pe,Gia:$i,cua:yb,JEk:Ff});(jB.vPm||jB.wPm)&&Promise.all([Rb(),(async()=>{if(wd)return wd()})()]).then(([xh,gj])=>{const qk=()=>pe.Uu(Ol.Sw);({Nha:xh}=Hhx({document:c.document,P:w,ma:Ha,sE:mb,pAb:xb,QCa:nb,YJe:xh,upa:Jb,fd:Hd,Rma:qk,g9f:De,mba:gj}));jB.vPm&&whx({qa:d,
la:Ba,canvas:xa,Nub:ua,ZKf:Ob,mTb:Kd,ZU:Id,Ly:od,Rma:qk,Nha:xh,jqa:ab});jB.wPm&&Phx({canvas:xa,qa:d,la:Ba,Nub:ua,he:Oa,ZKf:Ob,Im:Sd,XJe:Ie,mTb:Kd,ZU:Id,Ly:od,Rma:qk,Nha:xh,Kh:cb,jqa:ab,errorService:Fc,mba:gj,V$j:De})});ohx({keyboardShortcuts:pa,vn:q,HCe:qa,Jd:ia,la:Ba,QA:pe,fd:Hd,ZU:Id,OT:jc,V:v,P:w,document:c.document,M6:sd,N6:Ne});Ihx({jcg:ng,canvas:xa,WHg:rd,jqa:ab,Ly:od,ZU:Id,QA:pe,SKj:Hg});const Wh=Vex({Pa:za,Aea:pl,tTd:kf,vTd:zg,rTd:Yg});wfx({la:Ba,he:Oa,Se:Ka,eo:Ua,cua:yb,Jd:ia,toolbar:wa,
VMc:()=>pe.Uu(),vg:z,o2:bd,hj:hc,Pub:Ec,Oub:Qc,designId:a.session.id,kb:h,EM:Se,Jf:t,undo:Fe,V:v});Oa&&Rhx({he:Oa,QA:pe,ZU:Id});const {rBl:ag}=yix({canvas:xa,viewport:e,Pa:za,pd:g}),Vi=new __c.mu,Jk=new Ymx(za,Wh,ag,Vi,Fc,wc,yc,dc,vb,fc,q,b,c,ce,Yb,xe);se.PT=Jk;jB.kLq&&jix({WHg:rd,Mma:Ta,sE:mb,dF:Vi,fd:Hd,upa:Jb,QA:pe,ma:Ha,cua:yb,P:w,V:v,Jd:ia,oea:wa});return{PT:Jk}}};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/8930b115ecc4d65d.js.map