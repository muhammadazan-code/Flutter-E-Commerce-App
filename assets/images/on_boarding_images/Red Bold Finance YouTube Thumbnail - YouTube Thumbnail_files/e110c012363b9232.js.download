(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[27072],{

/***/ 841151:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(698304);__web_req__(704426);__web_req__(613266);__web_req__(764820);__web_req__(611961);__web_req__(187218);__web_req__(604414);__web_req__(463610);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var Q=__c.Q;var tb=__c.tb;var hr=__c.hr;var O=__c.O;var R=__c.R;var J=__c.J;var ek=__c.ek;var M=__c.M;
var z4w=function({locale:a,la:b,X:c,P:d,gsa:e,eT:f,errorService:g,Ha:h,L:k,store:l}){const {RSd:n,jab:p}=__c.bfw({locale:a,la:b,X:c,P:d,gsa:e,errorService:g,Ha:h,w_a:async()=>f}),q=f0(()=>{const v=r4w.map(w=>f.aBf(w));return s4w(f,v)}),r=t4w(({oa:v,We:w})=>{const x=u4w(()=>k.Bzl(!0),[]),y=u4w(z=>{l.TOb&&k.v6h(l.TOb,z,"quick_menu");v()},[v]);return w==="fixed"?g0(__c.CEn,{LN:!0,T4:q.get(),animated:!1,size:"medium",pL:!0,QLa:y,Wec:x}):g0(__c.DEn,{QLa:y,animated:!1,T4:q.get(),Wec:x})}),t=v4w(p);a=t4w(v=>
{const w=v.oa,x=v.We,y=u4w(C=>{l.TOb&&k.v6h(l.TOb,C.r8,"emoji_menu");w()},[w]);v=w4w(()=>()=>g0(t,{YBc:!1,$o:w}),[w]);const z=w4w(()=>()=>g0(r,{oa:w,We:x}),[w,x]),B=w4w(()=>()=>g0(n,{w0a:y,Te:"editor_elements_reaction",YBc:!1}),[y]);return g0(x4w,{qxp:z,eGh:B,rq:v,Mph:l.Mph,We:x})});c=t4w(({m6r:v,oa:w})=>{const x=u4w(C=>{v(C.r8)},[v]),y=b.layout===1?"fixed":"fill",z=w4w(()=>()=>g0(n,{w0a:x,Te:"editor_elements_reaction",YBc:!1}),[x]),B=w4w(()=>()=>g0(t,{YBc:!1,$o:w}),[w]);return g0(y4w,{eGh:z,rq:B,
We:y})});return{WEp:a,XSd:c}},s4w=function(a,b){return b.map(c=>(c=a.fLe(c))&&{key:c.r8,label:c.name,hnb:__c.aIn({Bi:c.mwd,svg:c.imageUrl})}).filter(__c.sb)},C4w=function(a){const b=new __c.Ibr({cTc:new __c.vjd({id:a.ea.id,extension:a.ea.extension}),objectType:3,dBs:2});a.subscription=a.tYg.connect(b,A4w).subscribe(c=>a.lda(c),c=>{c instanceof __c.job||B4w(a,c)})},D4w=function(a){a.Zgd&&clearTimeout(a.Zgd);a.Zgd=void 0;a.zqa=0;a.subscription?.unsubscribe();a.subscription=void 0},B4w=function(a,b){a.zqa>=
3?(D4w(a),a.errorService.error(b,{La:"Max number of reconnection retries reached"})):(a.Zgd&&clearTimeout(a.Zgd),a.Zgd=setTimeout(()=>{C4w(a)},5E3*a.zqa**2),a.zqa++)},F4w=function(a,b){const c=a.V.wb("click_element_reaction",{Hb:{name:"editor.click_element_reaction",attrs:new Map([["source",b.source],["reacted",b.tqa],["element_type",b.CPi]])}});return{LOj:()=>{c.ob().wk(()=>{a.P.track(E4w,{$Pb:b.$Pb,Af:b.Af,tqa:b.tqa,CPi:b.CPi,source:b.source})});c.qe()},e8p:()=>{c.qe({status:"error"})},nwj:()=>
{c.abort()}}},G4w=function(a,b,c){let d,e=c;b.forEach((f,g)=>{f=__c.uj(g,a);f<e&&(e=f,d=g)});return d},H4w=async function(a){const b=[];do{var c=new __c.KEn({source:2,qUc:3,ka:a.ea.id,Of:a.ea.extension,continuation:c});c=await a.k9.qbi(c);if(c.body.summary!=="DOCUMENT_SUMMARY")throw Error("Unreachable");b.push(...c.body.x$b);c=c.body.continuation}while(c);return b},J4w=async function(a){if(a.X){var b=await I4w(a);a.Pvn(b)}},L4w=async function(a){const b=Date.now(),c=b-a.tti;if(!(a.tti!==0&&c<3E4)){a.tti=
b;try{await a.Bui(),a.EXh=0}catch(d){a.EXh++,a.errorService.error(d,{La:"Reacting failed to load data after socket reconnection"}),a.EXh>=3?K4w(a,d,"max_failures"):d instanceof __c.yFa?K4w(a,d,"unauthorized"):d instanceof __c.rh&&K4w(a,d,"forbidden")}}},N4w=function(a){a.wMk?.addListener(a.Pbs);a.wMk?.startSession();a.tti=0;a.EXh=0;const b=__c.Db(()=>{L4w(a)},1E3);a.d8n=M4w(()=>a.wMk?.connectionStatus,c=>c===1&&b())},K4w=function(a,b,c){a.d8n?.();a.errorService.info(b,{La:`Reconnection disposed due to ${({max_failures:"consecutive failures exceeded",
unauthorized:"unauthorized error",forbidden:"forbidden error"})[c]}`})},I4w=async function(a){const b=[];do{var c=new __c.LEn({source:2,qUc:3,ka:a.ea.id,Of:a.ea.extension,continuation:c});c=await a.k9.ybi(c);b.push(...c.MG);c=c.continuation}while(c);return b},O4w=async function(a,b){const c=b.filter(d=>!a.store.TXl.has(d));c.length&&(await a.X2d(c)).forEach(d=>{a.store.TXl.set(d.id,d.displayName)});return b.map(d=>a.store.TXl.get(d)??M("bT/gsA"))},P4w=function(a,b){const c=[...b.uqa];if(c.length>
0)return c[0];const d=a.cBs.next();a.undo.TZ(h0(()=>b.uqa.add(d)));return d},R4w=async function(a,b){var c=a.jek.get(b);if(c)return c;c=(async()=>{const d=[];do{var e=new Q4w({source:2,ka:a.ea.id,Of:a.ea.extension,Af:b,continuation:e});e=await a.k9.pbi(e);d.push(...e.ljl);e=e.continuation}while(e);return d})();a.jek.set(b,c);c.finally(()=>a.jek.delete(b));return c},S4w=function(a){return new Promise(async b=>{let c=0,d;for(;c<=1;)try{await a();b({success:!0});return}catch(e){d=e;if(c<1){const f=5E3*
Math.pow(2,c)*(.3+Math.random()*1.4);await new Promise(g=>setTimeout(g,f))}c++}b({success:!1,error:d})})},T4w=function(a,b){return Array.isArray(a)&&Array.isArray(b)?ek()(a,b):a===b},U4w=function(a){return[...a.uqa].length>0},W4w=function(a,b,c){if(!c.qQc.data.has(a))return b;const d=new Set,e=b.map(f=>{let g=f.count;const h=c.qQc.get(a,f.mQ);h&&(g+=h.action==="add"?1:-1);d.add(f.mQ);return{...f,count:g}});V4w(c.qQc,a).forEach(({Bi:f,action:g,timestamp:h})=>{d.has(f)||g==="delete"||e.push({mQ:f,count:1,
cda:h})});return e},V4w=function(a,b){return(a=a.data.get(b))?[...a.values()]:[]},X4w=function(a,b){const c=a.length;if(b)switch(c){case 0:return M("tjQXag");case 1:return J("+bRPEQ",[a[0]]);case 2:return J("jFXxow",[a[0],a[1]]);default:return J("yH4clQ",[a[0],a[1],c-2])}switch(c){case 0:throw Error();case 1:return a[0];case 2:return J("UEfGIA",[a[0],a[1]]);case 3:return J("p5rcvA",[a[0],a[1],a[2]]);default:return J("UG09+A",[a[0],a[1],a[2],c-3])}},Y4w=function(a,b,c){a=__c.sx(a);const d=b.map(e=>
__c.sx(e));b=b.length;if(c)switch(b){case 0:return J("EcslVg",[a]);case 1:return J("o9Asmg",[a,d[0]]);case 2:return J("/8TYyw",[a,d[0],d[1]]);default:return J("HHOv9A",[a,d[0],d[1],b-2])}switch(b){case 0:throw Error();case 1:return J("rvMsmg",[a,d[0]]);case 2:return J("ZJ/QCw",[a,d[0],d[1]]);case 3:return J("8aDBIg",[a,d[0],d[1],d[2]]);default:return J("pX7Wow",[a,d[0],d[1],d[2],b-3])}},d5w=function({store:a,qa:b,L:c,XSd:d,isDragging:e}){const f=f0(()=>a.TOb),g=({MG:h,dh:k,ye:l,Tc:n,pZc:p})=>g0(Z4w,
{XSd:d,TOb:f,MG:h,h3h:l,Tc:n,dh:k,nxe:c.nxe,Fec:c.Fec,cXe:c.cXe,bXe:c.bXe,QLa:c.v6h,pZc:p,nla:c.nla,iPc:a.iPc});return t4w(({page:h,Tc:k})=>{var l=h.page;$4w(()=>{c.gcc()},[]);if(!a.cFl||!c.ZGf(l))return null;l=c.bah.get(l);if(!l||!l.g6c.length)return null;const n=b.status===2;if(!a.Mxo)return g0(g,{dh:h,ye:n,Tc:k,MG:l.g6c,pZc:c.pZc});const {groups:p,L$i:q}=l.L_p((100/(Math.round((k.scale+Number.EPSILON)*100)/100))**2);return a5w(b5w,{children:[g0(c5w,{Tc:k,groups:p,pDh:l.pDh,isDragging:e}),g0(g,
{dh:h,ye:n,Tc:k,MG:q,pZc:c.pZc})]})})},h5w=function({store:a,qa:b,L:c,XSd:d}){const e=f0(()=>a.TOb),f=t4w(({badge:h,Cee:k})=>c.pZc.intersects(h.Hxc.m_e)?g0(e5w,{XSd:d,TOb:e,Hxc:h.Hxc,MG:h.MG,h3h:b.status===2,Tc:k.Tc,dh:k.page,nxe:c.nxe,Fec:c.Fec,cXe:c.cXe,bXe:c.bXe,QLa:c.v6h,pZc:c.pZc,nla:c.nla,iPc:a.iPc}):null),g=f5w(h=>new g5w(h,k=>g0(f,{badge:h,Cee:k})));return{p3q:f5w(h=>a.cFl&&c.ZGf(h)?c.bah.get(h)?.g6c.map(g)||[]:[])}},i5w=__webpack_require__(31968),b5w=i5w.Fragment,g0=i5w.jsx,a5w=i5w.jsxs;var j5w=__webpack_require__,k5w=j5w(208463),l5w=j5w.n_x(k5w)();var m5w=__webpack_require__(845212),n5w=m5w.createElement,o5w=m5w.forwardRef,p5w=m5w.memo,u4w=m5w.useCallback,$4w=m5w.useEffect,w4w=m5w.useMemo,q5w=m5w.useRef,r5w=m5w.useState;var s5w=__webpack_require__(647370),t5w=s5w.iz,t4w=s5w.PA;var u5w=__webpack_require__(186901),f0=u5w.EW,v5w=u5w.fm,w5w=u5w.h5,x5w=u5w.m3,M4w=u5w.mJ,y5w=u5w.sH,h0=u5w.XI;var A4w=__webpack_require__(388909).t;var z5w=__webpack_require__(536618),f5w=z5w.Aj,A5w=z5w.iB;var B5w={baseUnit:"8px",emojiMenuContainer:"Hs5bqw",fixed:"VFETPg",fill:"_9hwdKA",searchInputContainer:"gb_1Wg",fullMenuContainer:"_9IerIg"};var y4w=a=>{const b=a.eGh,c=a.rq;return a5w("div",{className:l5w("Hs5bqw",B5w[a.We]),children:[g0(R,{className:"gb_1Wg",children:g0(c,{})}),g0(R,{className:"_9IerIg",children:g0(b,{})})]})},x4w=a=>{const b=a.qxp,c=a.eGh,d=a.We,e=a.rq;return a.Mph?g0(y4w,{eGh:c,rq:e,We:d}):g0(R,{padding:d==="fill"?"3u":"0",children:g0(b,{})})},v4w=a=>b=>{const [c,d]=r5w(""),e=u4w(g=>{d(g);a.Idb(g,{Te:b.Te})},[b.Te]),f=u4w(()=>{d("");a.Vxb()},[]);return g0(__c.KC,{ft:!1,type:"search",wlb:!0,Fb:b.$o,placeholder:M("vkzKNA"),
onChange:e,$i:f,value:c})};var r4w=["2764-FE0F","1F44F","1F44D","1F680","1F60D"];var C5w=a=>{const b=a.oa,c=a.onClick,d=a.tF;a=a.CB;const e=u4w(()=>{c?.();b?.()},[c,b]);return g0(d,{onClick:e,CB:a,children:M("0cx55Q")})};var D5w=class{next(){const a=this.count++;return`${this.prefix}-${a.toString(36)}`}constructor(a){this.prefix=a;this.count=0}};var E5w=class{static G(a){O(a,{connectionStatus:f0})}startSession(){this.tYg.sY.subscribe(a=>{this.FDi(a)})}addListener(a){this.vN.add(a)}get connectionStatus(){if(this.qa.status===2)return 3;const a=this.tYg.connectionStatus;switch(a){case 2:return 1;case 1:return 0;case 0:case 3:return 2;default:throw new __c.u(a);}}FDi(a){switch(a){case 0:case 1:case 3:D4w(this);break;case 2:D4w(this);C4w(this);break;default:throw new __c.u(a);}}lda(a){const b=a.object,c=a.X7s,d=a.yz;a=a.hLj;if(b.type==="ELEMENT"){const e=
{rUc:b.Af,version:c,userId:d?.user,hLj:a};Array.from(this.vN.values()).forEach(f=>f(e))}}constructor(a,b,c,d){this.ea=a;this.tYg=b;this.qa=c;this.errorService=d;this.vN=(E5w.G(this),new Set);this.zqa=0}};var E4w={eventType:"editor_element_reaction_clicked",Oa(a){return __c.jf({reaction_id:a.$Pb,element_id:a.Af,reacted:a.tqa,source:a.source,reacted_element_type:a.CPi,editing_context:a.Ca==null?void 0:__c.mf(a.Ca)})}};var F5w=class{constructor(a,b){this.P=a;this.V=b}};var G5w=__c.F(()=>({source:__c.Wa(1,__c.ujd),objectType:__c.A("A?",8,"DOCUMENT_ELEMENT"),ka:__c.S(31),Of:__c.U(32),esa:__c.np(33),Syi:__c.mp(35)}));var Q4w=__c.F(()=>({...__c.JEn(),cTc:__c.A("A?",9,"DOCUMENT_ELEMENT"),ka:__c.S(31),Of:__c.U(32),Af:__c.S(33)}));var H5w=__c.aIn({Bi:"emoji not found",svg:__webpack_require__.p+"images/adbe5dbb49ce95539efe5d89a7aeaadb.svg"});var I5w=(a,b)=>{const c=new Map;for(const e of a)if(a=G4w(e,c,b)){const f=c.get(a);var d=f.length+1;d={x:(a.x*(d-1)+e.x)/d,y:(a.y*(d-1)+e.y)/d};f?.push(e);c.delete(a);c.set(d,f)}else c.set(e,[e]);return c};var J5w=[],K5w=new Map,L5w=class{static G(a){O(a,{bah:f0({equals:__c.fk()}),WJm:f0,pZc:f0,DOn:h0.bound,vLo:h0,qwl:h0,Bzl:h0,EBj:h0,Pvn:h0,H1e:h0,PPo:h0})}WLe(a,b){a=this.bah.get(a);return a?(a=a.g6c.find(({Hxc:c})=>c.element===b))?a.MG.map(c=>c.T$h).reduce((c,d)=>c+d,0):0:0}get bah(){const a=this.tw?[...this.hF.pages].flatMap(b=>__c.$t.oy(b)):__c.$t.Mv(this.ea.document);return new Map(a.map(b=>[b,this.Jhq(b)]))}get WJm(){return this.k7n?[...this.k7n?.nca(__c.bs.snapshot(this.ea.document))].flatMap(a=>
{const b=this.store.Dge.get(a);return W4w(a,b?.Fkb??J5w,this.store)}).filter(a=>a.count>0).length>0:[...this.bah.values()].reduce((a,b)=>a+b.g6c.length,0)>0}get pZc(){const a=this.viewport.Vg,b=this.viewport.lS(a);return b?b.transform(this.viewport.hm(a)):this.viewport.ey().transform(this.viewport.hm(a))}ZGf(a){return a===this.viewport.Vg.page}DOn(){this.qwl(!this.store.seh)}vLo(){this.qwl(!0);this.X?this.Jb.Td.KMr?.():this.nla()}qwl(a){this.store.seh=a}Bzl(a){this.store.Mph=a}async Bui(){const a=
this.Esa(),[b]=await Promise.all([H4w(this),J4w(this)]);w5w(()=>{this.EBj(b,{type:"full"},a)})}EBj(a,b,c){a.forEach(e=>{const f=e.Af,g=this.store.Dge.get(f);g&&g.version===e.version||(this.store.Dge.set(f,e),this.store.cWf.delete(f))});const d=new Set(a.map(e=>e.Af));b.type==="full"?Array.from(this.store.Dge.keys()).filter(e=>!d.has(e)).forEach(e=>{this.store.Dge.delete(e);this.store.cWf.delete(e)}):b.type!=="partial"||d.has(b.rUc)||(this.store.Dge.delete(b.rUc),this.store.cWf.delete(b.rUc));this.store.qQc.values().filter(e=>
e.value.timestamp>c?!1:b.type==="full"?!0:b.type==="partial"&&e.value.rUc===b.rUc).forEach(({k1:e,k2:f})=>this.store.qQc.delete(e,f))}Pvn(a){const b=new Set;a.forEach(c=>{const d=c.mQ;var e=c.qMa;e.tqa==="ELEMENT"&&(e=e.Af,this.store.EZd.set(e,d,{$Pb:c.id}),b.add(`${e}##${d}`))});this.store.EZd.values().forEach(({k1:c,k2:d})=>{b.has(`${c}##${d}`)||this.store.EZd.delete(c,d)})}async H1e(a,b){if(!this.reh){this.reh=!0;this.store.qQc.set(b,a,{action:"add",rUc:b,Bi:a,timestamp:this.Esa()});try{const c=
await this.k9.g4c(new __c.SRg({body:new __c.QRg({source:2,mQ:a,cTc:new __c.vjd({id:this.ea.id,extension:this.ea.extension}),id:b})}));if(c.type==="ERROR")throw Error(c.errorCode===2?"Reactions Disabled":c.errorCode===1?"Already Reacted":"Other Error");w5w(()=>{this.store.EZd.set(b,a,{$Pb:c.id})});return!0}catch(c){return this.store.qQc.delete(b,a),this.errorService.error(c,{La:"Error creating reaction"}),!1}finally{this.reh=!1}}}async PPo(a,b){if(!this.reh){var {$Pb:c}=this.store.EZd.get(b,a)??{};
if(c){this.store.qQc.set(b,a,{action:"delete",rUc:b,Bi:a,timestamp:this.Esa()});try{const d=await this.k9.M1h(new __c.IEn({id:c}));if(d.type==="ERROR"&&d.errorCode===1)throw Error("Reaction id not found");w5w(()=>{this.store.EZd.delete(b,a)});return!0}catch(d){return this.store.qQc.delete(b,a),this.errorService.error(d,{La:"Error deleting reaction"}),!1}finally{this.reh=!1}}}}async n9c(a,b){a=new G5w({source:2,ka:this.ea.id,Of:this.ea.extension,esa:a,Syi:b});a=await this.k9.n9c(a);if(a.body.summary!==
"DOCUMENT_SUMMARY")throw Error("Unreachable");return a.body.x$b}async X2d(a){if(!a.length)return new Map;const b=[],c=[];a.forEach(e=>{var f=this.lek.get(e);f?(f=f.then(g=>({id:e,user:g.get(e)})),b.push(f)):c.push(e)});const d=(async e=>{const f=new Map;if(!e.length)return f;do{var g=await this.Na.IZa(new __c.Fs({Rg:e,continuation:g}));g.xg.forEach(h=>f.set(h.id,h));g=g.continuation}while(g);return f})(c);c.forEach(e=>this.lek.set(e,d));try{const [e,...f]=await Promise.all([d,...b]);f.forEach(({id:g,
user:h})=>h&&e.set(g,h));return e}finally{c.forEach(e=>this.lek.delete(e))}}constructor(a,b,c,d,e,f,g,h,k,l,n,p,q,r,t,v,w,x,y,z=()=>Date.now()){this.store=a;this.wMk=b;this.qa=c;this.ea=d;this.hb=e;this.hF=f;this.X=g;this.undo=h;this.selection=k;this.vib=l;this.Jb=n;this.viewport=p;this.k9=q;this.Na=r;this.errorService=t;this.eT=v;this.cBs=w;this.YAs=x;this.tw=y;this.Esa=z;this.reh=(L5w.G(this),!1);this.jek=new Map;this.d8n=void 0;this.EXh=this.tti=0;this.gcc=async()=>{if(this.store.YNc!=="uninitialized")return!1;
w5w(()=>this.store.YNc="initializing");const B=await S4w(()=>Promise.all([this.eT.ZQg(this.X?.user.locale??"en"),this.Bui()]));if(!B.success)return w5w(()=>this.store.YNc="uninitialized"),this.errorService.error(B.error,{La:"Reacting failed to initialize after retries"}),!1;w5w(()=>{N4w(this);this.store.YNc="initialized"});return!0};this.v6h=h0(async(B,C,G)=>{if(!this.X)this.nla();else if(this.qa.status===1){var H=P4w(this,B);B=__c.usf(B)||"";var K=this.store.EZd.has(H,C),{LOj:L,e8p:N,nwj:P}=F4w(this.YAs,
{$Pb:C,Af:H,tqa:!K,CPi:B,source:G});C=K?await this.PPo(C,H):await this.H1e(C,H);C===!0?L():C===!1?N():P()}});this.Fec=h0((B,C)=>{this.vib.B1a({page:B,element:C})});this.cXe=h0(()=>{this.vib.B1a({})});this.bXe=h0((B,C)=>{this.selection.Jl(B,C)});this.gwt=(B,C)=>{const G=this.viewport.ey(),H=C.width,K=C.height;this.viewport.HC(B,__c.tk(Math.min(H===0?1:G.width/(H*1.2),K===0?1:G.height/(K*1.2)),.01,1),{animate:!0,center:C.center()})};this.fco=B=>this.eT.fLe(B);this.odr=(B,C)=>[...B.uqa].some(G=>{const H=
this.store.qQc.get(G,C);return this.store.EZd.has(G,C)?H?.action!=="delete":H?.action==="add"});this.zIs=(B,C)=>{const G=[...B.uqa];if(!G.length)return[];B=G.map(H=>{const K=this.store.cWf.get(H);return{rUc:H,qy:K&&K.filter(L=>L.mQ===C).map(L=>L.user)}});if(B.every(H=>H.qy!=null))return B=B.flatMap(H=>H.qy).filter(__c.sb),O4w(this,[...(new Set(B)).values()]);B=B.map(H=>H.qy==null?H.rUc:void 0).filter(__c.sb).map(H=>R4w(this,H).then(K=>{const L=K.filter(N=>N.user!==this.X?.user.id);w5w(()=>this.store.cWf.set(H,
L))}));return Promise.all(B).then(()=>{var H=G.flatMap(K=>__c.m(this.store.cWf.get(K)).filter(L=>L.mQ===C).map(L=>L.user));H=[...(new Set(H)).values()];return O4w(this,H)})};this.nxe=A5w((B,C,G,H,K)=>{C=this.hb.kl(C);if(__c.ug(C))return{x:0,y:0};G=__c.Fj(G);B=__c.Nj(B.m_e).transform(G);C=__c.sg(4,C);const {x:L,y:N}=G.transform(C.width,C.height);return{x:B.r.x+H>L?-(B.r.x+H-L):0,y:B.b.y+K>=N?-(B.b.y+K-N):0}},{equals:x5w.shallow});this.nla=()=>{this.Jb.bCi?this.Jb.bCi():this.errorService.error("Attempt to call onAnonReactingAction without it being set")};
this.Pbs=async B=>{const C=B.rUc;var G=B.version;const H=B.userId;B=B.hLj;await (H&&this.X?.user.id===H&&!B.every(K=>this.store.qQc.has(C,K.mQ))?J4w(this):Promise.resolve());G=await this.n9c([C],[G]);this.EBj(G,{type:"partial",rUc:C},this.Esa())};this.Jhq=f5w(B=>new M5w(B,this.store,this));this.lek=new Map;y&&(this.k7n=new N5w)}},M5w=class{static G(a){O(a,{g6c:f0({equals:ek()}),hSk:f0({equals:ek()}),xZl:f0({equals:ek()})})}get g6c(){return this.xZl.length?this.xZl.map(this.KBq).filter(__c.sb):J5w}get hSk(){return this.page.elements.filter(a=>
a.type==="group"?U4w(a)||a.pb.some(U4w):U4w(a))}get xZl(){return(this.store.isDragging()&&this.store.Lm?this.hSk.filter(a=>!this.store.Lm?.has(a)):this.hSk).flatMap(this.tiq)}constructor(a,b,c,d=I5w){this.page=a;this.store=b;this.L=c;this.K_p=d;this.pDh=(M5w.G(this),e=>{e=__c.Mj(...e);this.L.gwt(this.page,e)});this.L_p=f5w(e=>{var f=this.g6c.map(g=>({...g.Hxc.m_e.br,data:g}));if(f.length<=0)return{groups:K5w,L$i:J5w};e=this.K_p(f,e);f=[...e.values()].filter(g=>g.length===1).flatMap(g=>g[0].data);
for(const [g,h]of e)h.length===1&&e.delete(g);return{groups:e,L$i:f}});this.tiq=f5w(e=>e.type==="group"?e.pb.map(f=>new O5w(f,e)):[new O5w(e)]);this.KBq=f5w(e=>{var f=[...e.element.uqa].flatMap(g=>{const h=this.store.Dge.get(g);return this.YPr(g,h?.Fkb??J5w)}).filter(g=>g.count>0).sort(P5w);if(f.length)return f=f.map(g=>this.uiq(g.mQ,g.count,g.cda,e.element)),{Hxc:e,MG:f}});this.uiq=A5w((e,f,g,h)=>new Q5w(e,f,g,h,this.store,this.L));this.YPr=A5w((e,f)=>W4w(e,f,this.store))}},N5w=class extends __c.fs{xh(...a){switch(a.length){case 0:return this.empty;
case 1:return a[0];default:const b=new Set;for(const c of a)for(const d of c)b.add(d);return b}}rEd(a){return new Set(a.uqa.keys())}constructor(){super();this.I={};this.empty=new Set}},O5w=class{static G(a){O(a,{m_e:f0})}get m_e(){if(!this.parent)return __c.Oj(this.element);const a=__c.Fj(this.parent.width/this.parent.gb).then(__c.Tj(__c.Oj(this.parent)));return __c.Oj(this.element).transform(a)}constructor(a,b){this.element=a;this.parent=b;O5w.G(this)}},Q5w=class{static G(a){O(a,{xg:f0({equals:T4w})})}get selected(){return this.L.odr(this.element,
this.JJc)}get xg(){return this.T$h===1&&this.selected||!this.store.iPc?J5w:this.L.zIs(this.element,this.JJc)}get label(){!this.Tpc&&this.retry<this.V5l&&(this.retry+=1,this.Tpc=this.L.fco(this.JJc));return this.Tpc?.name??""}get hnb(){if(this.Qjj)return this.Qjj;!this.Tpc&&this.retry<this.V5l&&(this.retry+=1,this.Tpc=this.L.fco(this.JJc));return this.Tpc?this.Qjj=__c.aIn({Bi:this.JJc,svg:this.Tpc.imageUrl}):H5w}constructor(a,b,c,d,e,f){this.JJc=a;this.T$h=b;this.cda=c;this.element=d;this.store=e;
this.L=f;this.V5l=(Q5w.G(this),3);this.retry=0}},P5w=(a,b)=>a.cda-b.cda;var R5w=class{static G(a){O(a,{YNc:y5w.ref,Mph:y5w.ref,seh:y5w.ref,Dge:y5w.shallow,Vdb:f0,iPc:f0,Mxo:f0,TOb:f0,Lm:f0,Mhs:f0,cFl:f0})}get Vdb(){return this.Pa.mode!==10&&this.TOb?__c.Wj(this.TOb):!1}get iPc(){return this.X!==void 0}get Mxo(){return this.viewport.zoom.scale<=.85}get TOb(){const a=this.selection.Ma;return a?.type==="elements"?a.Pd:void 0}get Lm(){const a=this.selection.Ma;return a?.type==="elements"?new Set(a.elements):void 0}get Mhs(){return this.TOb&&__c.Wj(this.TOb)?this.TOb:void 0}get cFl(){return this.YNc===
"initialized"&&this.viewport.uh&&this.seh&&!this.viewport.uK}constructor(a,b,c,d,e){this.selection=a;this.Pa=b;this.viewport=c;this.X=d;this.isDragging=e;this.YNc=(R5w.G(this),"uninitialized");this.Mph=!1;this.seh=!0;this.EZd=new S5w;this.Dge=new Map;this.TXl=new Map;this.cWf=new Map;this.qQc=new S5w}},S5w=class{static G(a){O(a,{data:y5w.deep,set:h0,delete:h0,Dqq:h0,clear:h0})}has(a,b){return!!this.data.get(a)?.get(b)}get(a,b){return this.data.get(a)?.get(b)}values(){const a=[];for(const [b,c]of this.data.entries())for(const [d,
e]of c.entries())a.push({k1:b,k2:d,value:e});return a}set(a,b,c){let d=this.data.get(a);d?d.set(b,c):(d=new Map([[b,c]]),this.data.set(a,d))}delete(a,b){this.data.get(a)?.delete(b)}Dqq(a){this.data.delete(a)}clear(){this.data.clear()}constructor(){this.data=(S5w.G(this),new Map)}};var T5w=a=>g0(a.yi,{disabled:a.disabled,icon:__c.tEn,onClick:a.onClick,zh:"icon",T9:a.Fxa,tooltip:M("47YmeQ")});var U5w=t4w(({Bi:a,QLa:b,HDe:c})=>{const d=a.label,e=a.hnb,f=a.JJc,g=a.selected,h=a.T$h,k=t5w(()=>({count:h,tooltip:"",Uxo:!1,xg:void 0,gje:h0(n=>k.count=n),duo:h0(n=>k.tooltip=n),$Ao:h0(()=>{c&&(k.Uxo=!0)})})),l=k.Uxo?a.xg:void 0;$4w(()=>{k.$Ao&&(l?((l instanceof Promise||typeof(l||{}).then==="function")&&k.duo("..."),Promise.resolve(l).then(n=>{k.gje(n.length+(g?1:0));(n.length>0||g)&&k.duo(X4w(n,g))})):k.gje(h))},[k,l,g,h]);a=w4w(()=>`"${d}"`,[d]);return a5w(__c.br,{spacing:"0",Fa:"center",children:[g0(__c.er,
{label:a,description:c?k.tooltip:void 0,children:g0(hr,{ariaLabel:d,className:l5w("tZNPGA","VpS0Qg",{_2FVqQ:tb.rd}),onClick:()=>b(f),onMouseEnter:k.$Ao,children:g0(R,{padding:"0.5u",className:l5w({Rt4ETw:g}),children:g0(e,{size:"smallMedium"})})})}),k.count>1?g0(R,{Lb:"0.5u",className:"xwgM3g",children:g0(Q,{size:"small",weight:"bold",tone:__c.cr,children:k.count>99?"+99":k.count.toString()})}):null]})});var V5w=o5w((a,b)=>{const {T4:c,active:d,h3h:e,Fec:f,cXe:g,bXe:h,QLa:k,Wec:l,F0r:n,HDe:p=!0}=a;a=c.slice(0,3);const q=c.length-a.length,r=__c.Wb(),t=!r&&!e&&!!d,v=u4w(w=>h&&w.key==="Enter"&&h(),[h]);return a5w("div",{className:l5w("oeUQFw",{Yxo8OA:r,eWxr1A:t,QoeJJw:tb.rd}),onMouseEnter:f,onMouseLeave:g,children:[g0(R,{padding:"0.5u",className:"AbQqWQ",children:a5w(__c.$q,{spacing:"0.5u",Fa:"center",children:[a.map(w=>g0(__c.Yq,{width:"content",children:g0(U5w,{HDe:p,Bi:w,QLa:k})},w.JJc)),q>0?g0(__c.Yq,
{width:"content",children:g0(hr,{ariaLabel:M("dJR7ow"),ib:M("dJR7ow"),ek:"top",className:l5w("VpS0Qg","eRvfDA"),onClick:l,children:a5w(Q,{size:"xsmall",tone:__c.cr,children:["+",q]})})}):null]})}),!e&&g0("div",{className:l5w("RuEJKQ",{P9tOqw:r,MKq9Mg:t,_27nng:tb.rd}),children:g0("div",{children:g0(hr,{onClick:n,ariaLabel:M("g0hsEw"),ib:M("g0hsEw"),ek:"top",Wi:b,children:g0(R,{padding:"1u",children:g0(__c.tEn,{size:"small",className:"v0DlCg"})})})})}),!r&&!t&&g0("div",{role:"button",className:"FSnQjA",
onClick:h,onKeyDown:v,tabIndex:-1})]})}),W5w=p5w(V5w);var Y5w=({T4:a,QLa:b,HDe:c})=>{const [d,e]=r5w(!1);$4w(()=>{const f=a.map(g=>g.xg);Promise.all(f).then(g=>{g.every(h=>h!==void 0)&&e(!0)})},[e,a]);return g0(R,{minHeight:"minTouchableArea",padding:"2u",children:d||!c?g0("div",{className:"dHRphA",children:a.map(f=>g0(X5w,{Bi:f,HDe:c,QLa:b},f.JJc))}):g0(__c.hv,{})})},X5w=({Bi:a,HDe:b,QLa:c})=>{const d=a.hnb,e=a.label,f=a.JJc;var g=a.T$h;const [h,k]=r5w("..."),[l,n]=r5w(g);g=u4w(()=>{c(f)},[f,c]);$4w(()=>{b?a.xg&&Promise.resolve(a.xg).then(p=>{k(Y4w(a.label,
p,a.selected));n(p.length+(a.selected?1:0))}):k(`"${a.label}"`)},[k,a,n,b]);return a5w(b5w,{children:[g0(hr,{ariaLabel:e,onClick:g,children:g0(d,{size:"smallMedium"})}),g0(Q,{size:"small",weight:"bold",tone:"tertiary",alignment:"center",children:l.toString()}),g0(R,{tp:"0.5u",children:g0(Q,{size:"small",children:g0(__c.Zj,{message:h})})})]})};var Z5w=parseInt("-16px",10),Z4w=t4w(a=>{var b=a.MG;const c=a.pZc;if(!b.length)return null;b=b.filter(({Hxc:d})=>c.intersects(d.m_e));return g0("div",{className:"Osi_CQ",children:b.map(({Hxc:d,MG:e})=>n5w(e5w,{...a,key:`${d.parent?"grouped":"solo"}+${[...d.element.uqa][0]}`,Hxc:d,MG:e}))})}),e5w=t4w(a=>{const b=a.XSd,c=a.dh,d=a.Hxc,e=a.MG,f=a.Tc,g=a.TOb,h=a.h3h,k=a.Fec,l=a.cXe,n=a.bXe,p=a.QLa,q=a.nxe,r=a.nla,t=a.iPc;a=q5w(null);const v=c.page,{x5j:w,njl:x,eBq:y,mis:z,d6p:B,ajs:C,o6p:G}=t5w(()=>({x5j:!1,
njl:!1,Voi:!1,get eBq(){return d.element===g.get()},mis(){t?this.x5j=!0:r()},d6p(){this.x5j=!1},ajs(){this.Voi||(this.njl=!0)},o6p(){this.Voi||(this.njl=!1,this.Voi=!0,window.setTimeout(h0(()=>this.Voi=!1),500))}})),H=u4w(N=>{p(d.element,N,"reaction_badge");B()},[p,d,B]),K=u4w(()=>k(v,d.element),[k,v,d]),L=u4w(()=>n(c,d.element),[n,c,d]);return e.length?a5w($5w,{Hxc:d,Tc:f,page:v,nxe:q,children:[g0(W5w,{ref:a,T4:e,active:y,h3h:h,Fec:K,cXe:l,bXe:L,QLa:H,Wec:C,F0r:z,HDe:t}),g0(__c.Io,{title:g0(__c.Mzc,
{alignment:"center",children:M("F/2r5g")}),width:"40u",open:x,trigger:g0("div",{}),oa:G,children:g0(Y5w,{T4:e,HDe:t,QLa:H})}),a.current&&g0(__c.Io,{width:"40u",trigger:a.current,open:w,oa:B,children:g0(b,{m6r:H,oa:B})})]}):null}),$5w=t4w(({Hxc:a,children:b,Tc:c,page:d,nxe:e})=>{const f=q5w(null),g=q5w(null);$4w(()=>{const h=v5w(()=>{if(f.current&&g.current){var k=c.scale,{left:l,top:n,width:p,height:q}=__c.Nj(a.m_e).transform(__c.Fj(k)).Nb(),r=`translate(${l}px, ${n}px)`,t=__c.Uc*2*k,{x:v,y:w}=e(a,
d,k,-t,Math.abs(Z5w));f.current.style.width=`${p}px`;f.current.style.height=`${q}px`;f.current.style.transform=r;g.current.style.right=`${t}px`;g.current.style.transform=`translate(${v}px, ${w}px)`}},{scheduler:requestAnimationFrame});return()=>h()},[]);return g0("div",{className:"UoE5yg",ref:f,children:g0("div",{className:l5w("Xr1a8Q"),ref:g,children:b})})});var c5w=t4w(({Tc:a,groups:b,pDh:c,isDragging:d})=>d()?null:g0(b5w,{children:[...b.entries()].map(([e,f])=>g0(a6w,{Tc:a,Bal:e,onClick:c,Td:f},`${e.x}-${e.y}`))})),b6w=parseInt("40px",10)/2,a6w=t4w(({Bal:a,onClick:b,Td:c,Tc:d})=>{const e=q5w(null),f=c.flatMap(h=>h.data.MG).slice(0,4),g=u4w(()=>{b(c)},[c,b]);$4w(()=>v5w(()=>{if(e.current){var h=__c.Fj(d.scale).transformPoint(a);e.current.style.transform=`translate(${h.x-b6w}px, ${h.y-b6w}px)`}},{scheduler:requestAnimationFrame}),[a,d]);return g0("div",
{ref:e,className:l5w("xtygIA",{ybUsoQ:tb.rd}),children:a5w(hr,{className:"X4MYyw",onClick:g,children:[g0("div",{className:"woIoQw",children:g0(Q,{tone:"primary",weight:"bold",className:"E_aWfw",children:c.length})}),g0("div",{className:l5w("M_GlUQ",{MiGzlg:tb.rd}),children:f.map(({hnb:h,JJc:k},l)=>g0(R,{className:"uXS2Nw",children:g0(h,{size:"xsmall"})},`${k}-${l}`))})]})})});var g5w=class{static G(a){O(a,{x:f0,y:f0,M2l:f0,XEj:f0,Z3n:f0({equals:ek()})})}get x(){return this.XEj.x}get y(){return this.XEj.y}get M2l(){return this.Z3n.map(({hnb:a,JJc:b})=>()=>g0(a,{size:"xsmall"},b))}get XEj(){return this.g6c.Hxc.m_e.br}get Z3n(){return this.g6c.MG.slice(0,4)}constructor(a,b){this.g6c=a;this.u1o=b;g5w.G(this)}};__c.DVf={pqr:function(a){const b=a.ea,c=a.hb,d=a.hF,e=a.k9;var f=a.tYg;const g=a.toolbar,h=a.Jd,k=a.dda,l=a.selection,n=a.Pa,p=a.ee,q=a.vib,r=a.Gj,t=a.viewport,v=a.isDragging,w=a.locale,x=a.X,y=a.la,z=a.qa,B=a.Na,C=a.gsa,G=a.eT,H=a.Ha,K=a.errorService,L=a.P,N=a.Jb;a=a.LGg;if(b.clientId==null){var P=Date.now().toString(36).slice(-5);P=new D5w(P)}else P=new D5w(b.clientId);var T=H.Vd("editor.editing_reacting");T=new F5w(L,T);const V=new R5w(l,n,t,x,v);f=f&&new E5w(b,f,z,K);const W=new L5w(V,f,z,b,c,
d,x,b.undo,l,q,N,t,e,B,K,G,P,T,__c.Hl.tw),{WEp:aa,XSd:ba}=z4w({locale:w,la:y,X:x,P:L,gsa:C,eT:G,errorService:K,Ha:H,L:W,store:V});if(a){const la=h5w({store:V,L:W,qa:z,XSd:ba});a.S7l=()=>la;W.gcc().catch(ja=>{K.error(ja,{La:"Reacting failed to initialize on install"})})}else{const la=d5w({store:V,qa:z,L:W,XSd:ba,isDragging:v});r.jc(ja=>ja!==10,(ja,oa)=>{ja.Bg.Vqe=oa?la:void 0})}const da={Sd:()=>V.Vdb,Button:t4w(la=>{const ja=la.onClick,oa=z.status===2,ma=u4w(()=>{W.vLo();x&&ja?.()},[ja]);return g0(T5w,
{...la,Fxa:N.Td.P7l,onClick:ma,disabled:oa})}),pa:aa,onClose:()=>W.Bzl(!1),vv:{YK:!0}};h.plugins.Reaction=()=>da;k?k.Reaction=()=>da:g.BF?.jc(()=>V.Vdb,(la,ja)=>{la.Reaction=ja?()=>da:void 0});p.wv(la=>la>10&&W.WJm,({vM:la},ja)=>{la&&(la.nlj=ja?{Button:t4w(oa=>g0(C5w,{...oa,onClick:W.DOn,CB:!V.seh}))}:void 0)});return{$As:W}}};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/e110c012363b9232.js.map