(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[93195],{

/***/ 732901:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(764820);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var J=__c.J;var xk=__c.xk;var Ee=__c.Ee;var Ups,Vps,Rps;__c.Sps=function(a){const b=Rps(),c=new Map,d=new Map,e=new Map;a.cells.forEach((f,g)=>{const h=b();var k=g.top;const l=g.left,n=g.bottom;for(g=g.right;k<=n;k++)for(let p=l;p<=g;p++){const q=a.rows[k],r=a.cols[p];q&&r&&(c.set(`${r.id}:${q.id}`,h),d.set(h,f))}});__c.poa(a.attrs,f=>Ee.ht(f),(f,g,h)=>{g=a.rows[g];h=a.cols[h];g&&h&&e.set(`${h.id}:${g.id}`,f)});return{rows:__c.ud(a.rows),cols:__c.ud(a.cols),UDc:c,rra:d,_attributes:e}};
__c.Tps=function(a,b){return(a=a.layout.cells.get(b.row,b.column))?a.span.$b!==a.span.df||a.span.ec!==a.span.jf:!1};
Ups=function(a,b,c,d,e){const f=new Map,g=new Map,h=new __c.iB,k=__c.Sps(b.St),l=k.rows,n=k.cols;let p=d.$b,q=d.ec;a.fd.Ew(t=>{l.forEach(v=>{n.forEach(w=>{w=`${w.id}:${v.id}`;var x=k.UDc.get(w);x=x!=null?k.rra.get(x):void 0;const y=c.layout.cells.get(p,q);let z=y?.span||{ec:q,$b:p,jf:q,df:p};var B=xk(z.$b,z.df,c.layout.rows);const C=xk(z.ec,z.jf,c.layout.cols);if(y&&h.has([y.span.$b,y.span.ec])&&(z.$b!==z.df||z.ec!==z.jf)){for(var G of B)for(const H of C){B=G===z.$b&&H===z.ec?__c.igg(a,c,y?.ref,{EPb:!0,
sIa:!0}):{content:void 0,Cb:void 0,Qj:[]};__c.Tps(c,{column:H,row:G})&&a.Kld(c,{column:H,row:G});t.JEb(c,{column:H,row:G},B.content);t.m2(c,{column:H,row:G},B.Cb);const K=c.layout.cells.get(G,H);K&&(K.ref.Qj=[...B.Qj])}z=c.layout.cells.get(p,q)?.span||{ec:q,$b:p,jf:q,df:p}}h.add([p,q]);G=x?f.get(x):void 0;G==null?(g.set({column:q,row:p},x?{content:x.content,Cb:x.Cb,attrs:k._attributes.get(w)}:void 0),x&&f.set(x,z)):(w=c.layout.cells.get(G.$b,G.ec),c.layout.cells.set({ec:G.ec,$b:G.$b,jf:c.layout.cols.dj(G.jf,
q)>0?G.jf:q,df:c.layout.rows.dj(G.df,p)>0?G.df:p},__c.jgg(a,c,w?.ref,{EPb:!0,sIa:!0})));q=c.layout.cols.next(q)||d.ec});q=d.ec;p=c.layout.rows.next(p)||d.$b})},{n4b:()=>!0});const r=[];a.fd.Ew(t=>{for(const [v,w]of g){const x=c.layout.cells.get(v.row,v.column)?.span||{ec:v.column,$b:v.row,jf:v.column,df:v.row};a.hmh(c,x,w,t,e);r.push({column:x.ec,row:x.$b})}},{n4b:()=>!0});return r};
Vps=function(a,b,c,d,e){__c.ra(d.length>0);const f=__c.Sps(b.St),g=f.rows,h=f.cols,k=new __c.iB;var l=__c.Afe(c,d);if(l){var n=[...xk(l.ec,l.jf,c.cols)];d=[...xk(l.$b,l.df,c.rows)];var p=f.cols.length-n.length;d=f.rows.length-d.length;n=l.jf;var q=l.df;for(var r=0;r<p;r++){const G=c.cols.next(n);if(!G)break;n=G}for(p=0;p<d;p++){r=c.rows.next(q);if(!r)break;q=r}d=__c.mZa(c,{start:{column:l.ec,row:l.$b},end:{column:n,row:q}})}const t=[];d.map(G=>c.layout.cells.get(G.row,G.column)?.span||{$b:G.row,ec:G.column,
df:G.row,jf:G.column}).forEach(G=>{k.add([G.$b,G.ec]);const H=[...xk(G.$b,G.df,c.layout.rows)],K=[...xk(G.ec,G.jf,c.layout.cols)];t.push({...G,rows:H,cols:K})});l=t.map(G=>G.$b).sort((G,H)=>c.layout.rows.dj(G,H))[0];d=t.map(G=>G.df).sort((G,H)=>-c.layout.rows.dj(G,H))[0];n=t.map(G=>G.ec).sort((G,H)=>c.layout.cols.dj(G,H))[0];q=t.map(G=>G.jf).sort((G,H)=>-c.layout.cols.dj(G,H))[0];const v=__c.jZa(c,{start:{column:n,row:l},end:{column:q,row:d}}),w=c.layout.rows.filter(G=>c.layout.rows.dj(G,v.start.row)>=
0&&c.layout.rows.dj(G,v.end.row)<=0),x=c.layout.cols.filter(G=>c.layout.cols.dj(G,v.start.column)>=0&&c.layout.cols.dj(G,v.end.column)<=0);t.filter(G=>G.rows.length>1||G.cols.length>1).forEach(G=>{a.Kld(c,{row:G.$b,column:G.ec});for(const H of G.rows)for(const K of G.cols)k.add([H,K])});const y=[],z=new __c.mgg;w.forEach((G,H)=>x.forEach((K,L)=>{if(k.has([G,K])){var N=H%g.length,P=L%h.length,T=g[N],V=h[P],W=Math.floor(H/g.length)*g.length,aa=Math.floor(L/h.length)*h.length,ba=b.St.cells.zOc({left:P,
top:N,right:P,bottom:N}),da=ba.length?ba[0]:void 0;ba=da?.state;var la=da?.span?b.St.rows.filter((qa,ua)=>ua>=da.span.top&&ua<=da.span.bottom):[T],ja=da?.span?b.St.cols.filter((qa,ua)=>ua>=da.span.left&&ua<=da.span.right):[V],oa=f._attributes.get(`${ja[0].id}:${la[0].id}`);N=H-(N-f.rows.indexOf(la[0]));L-=P-f.cols.indexOf(ja[0]);P=y[N]?.[L];if(P==null)y[N]??(y[N]=[]),y[N][L]=1,z.set([G,K],{sCo:ba,rCo:oa,i5f:{$2b:W,uVb:aa}});else if(la.length!==1||ja.length!==1){P++;y[N][L]++;K=la.length;var ma=ja.length,
na=ja[ma-1];if(T===la[K-1]&&V===na&&P===K*ma){T=N+la.length;V=L+ja.length;ja=new __c.iB;for(la=N;la<T;la++)for(K=L;K<V;K++)ja.add([w[la],x[K]]);a.mergeCells(c,[...ja].map(([qa,ua])=>({row:qa,column:ua})));z.set([w[N],x[L]],{sCo:ba,rCo:oa,i5f:{$2b:W,uVb:aa}})}}}}));for(const [[G,H]]of z)c.layout.rows.has(G)||c.layout.cols.has(H)||z.delete([G,H]);const B=[],C=new Set;a.fd.Ew(G=>{for(const [K,{i5f:L,sCo:N,rCo:P}]of z){var H=N?.content;H&&(C.has(H)?H=__c.uv(H):C.add(H));H={content:H,Cb:N?.Cb,attrs:P};
const [T,V]=K,W=c.layout.cells.get(T,V)?.span||{$b:T,ec:V,df:T,jf:V};a.hmh(c,W,H,G,e);B.push({tb:{column:W.ec,row:W.$b},i5f:L})}},{n4b:()=>!0});return B};__c.Wps=function(a){const b=a.S3b;a=a.parent;switch(a?.type){case "fixed_page":return __c.hf(a.page)?a.page.title?J("bnI4AA",[a.gkb+1,a.page.title]):J("pWj8jQ",[a.gkb+1]):J("kJtLJA",[a.gkb+1,b+1]);case "responsive_page":return J("kJtLJA",[a.gkb+1,b+1]);case "body":return J("TEcZsA",[b+1]);default:throw new __c.u(a);}};
Rps=()=>{let a=0;return()=>`${a++}`};
__c.Ggg.prototype.Y2i=__c.fa(1082,function(a,b,c,d,e,f,g){if(d.length===0)return[];const h=c.layout.rows.count(),k=c.layout.cols.count();__c.ra(h>0);__c.ra(k>0);const l=c.layout.cells.get(d[0].row,d[0].column)?.span||{$b:d[0].row,ec:d[0].column,df:d[0].row,jf:d[0].column};var n=c.kL(l.$b),p=c.zL(l.ec);const q=__c.Sps(a.St);n+=q.rows.length;if(n>this.TU)return this.ma.Ib({Db:__c.M("GQzu/A"),group:__c.HNh,fO:!0}),[];p+=q.cols.length;if(p>this.wOj)return this.ma.Ib({Db:__c.M("j6vT8w"),group:__c.INh,
fO:!0}),[];if(n*p>this.tUh)return this.ma.Ib({Db:__c.M("9uT7Bw"),group:__c.JNh,fO:!0}),[];n>h&&this.addRows(c,__c.m(c.layout.rows.last()),"after",n-h,e,f);p>k&&this.bUb(c,__c.m(c.layout.cols.last()),"after",p-k,e,f);let r;r=d.length===1?Ups(this,a,c,l,g).map(x=>({tb:x,i5f:{$2b:0,uVb:0}})):Vps(this,a,c,d,g);if(r.length===0)return a=r.map(x=>x.tb),__c.Nfg(this.$xa,c,a),a;const t=r.sort((x,y)=>c.layout.rows.dj(x.tb.row,y.tb.row)||c.layout.cols.dj(x.tb.column,y.tb.column))[0];this.fd.Ew(x=>{r.forEach(({tb:y,
i5f:z})=>{var B=c.layout.cells.get(y.row,y.column);const C=B?.span||{$b:y.row,ec:y.column,df:y.row,jf:y.column};if(C.$b===y.row&&C.ec===y.column&&B?.ref.content.ref?.type==="formula"){B=B.ref.content.ref.value;switch(B.type){case "canonical":__c.sa(B.Hf.length===0);B=B.Ora;break;case "invalid":B=B.pUc;break;default:throw new __c.u(B);}B=B.trim().slice(1);B=__c.Gde(this.sE,{type:0,Ora:B})??{type:1,gna:B};b&&(z={Pt:c.kL(t.tb.row)-b.$2b+z.$2b,xT:c.zL(t.tb.column)-b.uVb+z.uVb},B=this.Nma.CVd(c,B,z));
x.faa(c,y,__c.Vge(B.gna))}})},{n4b:()=>!0});if(g?.mmd){var v=c.kL(t.tb.row),w=c.zL(t.tb.column);const x=__c.Lib.HZ(a.St.rows),y=__c.Oib.HZ(a.St.cols);this.fd.Ew(z=>{r.forEach(({tb:B,i5f:C})=>{__c.Tps(c,B)&&this.Kld(c,B);var G=c.layout.cells.get(B.row,B.column),H=G?.span||{$b:B.row,ec:B.column,df:B.row,jf:B.column};if(H.$b===B.row&&H.ec===B.column&&G?.ref.content?.ref)switch(G.ref.content.ref.type){case "formula":var K=c.kL(H.$b);H=c.zL(H.ec);C=`${y[Math.abs(w-H)-C.uVb].id}:${x[Math.abs(v-K)-C.$2b].id}`;
C=b?.WJe?.get(C);if(C!=null)z.RIa(c,B,C);else switch(G=this.Mma.evaluate(c,G.ref.content.ref.value),G.type){case 0:z.faa(c,B,{type:1,value:G.value});break;case 2:z.RIa(c,B,G.value);break;case 1:z.faa(c,B,__c.Uge(G.value));break;case 16:break;case 4:case 3:case 15:z.JEb(c,B,void 0);break;default:throw new __c.u(G);}break;case "text2":z.RIa(c,B,G.ref.content.ref.value.Ya);break;case "text3":let L="";G.ref.content.ref.value.forEach({Ya:N=>L+=N,item:()=>{}});z.RIa(c,B,L);break;case "number":case "boolean":case "plaintext":case "media":case "mention":case "embed":break;
default:throw new __c.u(G.ref.content.ref);}})},{n4b:()=>!0})}a=r.map(x=>x.tb);__c.Nfg(this.$xa,c,a);return a});
__c.Ggg.prototype.hmh=__c.fa(1080,function(a,b,c,d,e){var f=!e?.THg,g=!e?.mmd;if(a.layout.cells.get(b.$b,b.ec)?.ref){var h=this.cYc(c?.Cb);f&&d.JEb(a,{column:b.ec,row:b.$b},c?.content);d.m2(a,{column:b.ec,row:b.$b},h)}else if(c?.content||c?.Cb)f=f?c.content:void 0,h=this.cYc(c?.Cb),d.JEb(a,{column:b.ec,row:b.$b},f),d.m2(a,{column:b.ec,row:b.$b},h);g&&(g=a.layout.attrs.get(Ee.ht,b.$b,b.ec)||{},(c=c?.attrs)&&e?.THg&&delete c.link,e={...__c.ie(Ee,g,()=>{}),...c},d.setAttributes(a,{column:b.ec,row:b.$b},
e))});__c.Ggg.prototype.Kld=__c.fa(1079,function(a,b){__c.ra(__c.Tps(a,b));if(b=a.layout.cells.get(b.row,b.column)){var c=b.span,d=__c.ogg(a.layout.attrs.get(Ee.ht,c.$b,c.ec)||{}),e=[],f=xk(c.$b,c.df,a.layout.rows),g=xk(c.ec,c.jf,a.layout.cols);for(const h of f)for(const k of g)a.layout.cells.set({ec:k,$b:h,jf:k,df:h},h===c.$b&&k===c.ec?__c.jgg(this,a,b?.ref,{EPb:!0,sIa:!0}):__c.jgg(this,a,b?.ref)),a.layout.attrs.set(Ee.ht,{ec:k,$b:h},d||{}),e.push({row:h,column:k});__c.Nfg(this.$xa,a,e)}});__c.Xps=class{zid(){const a=new __c.elh;a.YT(this.document);return a.sheets}constructor(a){this.document=a}};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/f7923429ab6622c0.js.map