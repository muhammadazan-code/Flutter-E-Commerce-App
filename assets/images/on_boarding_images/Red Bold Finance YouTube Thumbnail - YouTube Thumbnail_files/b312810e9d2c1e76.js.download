(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[52357],{

/***/ 881860:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(804092);__web_req__(764820);__web_req__(413311);__web_req__(420124);__web_req__(184626);__web_req__(596972);__web_req__(487513);__web_req__(423901);__web_req__(585586);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var m=__c.m;var WFl;var SFl,YFl;SFl=function(a,b){if(a!=null&&b!=null&&b>=a)return b-a};__c.TFl=function({Qb:{status:a}}){return a===3};__c.UFl=function({Qb:{status:a,sT:b}}){return b===1||a===1};__c.VFl=function({Qb:{sT:a}}){return a===2};
__c.$Fl=async function(a,b,c,d,e){b=new __c.Ss(b?.type==="folder"?b:{id:b?.id});c=new WFl({Ba:b,item:new __c.$s({id:c.id,type:3})});b.Xh?a.qqf(new __c.XFl({e4c:!0,body:c,brand:b.Xh.brand,type:__c.Tgj(b.Xh.type),user:m(b.Xh.user)})):d?await YFl(a,e,b.id)&&a.JAe(new ZFl({body:c,Ba:m(b.id),e4c:!0})):a.JAe(new ZFl({body:c,Ba:m(b.id),e4c:!0}))};YFl=async function(a,b,c){let d=b.get(c);d||(d=a.rN(new __c.Tgk({Ba:c})),b.set(c,d));try{const {Ba:e}=await d;return e.defaultView!==3}catch{return!0}};
WFl=__c.WFl=__c.F(()=>({Ba:__c.D(1,__c.Ss),item:__c.D(2,__c.$s)}));__c.Li.prototype.JAe=__c.fa(284,async function(a){__c.ra(a.Ba!=null&&/^[a-zA-Z0-9_-]{11}$/.test(a.Ba));var b=__c.gh([__c.dt,a.Ba]);__c.eh(b,{createPendingItems:m(a.e4c)});b=__c.ih(b);const [c,{$hj:d}]=await Promise.all([this.Da.post(b,WFl.serialize(a.body),{Sa:"creatependingfolderitemapi"}),__webpack_require__.me(15713).then(()=>({$hj:__c.aGl}))]);return d.deserialize(c)});
__c.Li.prototype.qqf=__c.fa(277,async function(a){__c.ra(a.brand!=null&&/^[a-zA-Z0-9_-]{11}$/.test(a.brand));__c.ra(a.user!=null&&/^[a-zA-Z0-9_-]{11}$/.test(a.user));__c.ra(a.type!=null&&/^[^/]+$/.test(a.type));var b=__c.gh([__c.dt,"~"+a.brand,"system",a.user,a.type]);__c.eh(b,{createPendingItems:m(a.e4c)});b=__c.ih(b);const [c,{$hj:d}]=await Promise.all([this.Da.post(b,WFl.serialize(a.body),{Sa:"creatependingsystemfolderitemapi"}),__webpack_require__.me(15713).then(()=>({$hj:__c.aGl}))]);return d.deserialize(c)});
__c.XFl=__c.F(()=>({brand:__c.S(1),user:__c.S(2),type:__c.S(3),e4c:__c.X(4),body:__c.D(5,WFl)}));var ZFl=__c.F(()=>({Ba:__c.S(1),e4c:__c.X(2),body:__c.D(3,WFl)}));__c.bGl=class{get ZAk(){return SFl(this.events.get("upload_started"),this.events.get("initialization_finished"))}get Aek(){return SFl(this.events.get("file_upload_started"),this.events.get("file_upload_finished"))}get dzk(){return SFl(this.events.get("file_upload_finished"),this.events.get("upload_finished"))}Il(a,b){this.finished||(this.events.set(a,this.Sb.now()),this.span&&this.span.addEvent(a,b))}WBs(a){this.finished||(this.yAh==null&&(this.yAh=[]),this.yAh.push(a))}VPi(a){this.finished||(this.ipg==
null&&(this.ipg=[]),this.ipg.push(a))}finish(a){this.finished=!0;this.events.set("upload_finished",this.Sb.now());this.span&&this.span.end(a.success?"ok":"error")}constructor(a){this.span=a;this.Sb=__c.Tb;this.finished=!1;this.events=new Map([["upload_started",__c.Tb.now()]])}};__c.cGl=a=>{a=(new TextEncoder).encode(a);a=String.fromCodePoint(...a);return btoa(a)};__c.dGl=class{static KHf({Qb:{sT:a}}){return a===3}async E2(a,b={}){const {K6:c,Kt:d=!0,Cab:e,aVe:f,H9a:g,HJ:h}=b,k=this.V&&b.va?this.V.startSpan("upload_media_file",b.va):void 0,l=new __c.bGl(k);let n;if(b.media)n=b.media;else try{n=await this.sc.Hgb(new __c.Vei({fileSize:a.content.size,H9a:g,body:new __c.Edd({QC:a.name,Bo:!0,Kt:d,Cab:e,Au:f?.Au,cvd:f?.cvd,accessToken:f?.accessToken,appId:f?.appId})}),{va:k}),l.Il("resource_created")}catch(p){throw l.finish({success:!1}),p;}if(c){if(!this.Zd)throw Error("Tried to upload to a folder, but the folder-service is not present");
__c.$Fl(this.Zd,c,n,this.Czb,this.vzf)}b=new __c.h8e(new __c.lt({...n,QC:a.name}),{rjg:g,upload:p=>this.upload(p,n,a,l,g,k),retry:(p,q)=>this.retry(p,q,g),metrics:l,Kt:d,HJ:h});b.l4();l.Il("initialization_finished");return b}poll(a,b,c,d){const e=new __c.bz({id:b.id,version:b.Qb.version,projection:__c.hm([8,14,2]),J3:[4,5,6,7,8],H9a:d});let f=b;const g=a.metrics;__c.e8e(a,async()=>{f=await this.sc.Fqb(e,{va:c});return __c.UFl(f)?"pending":__c.TFl(f)&&__c.dGl.KHf(f)?"success":__c.VFl(f)?"failure":
"unknown"},h=>{h==="pending"?a.l4(f):h==="success"?(g?.finish({success:!0}),a.finish(f)):h==="failure"&&(g?.finish({success:!1}),f.Qb.Hli===1&&(a.error=new __c.cNg("upload failed, image resolution too high")))},{Sb:this.Sb})}async upload(a,b,c,d,e,f){d.Il("file_upload_started");try{const g=new __c.RFl({mediaId:b.id,M0g:b.Qb.version,VDg:__c.cGl(c.name),H9a:e});await this.QKa.upload({backend:"media",file:c,strategy:0,metadata:g,va:f,Jka:h=>{h.lengthComputable?a.Hmb(h.loaded/h.total):a.l4()}});d.Il("file_upload_finished");
a.l4(b);this.poll(a,b,f,e)}catch(g){d.finish({success:!1}),this.errorService?.error(g),a.error=new __c.dNg(g,g instanceof __c.QFl?g.httpStatusCode:void 0)}}async retry(a,b,c){b instanceof __c.b8e?this.poll(a,a.media,void 0,c):a.start();await a.finished}constructor(a,b,c,d,e,f,g=__c.Tb){this.sc=a;this.QKa=b;this.Zd=c;this.errorService=d;this.V=e;this.Czb=f;this.Sb=g;this.vzf=new Map}};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/b312810e9d2c1e76.js.map