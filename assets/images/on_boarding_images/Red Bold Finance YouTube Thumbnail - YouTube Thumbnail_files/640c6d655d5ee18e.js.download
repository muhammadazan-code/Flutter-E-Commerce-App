(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[65396],{

/***/ 281161:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(764820);__web_req__(390611);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var zf=__c.zf;var ra=__c.ra;var jm=__c.jm;var sa=__c.sa;var Be=__c.Be;var ae=__c.ae;var Fg=__c.Fg;var md=__c.md;var $h=__c.$h;var u=__c.u;var Oj=__c.Oj;var Gw=__c.Gw;var m=__c.m;var sb=__c.sb;var Ae=__c.Ae;var Avw,Bvw,Dvw,Evw,Fvw,Gvw,Hvw,Ivw,Jvw,Kvw,Nvw,Ovw,Mvw,Pvw,Qvw,Tvw,Vvw,Wvw,Xvw,Yvw,Zvw,$vw,bww,dww,eww,aww,fww,gww,hww,iww,kww,jww,qww,lww,mww,tww,vww,zww,Aww,www,xww,yww,Bww,Cww,Dww,Eww,Fww,uww,Hww,Iww,Jww,Kww,Lww,Mww,Pww,Rww,Oww,Nww,Qww,Sww,Uww,Tww,Vww,Www,Xww,Yww,dxw,exw,fxw,sww;
Avw=function(a,b,c){const d=__c.du(__c.Ul,c).get(b);return d?a.X6p(b,d,c):[]};Bvw=function(a){let b=0;for(const {length:c}of a.values())b+=c;return b};Dvw=function(a){const b=new Cvw;b.mNa(a);return b.gRa};Evw=function(a){const b=new Cvw;b.okc(a);return b.Sc};Fvw=function(a){const b=new Cvw;b.Emd(a);return b.Sc};Gvw=function(a){const b=new Cvw;b.uef(a);return b.gRa};Hvw=function(a,b){return b.pages.flatMap(c=>c.elements.flatMap(d=>a.p3c(d)))};
Ivw=function(a){const b=[];a.forEach({item:()=>{},Ya:(c,d,e)=>{c!=="\n"&&(c=e.fontFamily||Ae.Nf.fontFamily,e=e.fontSize,c&&e&&(c=__c.dj(c).id,b.push({fontSize:e,fontFamily:c})))}});return b};Jvw=function(a){return __c.Wj(a)?({Suc:a}=__c.Xj(a),[a.text]):Cvw.WYf(a)};Kvw=function(a,b,c){const d={};Jvw(b).forEach(e=>{a.n7p(e,d,b,c)});return Object.values(d)};__c.Lvw=function(a,b,c){const d={};Evw(b).forEach(e=>{a.gvm(e,d);c!=null&&a.cvm(e,d,c)});return d};
Nvw=function(a,b){const c=[];Gvw(b).forEach(d=>{d=Mvw(a,d);c.push(...d)});return c};Ovw=function(a,b){const c=new Map;b.cells.forEach((d,e)=>{c.set(e,Nvw(a,d))});return c};Mvw=function(a,b){const c=[];b.forEach({item:()=>{},Ya:(d,e,f)=>{d!=="\n"&&c.push(a.jvm(f))}});return c};Pvw=function(a,b,c){(__c.Mne(b)||__c.yne(b)||__c.Iw(b))&&b.gb&&(a=a*b.width/b.gb);c!=null&&(a=a*c.width/c.gb);return Math.trunc(a*1E3)/1E3};
Qvw=function(a,b){const c=/^\s+$/.test(b);b=b.endsWith("\n");c&&!a.nvj?a.Gse=!1:c||b?(a.nvj=!1,a.Gse=!0):(a.nvj=!0,a.Gse=!1)};__c.Rvw=function(a,b,c){const d={type:"computed_range",context:b,iE:c};a=a.flatMap(e=>e.GYa?.(d)).filter(sb);return{nf:d,DL:a,children:[]}};
__c.Svw=function(a,b,c){const d={type:"item",item:c,context:b},e=a.flatMap(f=>f.GYa?.(d)).filter(sb);if(d.type==="item"&&c.type==="table"){b=__c.T_a(c);const f=__c.Ek(c);b.map((g,h)=>{g.map((k,l)=>{k=m(k&&c.cells.get(k.BG));const n=f.get(k);if(!n||n.rows[0]===h&&n.columns[0]===l){var p={...d,inner:{type:"table",tb:k}};l=a.flatMap(q=>q.GYa?.(p)).filter(sb);e.push(...l)}})})}return{nf:d,DL:e,children:[]}};__c.Uvw=function(a){return Tvw(a).flatMap(b=>b.DL)};
Tvw=function(a){return a.children.length===0?[a]:[a,...a.children.flatMap(b=>Tvw(b))]};Vvw=function(a,b,c){const d=a.options.Za,e=__c.Qk.qd();let f=0,g=!1,h=!1;__c.Qk.snapshot(b).forEach({item:()=>{},Ya:(k,l,n)=>{if(h||!g){var p=Gw.of({index:f,length:k.length});({aHe:p}=d.$oa(b,p,c));if(h=p)e.attrs({...n,...l}).Xb(k),g=!0;f+=k.length}}});return __c.Qk.create(e.build())};Wvw=function(a,b,c,d){const e=a.options.Za;e.IW(()=>{e.rub(b.text,c,[d])});a.qyd()};
Xvw=function(a,b,c){const d=a.options.Za;d.IW(()=>{d.qv(b.text,c.range)});a.qyd()};Yvw=function(a){const b=Oj(a).Ah().map(c=>`${Math.round(c.x)},${Math.round(c.y)}`).join("_");return`insufficient_link_visibility_${a.type}_${b}`};Zvw=function(a){return __c.MA(a)?__c.Wg.fvd(a.gradient):a.Nq};$vw=function(a,b){return b.filter(c=>!__c.iw(c)).some(c=>!__c.mw(c,a.que))};bww=function(a,b,c){b=b.Gl.find(d=>!__c.mw(d,a.que));return aww(a,b,c)||a.BGj[0]};
dww=function(a,b){const c=b.element;b=b.context;var d=["textCharacter","textBackground","textEffect"];const e=["fill","border"],f=Cvw.WYf(c).some(g=>!g.isEmpty);[4,5].some(g=>a.props.kU?.Dsc(c,g))||e.push("imageVector");d=c.type==="chart"?d:[...(f?d:[]),...e];return a.props.ik?.Cqb(c,b,d)??cww};
eww=function(a,b){switch(a){case "border":return b.border;case "fill":return b.fill;case "textCharacter":return b.A2;case "textBackground":return b.lXa;case "textEffect":return b.b4;case "imageVector":return b.r_a;case "imageRaster":return b.q_a;default:throw new u(a);}};
aww=function(a,b,c){if(b){if(c){var d=a.$Nj.get(`${b}-${c}`);if(d)return d}d=-Infinity;var e=$h(b),f=c?$h(c):void 0;for(const l of a.BGj){var g=$h(l),h=__c.lj(e,g,3);g=f?__c.mj(g,f):21;h=1-h/100;if(g>1.2&&h>d){d=h;var k=l}}k&&c&&a.$Nj.set(`${b}-${c}`,k);return k}};
fww=function({category:a,EBs:b,Yms:c}){const d=md(b.fill.flatMap(h=>h.Gl)),e=d.length===1,f=e&&d[0]===void 0;b=md(b.border.flatMap(h=>h.Gl));const g=b.length===1;switch(a){case "border":a=c;break;case "fill":a=g?b[0]:void 0;break;case "textCharacter":case "textBackground":case "textEffect":a=f?c:e?d[0]:void 0;break;default:a=void 0}return a};
gww=function(a){const b=new Set;Evw(a).forEach(c=>{Fg.snapshot(c).forEach({...ae,Ya:(d,e,f)=>{c.charLength!==1&&d.includes("\n")&&b.add(f["font-family"]||Be.Nf["font-family"])}})});return b};hww=function(a){const b=a.Omm||a.rmm||a.ANh[0];if(b&&b.fontFamily)return a.Vb?.LL(b.fontFamily)};
iww=function(a,b){const c=new Set;if(a.content.ref?.type==="media")return c;a.content.ref?.type!=="text2"&&a.content.ref?.value!==void 0&&c.add(b);Fvw(a).forEach(d=>{Fg.snapshot(d).forEach({...ae,Ya:(e,f,g)=>{d.charLength!==1&&e.includes("\n")&&c.add(g["font-family"]||Be.Nf["font-family"])}})});return c};kww=function(a){a.L_a||(a.L_a=!0,Promise.resolve().then(()=>jww(a)))};
jww=function(a){a.Jqg?.cancel();a.Jqg=void 0;const b=new Set,c=lww(a.compute,e=>{const [f,g]=mww(e,()=>{a.Jqg===c&&kww(a)});a.Fig.push(g);b.add(g);return f}),d=(e,f)=>{a.NXg={value:e,error:f};a.UI.reportChanged();a.Fig.forEach(g=>!b.has(g)&&g());a.Fig=[...b]};c.then(e=>!(e instanceof nww)&&d(e),e=>d(void 0,e));a.Jqg=c;a.L_a=!1};
qww=function(a){const b={next:new Map};return(...c)=>{let d=b;for(const e of c)d.next.has(e)||d.next.set(e,{value:e,next:new Map}),d=d.next.get(e);d.call==null&&(d.call=new oww(()=>a(...c)),pww(d.call.UI,()=>{for(d.call=void 0;d.call==null&&d.next.size===0&&d.parent;)d.parent.next.delete(d.value),d=d.parent}));return d.call.get()}};
lww=function(a,b=c=>c()){let c;const d=__c.Cb(),e=a();a=(async()=>{let f=()=>e.next();for(;;){if(c){try{e.throw(c)}catch(h){}e.return(void 0);return c}const g=b(f);if(g.done)return g.value;try{const h=await Promise.race([g.value,d.promise]);if(c==null||h!==c)f=()=>e.next(h)}catch(h){f=()=>e.throw(h)}}})();a.cancel=()=>{c=new nww;d.resolve(c)};return a};mww=function(a,b){a=rww(a);if(a.trackAndCompute==null)throw Error();const c=sww(a),d=a.get();a.trackAndCompute=()=>{b();return!1};return[d,c]};
tww=function(a){const b=[];a.elements.forEach(c=>{__c.Iw(c)||c.type==="line"||__c.Gne(c)||__c.yne(c)||__c.Mne(c)?b.push({element:c}):__c.Hw(c)&&c.pb.forEach(d=>{(__c.Iw(d)||d.type==="line"||__c.Gne(d)||__c.yne(d)||__c.Mne(d))&&b.push({element:d,group:c})})});return b};vww=function(a,b){return Math.min(...b.map(c=>uww(a,c)))};
zww=function(a,b,c,d,e,f,g,h,k,l,n,p,q,r,t){const v=n.page;b.cells.forEach(w=>{const x=Avw(d,w,b),y=C=>www(a,{cjl:x,left:e,top:f,Hkl:g,RF:C,Hjm:void 0,scale:h,za:k});var z=r.g7p(w);const B=y(z);xww(B,q)||(w={type:"element",page:c,element:b,context:c,inner:{type:"table",tb:w}},z={id:`insufficient_text_contrast_table_${B[0][0]}`,rule:a.id,nf:w,czd:()=>{const C=l.Pmg(v,p),G=l.Kmf(v);return yww(a,C,G,q,y)},zud:md(z),$Qd:a.kCb(w)},t.push(z))})};
Aww=function(a,b,c,d,e,f,g,h,k,l,n,p,q,r,t,v){const w=__c.jde(d,b,v);d=r.h7p(b);let x,y=B=>www(a,{cjl:w,left:e,top:f,Hkl:g,RF:B,Hjm:x,scale:h,za:k});const z=n.page;if(b.hl.ref){let B=!1;b.hl.ref.Lc.forEach(C=>{if(!B){var G=C.type;switch(G){case "background":const {color:H,transparency:K}=__c.ko(C.parameters,__c.z2d.Lc[0].parameters);K===1?y=L=>Array.isArray(L)?L.map(N=>[a.Jmd(N,k,H).Ipf]):[[a.Jmd(L,k,H).Ipf]]:x=$h(H).y8a(K);break;case "lift":({intensity:C}=__c.ko(C.parameters,__c.s2d.Lc[0].parameters));
C=__c.ZVb(.05,.1,C);x=new __c.fi(0,0,0,C);break;case "curved":case "hollow":break;case "echo":case "glitch":case "neon":case "outline":case "shadow":case "splice":B=!0;break;default:throw new u(G);}}});if(B)return}n=y([...d.filter(B=>typeof B==="string")]);xww(n,q)||(b={type:"element",page:c,element:b,context:v?c.Me(v):c,parent:v},t.push({id:`insufficient_text_contrast_text_${n[0][0]}`,rule:a.id,nf:b,czd:()=>{const B=l.Pmg(z,p),C=l.Kmf(z);return yww(a,B,C,q,y)},zud:md(d),$Qd:a.kCb(b)}))};
www=function(a,{cjl:b,left:c,top:d,Hkl:e,RF:f,Hjm:g,scale:h=1,za:k=0,sampleCount:l=50}){return b.map((n,p)=>{if(n!=null&&(n=__c.Nj(n).scale(h).translate(-c,-d).Nb(),n=__c.wpe(e,l,0,Oj({top:Math.floor(n.top),left:Math.floor(n.left),width:Math.ceil(n.width),height:Math.ceil(n.height)})),n.length)){var q=Array.isArray(f)?f[p]:f;return n.map(r=>{r=g?__c.VVa(g,r).hD():r.hD();return a.Jmd(q,k,r).Ipf})}}).filter(sb)};
xww=function(a,b){let c=4.5;b>=18&&(c=3);return!a.find(d=>d.filter(e=>e<c).length>d.length*.25)};yww=function(a,b,c,d,e){sa(!a.options.Ka);return md(a.options.Xsd.hVh(b,c,10).concat(a.Bc.IP?[]:["#ffffff","#000000"]).filter(f=>{f=e(f);return f.length?xww(f,d):!1}))};
Bww=function(a,b){const c=a.options.eFa;a=a.Bc.IP&&a.Bc.Nc!=null?a.Bc.Nc.content.Pr.flatMap(e=>e.ta.map(({Nq:f})=>f?__c.Ev(f):void 0)).filter(sb):[];const d=new Set(a.length>0?a:["#ffffff","#000000"]);b.text.forEach({item:e=>{switch(e.type){case "chart":d.add(c.sWh(e).color);break;case "table":Ovw(c,e).forEach(f=>f.forEach(g=>d.add(g.color)))}},Ya:(e,f,g)=>{d.add(g.color||Ae.Nf.color)}});return d};
Cww=function(a){const b=[],c=a.color,d=a.fontSize;a=a.fontWeight;const e=d.size===1?[...d][0]:18*__c.Wt,f=a.size===1?[...a][0]:"bold";c.forEach(g=>{b.push({color:g,fontSize:e,fontWeight:f,fontFamily:""})});return b};Dww=function(a,b,c){const d=[];for(const e of b)b=a.Jmd(e.color,0,c).Ipf,(uww(a,e)>=18?b>=3:b>=4.5)||d.push(e.color);return d};Eww=function(a){return md(a.map(({color:b})=>b))};Fww=function(a,b,c){return[...a].filter(d=>c(d,b)).slice(0,12)};
uww=function(a,{fontSize:b,fontWeight:c}){b=m(b);a=a.Z6(c)?b*18/14:b;return __c.co(a*.75)};__c.Gww=function(a){a=a.Hc.first();return a==null?!0:__c.MVa(a)};Hww=function(a){switch(a.type){case "fixed":return a.elements.empty&&!__c.hf(a);default:return __c.JVa(a)}};
Iww=function(a,b){const c=a.options.Za,d=b.context,e=b.iE,f=[];let g=0,h=!1,k=!1,l;__c.Qk.snapshot(d.text).forEach({item:()=>{},Ya:(n,p,q)=>{if(k||!h)p=Gw.of({index:g,length:n.length}),{aHe:p}=c.$oa(d.text,p,e.range),p&&(q.link&&q.link!==l&&f.push(q.link),l=q.link,h=!0),k=p,g+=n.length}});return f};Jww=function(a){const b=Oj(a).Ah().map(c=>`${Math.round(c.x)},${Math.round(c.y)}`).join("_");return`no_links_${a.type}_${b}`};Kww=function(a,b){a.links=[];a.YJ(Fg.snapshot(b));return a.links.length>0};
Lww=function(a,b){a.links=[];a.L5b(__c.wMb.snapshot(b));return a.links.length>0};Mww=function(a,b){a.links=[];a.ldj(__c.UUc.snapshot(b));return a.links.length>0};Pww=function(a,b){return Nww(b).filter(c=>(c=a.Qa.gp(c.media))&&c.kc===3).map(c=>({id:Oww(b,c.media.toString()),rule:a.id,nf:b}))};Rww=function(a,b){return Qww(b).filter(c=>(c=a.dc.get(c.video))&&c.kc===3).map(c=>({id:Oww(b,c.video),rule:a.id,nf:b}))};
Oww=function(a,b){switch(a.type){case "fixed_page":return"no_pro_elements";case "element":return`no_pro_elements_${a.element.type}_${b}`;case "item":return`no_pro_elements_${a.item.type}_${b}`;case "table_cell":return`no_pro_elements_cell_${b}`;default:throw new u(a);}};Nww=function(a){return Sww(a).map(b=>b.image.ref).filter(sb)};Qww=function(a){return Sww(a).map(b=>b.video.ref).filter(sb)};
Sww=function(a){switch(a.type){case "fixed_page":return a=a.page.Hc.toArray(),a.length===0?[]:a;case "element":return a.element.type==="group"?[]:__c.au.JO(a.element);case "item":return __c.au.yXa(a.item);case "table_cell":return Array.from(a.tableCell.content.text.items.values()).flatMap(__c.au.yXa);default:throw new u(a);}};Uww=function(a,b){return[...b].find(c=>!Tww(a,c))};Tww=function(a,b){return __c.co(b*.75)>=a.options.config.lJ};
Vww=function(a,b,c,d){const e=a.options.Za;e.IW(()=>{e.rub(b.text,c,[d])});a.qyd()};Www=function(a,b,c){const d=a.options.Za;d.IW(()=>{d.Nw(b.text,c)});a.qyd()};Xww=function(a,b,c){const d=a.options.Za;d.IW(()=>{d.qv(b.text,c.range)});a.qyd();d.deselectAll()};
Yww=function(a,b,c){const d=a.createContext(b.width,b.height);let e=!1;c.forEach(f=>{const g=f.ref;f=f.box;if(g.fill.gradient.ref&&f){e=!0;var {top:h,left:k,width:l,height:n}=f.Nb();d.fillStyle=__c.GIg(d,g.fill.gradient.ref,f);d.fillRect(k,h,l,n)}});return e?d.getImageData(0,0,b.width,b.height):void 0};__c.cxw=function({pd:a,mr:b,document:c,Za:d,zZ:e,Qa:f,dc:g}){const h=new __c.Zww;a=new $ww(a,b,h,f,g,d,e);return{BKb:new axw(c,a,d),Wyb:new bxw(a,d)}};dxw=__webpack_require__(536618);exw=dxw.Aj;
fxw=dxw.iB;sww=dxw.Z8;var gxw=__webpack_require__(882262).v3;var hxw=__webpack_require__(186901),rww=hxw.EW,ixw=hxw.mJ,jxw=hxw.MN,pww=hxw.q$,kxw=hxw.sH,lxw=hxw.Tx,s_=hxw.XI,mxw=hxw.z7;var Cvw=class extends jm{static WYf(a){const b=new Cvw;b.At(a);return b.Sc}YJ(a){this.Sc.push(a)}U7(a){this.gRa.push(a)}constructor(...a){super(...a);this.Sc=[];this.gRa=[]}};__c.Zww=class{p3c(a){switch(a.type){case "chart":case "text":case "table":case "shape":case "line":return this.f7p(a);default:return[]}}iYd(a){switch(a.type){case "chart":return this.sWh(a);case "design":return Hvw(this,a);case "table":return a=Dvw(a).flatMap(b=>Ivw(b)),md(a,b=>[b.fontFamily,b.fontSize].join());default:return[]}}sWh(a){const b=a.Ae.fontFamily||Ae.Nf.fontFamily;return(a=a.Ae.fontSize)?[{fontFamily:b,fontSize:a}]:[]}evm(a){return Ivw(a.text)}constructor(){this.f7p=fxw(a=>{const b=[];
Cvw.WYf(a).forEach(c=>{Fg.snapshot(c).forEach({...ae,Ya:(d,e,f)=>{d!=="\n"&&(d=f["font-family"]||Be.Nf["font-family"],f=f["font-size"],d&&f&&(a.type!=="chart"&&a.type!=="table"&&a.type!=="text"||!a.gb||(f=f*a.width/a.gb),f=Math.round(f*1E3)/1E3,d=__c.dj(d).id,b.push({fontSize:f,fontFamily:d})))}})});return md(b,c=>[c.fontFamily,c.fontSize].join())})}};var oxw,pxw,qxw;__c.nxw="style font-weight font-style decoration color font-family font-size text-transform".split(" ");oxw=["scaled-font-size"];pxw=["font-family","font-size","text-transform","scaled-font-size"];
__c.rxw=class{p3c(a,b){const c={};Jvw(a).forEach(d=>{this.gvm(d,c);this.cvm(d,c,a,b)});return c}sWh(a){return this.jvm(a.Ae)}constructor(){this.n7p=(a,b,c,d)=>{Fg.snapshot(a).forEach({...ae,Ya:(e,f,g)=>{e!=="\n"&&(e=__c.nxw.reduce((h,k)=>{const l=this.ivm(k,g[k]);return l!=null?{...h,[k]:l}:h},{}),e["scaled-font-size"]=Pvw(e["font-size"]||Be.Nf["font-size"],c,d),f=gxw(JSON.stringify(e),12345),b[f]=e)}})};this.gvm=(a,b)=>{a=Fg.snapshot(a);const c=new qxw;a.forEach({...ae,Ya:(d,e,f)=>{Qvw(c,d);(d!==
"\n"||c.Gse)&&__c.nxw.forEach(g=>{var h=pxw.find(l=>l===g);if(c.Gse||!h){h=b[g]||new Set;b[g]=h;var k=this.ivm(g,f[g]);k!=null&&h.add(k)}})}})};this.cvm=(a,b,c,d)=>{a=Fg.snapshot(a);const e=new qxw;a.forEach({...ae,Ya:(f,g,h)=>{Qvw(e,f);(f!=="\n"||e.Gse)&&oxw.forEach(k=>{var l=pxw.find(p=>p===k);if(e.Gse||!l){l=b[k]||new Set;b[k]=l;switch(k){case "scaled-font-size":var n=Pvw(h["font-size"]||Be.Nf["font-size"],c,d);break;default:return new u(k)}n&&l.add(n)}})}})};this.ivm=(a,b)=>{switch(a){case "font-size":b!=
null?(sa(typeof b==="number"),b=Math.trunc(b*1E3)/1E3):b=Be.Nf["font-size"];break;case "font-family":b=b||Be.Nf["font-family"];break;case "color":b=b||Be.Nf.color;break;case "font-weight":b=b||Be.Nf["font-weight"]}return b};this.jvm=a=>({...a,color:a.color??Ae.Nf.color,fontFamily:a.fontFamily??Ae.Nf.fontFamily,fontSize:a.fontSize??Ae.Nf.fontSize})}};qxw=class{constructor(){this.Gse=this.nvj=!1}};var bxw=class{qmk(a){const b=__c.yf(),c=this.vQb.KAe(a);return(void 0).Nl.map(d=>this.YSe(c,b,__c.vf(b,d))).map(__c.Uvw)}F4m(){throw Error("getPageDiagnostics is not supported in ResponsiveDesignLinterActions");}Qzm(){throw Error("createAsyncGetPageDiagnostics is not supported in ResponsiveDesignLinterActions");}YSe(a,b,c){const d={type:"body",body:c.body,context:b};b=this.Za.YJb(c.text,Gw.hTc(Gw.all()));return{nf:d,DL:a.flatMap(e=>e.GYa?.(d)).filter(sb),children:this.ubd(a,c,b)}}ubd(a,b,c){const d=
[];c.map(e=>e).forEach(e=>{e.DUa?d.push(__c.Rvw(a,b,e)):e.oB&&d.push(__c.Svw(a,b,e.oB))});return d}constructor(a,b){this.vQb=a;this.Za=b}};var sxw=class{static G(a){__c.O(a,{rules:kxw.ref,wRb:s_,Sug:s_.bound,z4h:rww,DL:rww,nYg:rww})}get Tbn(){return!0}wRb(a){this.k$d?.();this.rules=this.vQb.KAe(a);const b=this.rules.map(c=>c.init?.()).filter(sb);this.k$d=()=>{b.forEach(c=>c());this.Sug()}}Mic(){this.k$d?.();this.k$d=void 0}Sug(){this.rules=[]}get z4h(){if(this.document.Ka==="fixed"){const b={type:"fixed_document",document:this.document};return this.rules.flatMap(c=>c.hN?.(b)).filter(sb)}const a={type:"responsive_document",document:this.document};
return this.rules.flatMap(b=>b.GYa?.(a)).filter(sb)}get DL(){return this.nYg.map(__c.Uvw)}get nYg(){return this.document.Ka==="fixed"?this.document.pages.filter(a=>a.type==="responsive").map(this.vbd):this.document.Nl.map(this.YSe)}constructor(a,b,c){this.document=a;this.vQb=b;this.Za=c;this.k$d=(sxw.G(this),void 0);this.rules=[];this.YSe=exw(d=>{sa(this.document.Ka==="responsive");const e=__c.yf(this.document),f={type:"body",body:d,context:e},g=this.Za.YJb(d.text,Gw.hTc(Gw.all()));return{nf:f,DL:this.rules.flatMap(h=>
h.GYa?.(f)).filter(sb),children:this.ubd(__c.vf(e,d),g)}});this.vbd=exw(d=>{ra(this.document.Ka==="fixed");const e=zf(this.document),f={type:"responsive_page",body:d,context:e},g=this.Za.YJb(d.text,Gw.hTc(Gw.all()));return{nf:f,DL:this.rules.flatMap(h=>h.GYa?.(f)).filter(sb),children:this.ubd(e.xb(d),g)}});this.ubd=fxw((d,e)=>{const f=[];e.map(g=>g).forEach(g=>{g.DUa?f.push(this.eMk(d,g)):g.oB&&f.push(this.fMk(d,g.oB))});return f},{equals:(d,e)=>d.length!==e.length?!1:!d.find((f,g)=>{const h=e[g];
g=h.nf;const k=f.nf;if(k.type!==g.type||f.DL.length!==h.DL.length)return!0;if(k.type==="computed_range"&&g.type==="computed_range"){const {equals:l}=this.Za.$oa(g.context.text,k.iE.range,g.iE.range);if(!l)return!0}return k.type==="item"&&g.type==="item"&&k.item!==g.item?!0:f.DL.find((l,n)=>{n=h.DL[n];return l.nf.type==="item"&&n.nf.type==="item"&&l.nf.inner?.item!==n.nf.inner?.item?!0:n.id!==l.id})})});this.eMk=fxw((d,e)=>__c.Rvw(this.rules,d,e));this.fMk=fxw((d,e)=>__c.Svw(this.rules,d,e))}};var axw=class{create(){return new sxw(this.document,this.vQb,this.Za)}constructor(a,b,c){this.document=a;this.vQb=b;this.Za=c}};var txw,uxw;txw="chart embed grid line rect shape".split(" ");uxw=["chart","design","embed","rect","table"];
__c.vxw=class{hN(a){return a.type!=="element"||a.parent||!txw.includes(a.element.type)?[]:this.zZ.Q5h.getAll(a.element,a.context,a.page.ia).filter(b=>b.text==null).map(b=>({id:`alt_text_${a.element.type}`,rule:this.id,eAj:b,nf:{...a,inner:b.inner}}))}GYa(a){if(a.type!=="item"||!uxw.includes(a.item.type))return[];const b=a.item,c=[];if(b.type==="table"){const d=a.inner?.tb;if(!d)return[];d.content.text.forEach({item:e=>{this.zZ.dXg.getAll(e).filter(f=>f.text==null).forEach(f=>c.push({id:`alt_text_${b.type}`,
rule:this.id,eAj:f,nf:{...a,inner:{type:"table",item:e,tb:d}}}))}})}else this.zZ.dXg.getAll(b).filter(d=>d.text==null).forEach(d=>c.push({id:`alt_text_${b.type}`,rule:this.id,eAj:d,nf:a}));return c}constructor(a){this.zZ=a;this.id="alt_text"}};var wxw,xxw;
__c.yxw=class{hN(a){if(a.type!=="element")return[];const b=a.element;var c=a.parent;if(c&&c.link)return[];const d=[];switch(b.type){case "text":case "shape":case "line":c=new wxw;c.At(b);if(c.i_a())return d.push({id:Yvw(b),rule:this.id,nf:a,xR:this.kCb(a)}),d;c=!c.bAf&&c.i$d.length>0?c.i$d:"";c.length>0&&d.push({id:Yvw(b),rule:this.id,nf:a,xR:this.kCb(a,c)});return d;case "table":const e=new wxw;b.cells.forEach(f=>{const g={...a,inner:{type:"table",tb:f}};e.okc(f);if(e.i_a())return d.push({id:Yvw(b),rule:this.id,
nf:g,xR:this.kCb(g)}),d;f=!e.bAf&&e.i$d.length>0?e.i$d:"";f.length>0&&d.push({id:Yvw(b),rule:this.id,nf:g,xR:this.kCb(g,f)})});return d;case "rect":case "chart":case "group":case "grid":case "embed":case "sheet":case "layout":case "controlled":return[];default:throw new u(b);}}kCb(a,b=""){const c=a.element,d=a.inner;if(d?.type==="table")return ra(c.type==="table"&&d.tb!==void 0),s_(()=>(new xxw(b)).okc(d.tb));if(c)return ra(c.type==="text"||c.type==="shape"||c.type==="line"),s_(()=>(new xxw(b)).At(c))}GYa(a){const b=
[],c=new wxw;a.type==="computed_range"&&(m(a.context.text&&a.iE.range),c.U7(Vvw(this,a.context.text,a.iE.range)),c.i_a()&&b.push({id:`insufficient_link_visibility_${a.type}`,rule:this.id,nf:a,xR:this.HQc(a)}));if(a.type==="item"){const d=a.item;if(d.type==="table"){const e=a.inner?.tb;if(!e)return[];c.U7(e.content.text);c.i_a()&&(a={...a,inner:{type:"table",tb:e}},b.push({id:`insufficient_link_visibility_${d.type}`,rule:this.id,nf:a,xR:this.HQc(a)}))}}return b}qyd(){this.options.Za.tYc(a=>{a={...a,
decoration:"none"};a.link&&a.link.length>0&&(a.decoration="underline");return a})}HQc(a){if(a.type==="item"){m(a.item);const b=a.context,c=a.item,d=a.inner;if(c.type==="table"&&d?.type==="table")return s_(()=>Wvw(this,b,c,d.tb))}if(a.type==="computed_range")return m(a.iE),s_(()=>Xvw(this,a.context,a.iE))}constructor(a){this.options=a;this.id="insufficient_link_visibility"}};
wxw=class extends jm{pca(a,b,c,d){if(a==="\n")b&&b.length>0&&(this.i$d=b);else{this.i$d="";var e=!1;a.trim()===""&&(b&&b.length>0||(e=!0));a=["semibold","bold","ultrabold","heavy"];b&&b.length>0?(this.bAf=!0,a.includes(d)||(this.aui=!1),c!=="underline"&&(this.jui=!1),c==="underline"&&(this.P4h=!0)):(a.includes(d)&&!e&&(this.GAi=!0),c==="underline"&&(this.t3g=!0))}}U7(a){this.GAi=this.t3g=!1;this.aui=this.jui=!0;this.bAf=this.P4h=!1;this.i$d="";a.forEach({item:()=>{},Ya:(b,c,d)=>{b!=="\n"&&this.pca(b,
d.link||Ae.Nf.link,d.decoration||Ae.Nf.decoration,d.fontWeight||Ae.Nf.fontWeight)}})}YJ(a){this.GAi=this.t3g=!1;this.aui=this.jui=!0;this.bAf=this.P4h=!1;this.i$d="";a.Ya!=="\n"&&Fg.snapshot(a).forEach({item:()=>{},Ya:(b,c,d)=>{this.pca(b,d.link||Be.Nf.link,d.decoration||Be.Nf.decoration,d["font-weight"]||Be.Nf["font-weight"])}})}i_a(){if(!this.bAf)return!1;const a=this.jui&&!this.t3g;return!(this.aui&&!this.GAi&&!this.t3g&&!this.P4h)&&!a}constructor(){super();this.GAi=this.t3g=!1;this.aui=this.jui=
!0;this.bAf=this.P4h=!1;this.i$d=""}};xxw=class extends jm{YJ(a){if(this.gun.length>0)a.setAttribute("decoration","underline"),a.setAttribute("link",this.gun);else{a.setAttribute("decoration","none");var b=0;Fg.snapshot(a).forEach({item:()=>{},Ya:(c,d,e)=>{(d=e.link)&&d.length>0&&a.setAttribute("decoration","underline",{index:b,length:c.length});b+=c.length}})}}constructor(a=""){super();this.gun=a}};__c.zxw=class{static G(a){__c.O(a,{que:rww,Hog:rww})}get que(){const a=new Set,b=[];this.Bc.Nc?.content.Pr.forEach(c=>c.ta.forEach(d=>{d=__c.NA(d);const e=__c.eYf(d);a.has(e)||(a.add(e),b.push(Zvw(d)))}));return b}get Hog(){return this.Bc.Nc?.content.Gp.find(a=>a.zg===1)?.Vva?.M3a?.ta.map(__c.NA).map(Zvw).filter(sb)??[]}constructor(a){this.Bc=(__c.zxw.G(this),void 0);this.Bc=a("color").Bc}};var cww,Axw;cww={border:[],fill:[],A2:[],lXa:[],b4:[],r_a:[],q_a:[]};Axw="border fill textCharacter textBackground textEffect imageVector imageRaster".split(" ");
__c.Bxw=class extends __c.zxw{static G(a){__c.O(a,{BGj:rww})}get BGj(){return this.que.filter(a=>!__c.iw(a))}hN(a){if(this.que.length===0)return[];switch(a.type){case "fixed_page":return this.Isd(a);case "element":return this.T2c(a);default:return[]}}Isd(a){var b=a.page.Hc.first();if(b==null)return[];const c=b.image.ref,d=this.props.ik?.VLb(a.context.xb(a.page)),e=d?[...d.Gl]:b.color?[b.color]:[];if(__c.MVa(b)||c||!$vw(this,e))return[];b=d&&!!bww(this,d);return[{id:"no_off_brand_colors",rule:this.id,
nf:a,xR:b?()=>{var f=a.page,g=a.context;(f=this.props.ik?.VLb(g.xb(f)))&&(g=bww(this,f))&&f.pj(g)}:void 0}]}T2c(a){var b=a.element;const c=a.page.ia.Hc.first();if(c==null||b.type==="group"&&!__c.gf(b)||__c.Wj(b))return[];const d=dww(this,a);if(Object.values(d).every(g=>g.length===0)){var e=__c.au.JO(b).flatMap(g=>g.color?[g.color]:[]);return $vw(this,e)?[{id:"no_off_brand_colors",rule:this.id,nf:a}]:[]}const f=new Map;Axw.forEach(g=>{eww(g,d).forEach(h=>{$vw(this,h.Gl)&&__c.ij(f,g,h)})});if(!(Bvw(f)>
0))return[];b=!0;for(e of __c.hfe(f))if(!bww(this,e,c.color)){b=!1;break}return[{id:"no_off_brand_colors",rule:this.id,nf:a,xR:b?()=>Axw.forEach(g=>{f.get(g)?.forEach(h=>{var k=c.color,l=a.element;let n=k;if(l.type==="table"||l.type==="sheet")l=dww(this,a),n=fww({category:g,EBs:l,Yms:k});(k=bww(this,h,n))&&h.pj(k)})}):void 0}]}GYa(a){const b={id:"no_off_brand_colors",rule:this.id,nf:a},c=this.que;return a.type==="computed_range"?(m(a.context.text&&a.iE.range),[...a.iE.attributes.color.values()].every(d=>
__c.mw(d,c))?[]:[b]):a.type==="item"&&a.item.type==="table"?(a=a.inner?.tb)?Mvw(this.props.eFa,a.content.text).every(d=>__c.mw(d.color,c))?[]:[b]:[]:[]}constructor(a){super(a.mr);this.props=a;this.id=(__c.Bxw.G(this),"no_off_brand_colors");this.$Nj=new Map;ixw(()=>this.que,()=>{this.$Nj.clear()})}};var Cxw=class{static G(a){__c.O(a,{zNh:rww,ANh:rww,Omm:rww,rmm:rww})}get zNh(){if(!this.Bc.Nc)return new Set;const a=this.Bc.Nc.content.KI.flatMap(c=>c.gj.map(d=>d.fontFamily)).filter(sb),b=this.Bc.Nc.content.zH.map(c=>c.vr);return new Set([...a,...b])}get ANh(){return this.Bc.Nc?this.Bc.Nc.content.KI.flatMap(a=>a.gj).filter(sb):[]}get Omm(){return this.ANh.find(a=>a.type===3)}get rmm(){return this.ANh.find(a=>a.type===6)}constructor(a){this.Bc=(Cxw.G(this),void 0);this.Bc=a("font").Bc}};var Dxw;
__c.Exw=class extends Cxw{hN(a){if(a.type!=="element"||this.zNh.size===0)return[];var b=a.element;const c=[];switch(b.type){case "table":b.cells.forEach(f=>{var g=[...gww(f).values()].map(k=>this.Vb?.LL(k)?.name).filter(sb);const h=this.xzj;g.some(k=>!h.has(k))&&(g=hww(this),f={...a,inner:{type:"table",tb:f}},c.push({id:"no_off_brand_fonts",rule:this.id,nf:f,xR:this.kCb(f,g)}))});break;case "sheet":const d=b.config;d.layout.cells.forEach((f,g)=>{var h=d.layout.attrs.get(__c.Ee.ht,g.$b,g.ec)?.fontFamily||__c.Ee.Nf.fontFamily;
h=[...iww(f,h).values()].map(l=>this.Vb?.LL(l)?.name).filter(sb);const k=this.xzj;h.some(l=>!k.has(l))&&(h=hww(this),f={...a,inner:{type:"sheet",tb:f,span:g}},c.push({id:"no_off_brand_fonts",rule:this.id,nf:f,xR:this.kCb(f,h)}))});break;case "text":case "chart":case "shape":case "rect":case "line":b=[...this.mik(b).values()].map(f=>this.Vb?.LL(f)?.name).filter(sb);const e=this.xzj;b.some(f=>!e.has(f))&&(b=hww(this),c.push({id:"no_off_brand_fonts",rule:this.id,nf:a,xR:this.kCb(a,b)}));break;case "group":case "grid":case "embed":case "layout":case "controlled":break;
default:throw new u(b);}return c}GYa(a){const b={id:"no_off_brand_fonts",rule:this.id,nf:a},c=this.zNh;return c.size===0?[]:a.type==="computed_range"?(m(a.context.text&&a.iE.range),[...a.iE.attributes.fontFamily.values()].map(d=>__c.dj(d).id).every(d=>c.has(d))?[]:[b]):a.type==="item"&&a.item.type==="table"?(a=a.inner?.tb)?this.nik(a.content.text).map(d=>__c.dj(d).id).every(d=>c.has(d))?[]:[b]:[]:[]}mik(a){const b=new Set;if(a.type==="chart")return(a=a.Ae.get("font-family"))&&b.add(a),b;let c=[];
__c.Wj(a)?({Suc:a}=__c.Xj(a),c=[a.text]):c=Cvw.WYf(a);c.forEach(d=>{d.charLength!==1&&Fg.snapshot(d).forEach({...ae,Ya:(e,f,g)=>{e.includes("\n")&&b.add(g["font-family"]||Be.Nf["font-family"])}})});return b}get xzj(){return new Set([...this.zNh.values()].map(a=>this.Vb?.LL(a)?.name).filter(sb))}kCb(a,b){if(b){var c=a.element,d=a.inner,e=a.parent,f=a.context;if(f.type==="fixed-page")a=f;else if(f.type==="group-element"&&f.container.type==="fixed-page")a=f.container;else return;var g=new Dxw(b,a,this.kd,
this.Vi,e);if(d?.type==="table")return ra(c.type==="table"&&d.tb!==void 0),s_(()=>g.s_l(d.tb,c));if(d?.type==="sheet")return ra(c.type==="sheet"&&d.tb!==void 0),s_(()=>{var h=d.span;g.Emd(d.tb);c.config.layout.attrs.set(__c.Ee.ht,h,{fontFamily:__c.bj(g.font)})});if(c)return ra(c.type==="text"||c.type==="shape"||c.type==="chart"||c.type==="line"||c.type==="rect"),s_(()=>g.At(c,f))}}nik(a){return a?[...a.attributes.fontFamily.values()]:[]}constructor(a,b,c,d){super(a);this.Vb=b;this.kd=c;this.Vi=d;
this.id="no_off_brand_fonts"}};
Dxw=class extends __c.ds{YJ(a){a.setAttribute("font-family",__c.bj(this.font))}eY(a,b){super.eY(a,b);this.parent?this.kd?.I5(this.Xe,this.parent,this.DIe(this.parent.pb.toArray())):this.kd?.K0(this.Xe,a)}pCc(a,b){super.pCc(a,b);this.parent?this.kd?.I5(this.Xe,this.parent,this.DIe(this.parent.pb.toArray())):this.kd?.cQb(a)}nNa(a){const b=a.ed.first();ra(b!==void 0);this.YJ(b.text);this.parent?this.kd?.I5(this.Xe,this.parent,this.DIe(this.parent.pb.toArray())):this.kd?.Wka(a)}j6(a,b){super.j6(a,b);
b=(new Map(a.Ae)).set("font-family",__c.bj(this.font));a.Ae=b}s_l(a,b){this.okc(a);const c=this.Vi?.Kgb(b.cells.values());if(c)try{this.kd?.WDb(b,[a],c)}finally{c.destroy()}}DIe(a){const b=[];a.forEach(c=>{c.type!=="text"&&c.type!=="line"&&c.type!=="shape"||b.push(c)});return b}constructor(a,b,c,d,e){super();this.font=a;this.Xe=b;this.kd=c;this.Vi=d;this.parent=e}};var oww=class{get(){if(!lxw()&&!this.UI.isBeingObserved)throw Error(`AsyncComputedValue must be observed: ${this.name}`);this.UI.reportObserved();if(this.NXg.error)throw this.NXg.error;return this.NXg.value}async wait(){await mxw(()=>{try{return this.get()!=null}catch(a){return!0}})}constructor(a){var b="asyncComputed"+Fxw++;this.compute=a;this.name=b;this.L_a=!0;this.NXg={};this.Fig=[];this.onBecomeObserved=()=>{this.L_a&&jww(this)};this.onBecomeUnobserved=()=>{this.L_a=!0;this.NXg={};this.Jqg?.cancel();
this.Jqg=void 0;this.Fig.forEach(c=>c());this.Fig=[]};this.UI=jxw(this.name,this.onBecomeObserved,this.onBecomeUnobserved)}},nww=class extends Error{toString(){return"CancellationError"}},Fxw=0;var Gxw;
__c.Hxw=class{hN(a){if(a.type!=="fixed_page")return[];sa(!this.options.Ka);const b=a.context.xb(a.page),{document:c,hOj:d,eFa:e,G8:f,TVa:g,gg:h,EWu:k=500}=this.options;var l=__c.sg(4,a.page.dimensions??c.dimensions);const n=__c.ug(l)?__c.NIg(a.page,c):l;l=this.O8p(a.page,l.width,l.height,k,h);if(l===void 0)return[];l=l.context;const p=l.canvas.width/n.width,q=tww(a.page),r=[];for(let x=0;x<q.length;x++){var t=q[x];const y=t.element;t=t.group;const z=y.za+(t?(1-y.za)*t.za:0);var v=Kvw(e,y,t);if(v.length===
0)continue;v=vww(this,v.map(T=>({fontSize:T["font-size"],fontWeight:T["font-weight"]})));var w=Oj(y);if(t){const T=__c.Fj(t.width/t.gb).then(__c.Tj(Oj(t)));w=w.transform(T)}const {top:B,left:C,width:G,height:H}=w.scale(p).Nb(),[K,L]=n instanceof __c.gWa?[n.Ub.x,n.t.y]:[0,0],{top:N,left:P}=w.translate(-Math.round(K),-Math.round(L)).scale(p).Nb();w=l.getImageData(P,N,Math.max(G,1),Math.max(H,1));switch(y.type){case "table":zww(this,y,b,f,C,B,w,p,z,g,a,l,v,d,r);break;case "text":Aww(this,y,b,f,C,B,w,
p,z,g,a,l,v,d,r,t);break;case "chart":case "shape":case "line":break;default:throw new u(y);}}return r}GYa(a){if(a.type!=="computed_range"&&a.type!=="item")return[];const b=a.context.marker.background.color??"#ffffff";var c=this.options.pd;const d=this.options.Za;var e=this.options.SGo,f=this.options.eFa;const g=Bww(this,a.context),h=[],k=(v,w)=>{v=this.Jmd(v,0,b).Ipf;return w>=18?v>=3:v>=4.5};if(a.type==="computed_range"&&a.iE.DUa){e=Cww(a.iE.attributes);var l=Dww(this,e,b);if(l.length<1)return[];
const v=vww(this,e);e=Eww(e);h.push({id:`insufficient_text_contrast_computed_range_${JSON.stringify(e)}`,rule:this.id,nf:a,czd:()=>Fww(g,v,k),zud:e,$Qd:this.HQc(a,d,l)})}else if(a.type==="item"){const v=a.item;switch(v.type){case "chart":e=f.sWh(v);l=Dww(this,[e],b);if(l.length<1)return[];const w=vww(this,[e]);e=Eww([e]);h.push({id:`insufficient_text_contrast_chart_item_${JSON.stringify(e)}`,rule:this.id,nf:a,czd:()=>Fww(g,w,k),zud:e,$Qd:this.HQc(a,d,l)});break;case "table":const x=a.inner?.tb;if(x){l=
{ref:x,box:x.fill.gradient.ref&&c.DF(v)?c.psc(v,x):void 0};f=Nvw(f,x);var n=(c=c.vUa(v))?Yww(e,c,[l]):void 0;e=Eww(f);var p=vww(this,f);if(x.fill.gradient.ref){if(l=m(l.box),c&&n){var q=[];for(f=0;f<e.length;f++)q.push(l);var r=(y,z)=>{y=www(this,{cjl:q,left:0,top:0,Hkl:n,RF:y,sampleCount:300});return xww(y,z)};l=e.filter(y=>!r(y,p));l.length<1||h.push({id:`insufficient_text_contrast_table_item_cell_${JSON.stringify(e)}`,rule:this.id,nf:a,czd:()=>Fww(g,p,(y,z)=>r(y,z)),zud:e,$Qd:this.HQc(a,d,l)})}}else if(l=
Dww(this,f,x.fill.color??b),!(l.length<1)){var t=(y,z)=>{y=this.Jmd(y,0,x.fill.color??b).Ipf;return z>=18?y>=3:y>=4.5};h.push({id:`insufficient_text_contrast_table_item_cell_${JSON.stringify(e)}`,rule:this.id,nf:a,czd:()=>Fww(g,p,t),zud:e,$Qd:this.HQc(a,d,l)})}}}}return h}kCb(a){const b=a.element,c=a.inner;switch(b.type){case "table":return s_(d=>{ra(c!=null&&c.type==="table");(new Gxw(d)).okc(c.tb)});case "chart":case "line":case "shape":case "text":return s_(d=>{(new Gxw(d)).At(b)})}}Z6(a){if(a==
null)return!1;switch(a){case "bold":case "heavy":case "ultrabold":return!0;case "extralight":case "light":case "medium":case "normal":case "semibold":case "thin":return!1;default:throw new u(a);}}HQc(a,b,c){const d=a.context,e=a.type;if(e==="item"){m(a.item);const f=a.item,g=a.inner;if(f.type==="table"&&g?.type==="table")return s_(h=>{b.IW(()=>{b.rub(d.text,f,[g.tb])});this.qyd(h,c)});if(f.type==="chart")return s_(h=>{b.IW(()=>{b.Nw(d.text,f)});f.Ae.color=h})}if(e==="computed_range")return s_(f=>
{b.IW(()=>{b.qv(d.text,a.iE.range)});this.qyd(f,c);b.deselectAll()})}qyd(a,b){let c=Ae.Nf.color;this.options.Za.tYc(d=>{const e={...d};if(d.color||"color"in d&&d.color===void 0)c=d.color||Ae.Nf.color;b.includes(c)&&(e.color=a);return e})}constructor(a){this.options=a;this.id="insufficient_text_contrast";this.O8p=qww(function*(b,c,d,e,f){yield __c.ka(e);return f.lQ(b,{width:c,height:d},{Xbc:!0})});this.Jmd=fxw((b,c,d)=>{b=$h(b).y8a(1-c);c=$h(d);b=__c.VVa(b,c);d=__c.mj(b,d);return{THj:b.hD(),Ipf:d}});
this.Bc=a.mr("color").Bc}};Gxw=class extends jm{YJ(a){a.setAttribute("color",this.color)}constructor(a){super();this.color=a}};__c.Ixw=new Set([21,22]);__c.Jxw=class{hN(a){switch(a.type){case "fixed_document":var b=a.document;return __c.LVa(b)||b.pages.every(Hww)?[{id:"no_empty_document",rule:this.id,nf:a,type:"empty"}]:[];case "fixed_page":return b=a.page,Hww(b)?[{id:"no_empty_document",rule:this.id,nf:a,type:__c.Gww(b)?"empty":"with_background"}]:[];default:return[]}}GYa(a){return a.type!=="responsive_document"?[]:a.document.Nl.every(__c.KVa)?[{id:"no_empty_document",rule:this.id,nf:a,type:"empty"}]:[]}constructor(){this.id="no_empty_document"}};var Kxw,Lxw;Kxw=RegExp("^#page-(\\w+)$");
__c.Mxw=class{hN(a){if(a.type!=="element")return[];const b=a.element,c=a.parent;if(c&&c.link)return[];a=[{id:Jww(b),rule:this.id,nf:a}];if(b.link&&this.jYg.filter(b.link))return a;switch(b.type){case "text":return Kww(this.jYg,b.text)?a:[];case "table":return Lww(this.jYg,b)?a:[];case "line":case "shape":return b.ed.some(d=>Kww(this.jYg,d.text))?a:[];default:return[]}}GYa(a){if(a.type==="computed_range")return Iww(this,a).map(b=>({id:`no_links_${b}`,rule:this.id,nf:a}));if(a.type==="item"){const b=
a.item,c=[{rule:this.id,id:`no_links_${b.alignment}_${b.width}`,nf:a}];if(b.type==="table")return Mww(this.jYg,b)?c:[]}return[]}constructor(a){this.options=a;this.id="no_links";this.jYg=new Lxw(b=>this.options.config.Xem?!Kxw.test(b):!0)}};Lxw=class extends __c.$Wc{q$f(a){a.link&&a.link.length>0&&this.filter(a.link)&&this.links.push(a.link)}npe(a){a.link&&(a=a.link)&&a.length>0&&this.filter(a)&&this.links.push(a)}constructor(a){super();this.filter=a;this.links=[]}};__c.Nxw=class{hN(a){return a.type==="fixed_document"||a.type==="concatenated_fixed_page"?[]:[...Pww(this,a),...Rww(this,a)]}GYa(a){return a.type==="responsive_document"||a.type==="responsive_page"||a.type==="body"||a.type==="computed_range"?[]:[...Pww(this,a),...Rww(this,a)]}constructor(a,b){this.Qa=a;this.dc=b;this.id="no_pro_elements"}};var Oxw;
__c.Pxw=class{hN(a){const b=this.options.config.lJ;if(a.type!=="element")return[];const c=a.element;var d=a.parent;const e=[];switch(c.type){case "table":c.cells.forEach(f=>{var g=__c.Lvw(this.options.eFa,f,c)["scaled-font-size"];g!=null&&(g=Uww(this,g))&&(f={...a,inner:{type:"table",tb:f}},e.push({id:`font_size_readable_font_size_${g}`,rule:this.id,lJ:b,nf:f,xR:this.kCb(f)}))});break;case "text":case "chart":case "shape":case "line":d=this.options.eFa.p3c(c,d)["scaled-font-size"];if(d==null)break;(d=
Uww(this,d))&&e.push({id:`font_size_readable_font_size_${d}`,rule:this.id,lJ:b,nf:a,xR:this.kCb(a)});break;case "group":case "rect":case "grid":case "embed":case "sheet":case "layout":case "controlled":break;default:throw new u(c);}return e}GYa(a){const b=[];if(a.type==="computed_range"){var c=md(a.iE.attributes.fontSize.values()).find(d=>!Tww(this,d));c&&b.push({id:`font_size_readable_${c}`,rule:this.id,lJ:this.options.config.lJ,nf:a,xR:this.HQc(a)})}if(a.type==="item"){c=this.options.Gzf;const d=
a.item;switch(d.type){case "table":c=a.inner?.tb;if(!c)break;(c=Ivw(c.content.text).find(e=>!Tww(this,e.fontSize)))&&b.push({id:`font_size_readable_${JSON.stringify(c)}`,rule:this.id,lJ:this.options.config.lJ,nf:a,xR:this.HQc(a)});break;case "chart":c=c.iYd(d);(c=md(c,e=>e.fontSize).find(e=>!Tww(this,e.fontSize)))&&b.push({id:`font_size_readable_${JSON.stringify(c)}`,rule:this.id,lJ:this.options.config.lJ,nf:a,xR:this.HQc(a)});break;case "controlled":case "pill":case "rect":case "design":case "embed":case "layout":case "sheet":case "break":case "separator":break;
case "shape":throw new __c.vv;default:throw new u(d);}}return b}kCb(a){const b=a.element,c=a.inner,d=a.page,e=a.parent;if(c?.type==="table")return ra(b.type==="table"&&c.tb!==void 0),s_(()=>{var f=d.ia,g=c.tb;sa(this.options.Ka===void 0);f=new Oxw(this.options.config.lJ,this.options.kd,this.options.Vi,this.options.document,f);f.L5b(b);f.s_l(g,b)});if(b)return ra(b.type==="text"||b.type==="shape"||b.type==="chart"||b.type==="line"),s_(()=>{var f=d.ia;sa(this.options.Ka===void 0);(new Oxw(this.options.config.lJ,
this.options.kd,this.options.Vi,this.options.document,f,e)).At(b)})}HQc(a){if(a.type==="item"){m(a.item);const b=a.context,c=a.item,d=a.inner;if(c.type==="table"&&d?.type==="table")return s_(()=>Vww(this,b,c,d.tb));if(c.type==="chart")return s_(()=>Www(this,b,c))}if(a.type==="computed_range")return m(a.iE),s_(()=>Xww(this,a.context,a.iE))}qyd(){let a=Ae.Nf.fontSize;this.options.Za.tYc(b=>{const c={...b};if(b.fontSize||"fontSize"in b&&b.fontSize===void 0)a=b.fontSize||Ae.Nf.fontSize;Tww(this,a)||(c.fontSize=
this.options.config.lJ*__c.Wt);return c})}constructor(a){this.options=a;this.id="template_font_size_readable"}};
Oxw=class extends jm{YJ(a){a.setAttribute("font-size",this.lJ*__c.Wt/this.OCa)}eY(a){this.OCa=(this.parent&&this.parent.gb?this.parent.width/this.parent.gb:1)*(a.gb!=null?a.width/a.gb:1);super.eY(a);this.parent?this.kd.I5(zf(this.document).xb(this.page),this.parent,this.DIe(this.parent.pb.toArray())):this.kd.K0(zf(this.document).xb(this.page),a)}j6(a){this.OCa=a.gb!=null?a.width/a.gb:1;super.j6(a)}pCc(a){super.pCc(a);this.parent?this.kd.I5(zf(this.document).xb(this.page),this.parent,this.DIe(this.parent.pb.toArray())):
this.kd.cQb(a)}nNa(a){const b=a.ed.first();ra(b!==void 0);this.YJ(b.text);this.parent?this.kd.I5(zf(this.document).xb(this.page),this.parent,this.DIe(this.parent.pb.toArray())):this.kd.Wka(a)}s_l(a,b){this.okc(a);const c=this.Vi.Kgb(b.cells.values());try{this.kd.WDb(b,[a],c)}finally{c.destroy()}}L5b(a){this.OCa=a.width/a.gb}DIe(a){const b=[];a.forEach(c=>{c.type!=="text"&&c.type!=="line"&&c.type!=="shape"||b.push(c)});return b}constructor(a,b,c,d,e,f){super();this.lJ=a;this.kd=b;this.Vi=c;this.document=
d;this.page=e;this.parent=f;this.OCa=1}};__c.Qxw=class{static create(){return new __c.Qxw((a,b)=>__c.$$e(a,b,{aGe:!1,B$b:!0}))}constructor(a){this.createContext=a}};var $ww=class{KAe(a){return a.map(b=>this.VPk(b))}VPk(a){var b=this.Nmg.get(a.rule);if(b)return b;switch(a.rule){case "alt_text":b=new __c.vxw(this.zZ);break;case "no_empty_document":b=new __c.Jxw;break;case "no_off_brand_colors":return b=new __c.Bxw({mr:this.mr,eFa:this.eFa});case "no_off_brand_fonts":return b=new __c.Exw(this.mr);case "no_links":b=new __c.Mxw({Za:this.Za,config:a.config});break;case "insufficient_link_visibility":b=new __c.yxw({Za:this.Za});break;case "insufficient_text_contrast":b=
__c.Qxw.create();b=new __c.Hxw({Ka:"responsive",mr:this.mr,pd:this.pd,Za:this.Za,SGo:b,eFa:this.eFa});break;case "template_font_size_readable":b=new __c.Pxw({Ka:"responsive",Gzf:this.Gzf,eFa:this.eFa,config:a.config,Za:this.Za});break;case "no_pro_elements":b=new __c.Nxw(this.Qa,this.dc);break;default:throw Error("Unexpected responsive rule: "+a.rule);}this.Nmg.set(a.rule,b);return b}constructor(a,b,c,d,e,f,g){var h=new __c.rxw;this.pd=a;this.mr=b;this.Gzf=c;this.Qa=d;this.dc=e;this.eFa=h;this.Za=
f;this.zZ=g;this.Nmg=new Map}};__c.ccf={};__c.ccf.xqr=__c.cxw;
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/640c6d655d5ee18e.js.map