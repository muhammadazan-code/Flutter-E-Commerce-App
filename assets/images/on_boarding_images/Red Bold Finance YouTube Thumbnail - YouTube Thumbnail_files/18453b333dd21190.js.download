(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[70438],{

/***/ 127165:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(453605);__web_req__(764820);__web_req__(697786);__web_req__(732901);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var m=__c.m;var pj=__c.pj;var Uc=__c.Uc;var O=__c.O;var u=__c.u;
var Zmx=function(a,b,c){let d=__c.Bfe(c.point,a),e=__c.Cfe(c.point,a);if(d&&e)switch(c.position){case "top-start":return a.rows.dj(b.df,d)<0&&(d=b.df),a.cols.dj(b.jf,e)<0&&(e=b.jf),{ec:e,$b:d,jf:b.jf,df:b.df};case "top-end":return a.rows.dj(b.df,d)<0&&(d=b.df),a.cols.dj(e,b.ec)<0&&(e=b.ec),{ec:b.ec,$b:d,jf:e,df:b.df};case "bottom-start":return a.rows.dj(d,b.$b)<0&&(d=b.$b),a.cols.dj(b.jf,e)<0&&(e=b.jf),{ec:e,$b:b.$b,jf:b.jf,df:d};case "bottom-end":return a.rows.dj(d,b.$b)<0&&(d=b.$b),a.cols.dj(e,
b.ec)<0&&(e=b.ec),{ec:b.ec,$b:b.$b,jf:e,df:d};default:throw new u(c.position);}},cnx=function(a,b){switch(a.session.document.Ka){case "fixed":var c=__c.zf(a.session.document);for(var d of a.session.document.pages)switch(d.type){case "fixed":var e=$mx(a,d,b,c);if(e)return e;break;case "concatenated-fixed":for(const f of d.pages)if(e=$mx(a,f,b,c))return e;break;case "responsive":if(e=anx(a,c.xb(d),b))return e;break;default:throw new u(d);}break;case "responsive":for(c of bnx(a.session.document))if(d=
anx(a,c,b))return d;break;default:throw new u(a.session.document);}},$mx=function(a,b,c,d){if(__c.hf(b)&&b.id===c.sheetId)return c=d.xb(b),{container:c,sheet:b.sheet,FE:new __c.Xz(c,a.viewport,a.Pa)};d=d.xb(b);for(const e of b.elements)if(e.type==="sheet"&&e.id===c.sheetId)return{container:d,sheet:e.config,FE:new __c.Wz(d.Me(e),a.viewport)}},anx=function(a,b,c){for(const d of b.items)if(d.type==="sheet"&&d.id===c.sheetId)return{container:b,sheet:d.config,FE:new __c.Zz(b.ew(d),a.pd,a.viewport)}},bnx=
function(a){switch(a.Ka){case "fixed":return a.pages.filter(b=>b.type==="responsive").map(b=>__c.zf(a).xb(b));case "responsive":return a.Nl.map(b=>__c.vf(__c.yf(a),b));default:throw new u(a);}},dnx=function(a){return __c.Nra(a)?a:dnx(a.container)},knx=function(a){const b=a.session,c=a.canvas,d=a.Ih,e=a.gVb,f=a.dF;a=new enx(b,a.selection,a.viewport,a.pd,a.Pa);const g=new fnx(a,b,f),h=new gnx(g,d,e,f,k=>{c.dva=k?"EqF55A":void 0});c.jc(k=>k===40,(k,l)=>{k.Bg.rDc=l?hnx(n=>{const p=g.Oud;return p&&p.container.type===
"fixed-page"&&p.container.page===n.page.page?inx(__c.Yz,{wz:p.FE,page:n.page.page,children:inx(jnx,{Iyg:p.Iyg,hK:g.hK,Drf:g.Drf,scale:n.Tc.scale,onDragStart:h.onDragStart,pe:h.pe,onDragEnd:h.onDragEnd})}):null}):void 0});c.jc(k=>k===40,(k,l)=>{k.Bn.FL.rDc=l?hnx(()=>{const n=g.Oud;return n&&n.container.type!=="fixed-page"?inx(__c.Yz,{wz:n.FE,page:void 0,children:inx(jnx,{Iyg:n.Iyg,hK:g.hK,Drf:g.Drf,scale:n.FE.gd,onDragStart:h.onDragStart,pe:h.pe,onDragEnd:h.onDragEnd})}):null}):void 0})},lnx=function(a,
b,c){switch(c){case "magic-charts":return!!b.n2&&b.n2.cells.some(d=>b.sheet?a.nBa.getContent(b.sheet,d.row,d.column)?.NC.type===1:!1);case "magic-charts-action":return!!b.n2;default:throw new u(c);}},nnx=function(a,b){if(b.n2){var c=b.n2.sheet,d=b.n2.cells;b=b.n2.sheetId;d=d.length===1?__c.mZa(c,__c.lZa(c,{start:d[0],end:d[0]})):d;return new mnx(c,d,b,a.dF)}},onx=function(a,b,c,d,e){return{start:{type:0,value:{column:a.$xb(b),row:a.nEb(c)}},end:{type:0,value:{column:a.$xb(d),row:a.nEb(e)}}}},pnx=
class{static G(a){O(a,{DEa:__c.Rw,Pb:__c.Rw})}get DEa(){var a=this.L,b=this.store;var c=nnx(a,b);if(!c||c.cells.length<=0)c=void 0;else{b:{if(b=nnx(a,b))if(b=b.sheetId)if(a=a.zid.get(b)){a=__c.Wps(a);break b}a=void 0}c={sheet:c.sheet,range:c.lwj,cells:c.cells,sheetName:a}}return c}myi(a){if(a.config.type!=="PROGRESS"&&a.config.type!=="PICTOGRAM"){var b=nnx(this.L,this.store)?.LC;return b?{...a,...b}:void 0}}get Pb(){var a=(a=this.L.VKe(this.store))?a.type==="COPY_SHEETS"?{...a,type:"copy-sheets"}:
{...a,type:"live-sheets"}:void 0;return a}constructor(a,b){this.store=a;this.L=b;pnx.G(this)}},qnx=__webpack_require__(31968),rnx=qnx.Fragment,inx=qnx.jsx,snx=qnx.jsxs;var tnx=__webpack_require__,unx=tnx(208463),vnx=tnx.n_x(unx)();var hnx=__webpack_require__(647370).PA;var wnx=__webpack_require__(845212),xnx=wnx.Component,ynx=wnx.useCallback;var znx=__webpack_require__(277049)._;var Anx=__webpack_require__(186901),Bnx=Anx.EW,Cnx=Anx.h5,Dnx=Anx.sH,Enx=Anx.XI;var Fnx=__webpack_require__(269018)._;var Gnx,Hnx,Inx,Jnx,Knx=parseInt("2px",10),jnx;
new (Gnx=class extends znx{constructor(){super(jnx);Hnx()}},(()=>{class a extends(Inx=xnx){static G(b){O(b,{Jbm:Bnx.struct})}get Jbm(){const b=this.props.hK;if(b)switch(b.position){case "top-start":return{top:Uc*-.5+Knx,left:Uc*-.5+Knx};case "top-end":return{top:Uc*-.5+Knx,right:Uc*-.5-Knx};case "bottom-start":return{bottom:Uc*-.5-Knx,left:Uc*-.5+Knx};case "bottom-end":return{bottom:Uc*-.5-Knx,right:Uc*-.5-Knx};default:throw new u(b.position);}}render(){var b=this.props.scale;const c=this.props.hK;
b=this.props.Drf?.scale(b).Nb();return snx(rnx,{children:[inx(this.w9o,{}),b&&inx("div",{style:{top:b.top,left:b.left,width:b.width,height:b.height},className:"HTaEtQ",children:c&&inx("div",{className:vnx("tXWBLw","EqF55A"),style:this.Jbm})})]})}constructor(...b){super(...b);this.w9o=(jnx.G(this),hnx(()=>this.props.Iyg?.map((c,d)=>inx(Lnx,{handle:c,scale:this.props.scale,isDragging:this.props.hK!=null,onDragStart:this.props.onDragStart,pe:this.props.pe,onDragEnd:this.props.onDragEnd},d))))}}({c:[jnx,
Hnx]}=Fnx(a,[],[__c.Lb],Inx))})(),Gnx);
var Lnx,Mnx=class extends xnx{render(){const a=this.props.isDragging,b=__c.yj(this.props.scale,this.props.handle.point);return inx("div",{ref:this.XB.Gq,className:vnx("tXWBLw","EqF55A"),style:{transform:`translate(${b.x}px, ${b.y}px)`,display:a?"none":"block"}})}constructor(...a){super(...a);this.XB=new __c.dd([new __c.ed({yt:Enx(b=>this.props.onDragStart({point:new pj(b.Li,b.zj),position:this.props.handle.position})),IF:Enx(b=>this.props.pe({point:new pj(b.Li,b.zj),position:this.props.handle.position})),
tx:Enx(()=>this.props.onDragEnd())})])}};({c:[Lnx,Jnx]}=Fnx(Mnx,[],[__c.Lb],xnx));Jnx();var gnx=class{static G(a){O(a,{Qh:Dnx.ref})}constructor(a,b,c,d,e){this.store=a;this.Ih=b;this.gVb=c;this.dF=d;this.Xaf=e;this.Qh=(gnx.G(this),void 0);this.onDragStart=f=>{var g=this.store.Oud;if(g){var h=g.sheet,k=g.FE,l=g.range,n=k.$R;g=k.gM;var p=k.vB,q=h.direction==="rtl"?__c.sj(p.tr,g.tr):__c.sj(p.tl,g.tl);this.Ih.SL(r=>{const t=__c.Gv(h,n,p,q,f.point);this.store.Frf=Zmx(h,l,{point:t,position:f.position});this.store.hK=f;this.Qh={stop:r};this.Xaf(!0)})}};this.pe=f=>{var g=this.store.Oud;if(g){var h=
g.sheet,k=g.FE;g=g.range;var l=k.gM,n=k.vB;k=__c.Gv(h,k.$R,n,h.direction==="rtl"?__c.sj(n.tr,l.tr):__c.sj(n.tl,l.tl),f.point);this.store.Frf=Zmx(h,g,{point:k,position:f.position})}};this.onDragEnd=()=>{var f=this.store.Oud,g=this.store.Frf;this.Qh?.stop();this.Qh=void 0;this.store.Frf=void 0;this.store.hK=void 0;this.Xaf(!1);if(f&&g){var h=f.sheet,k=f.Zb;f=f.Rnf;g=__c.kAb({start:{type:0,value:{row:g.$b,column:g.ec}},end:{type:0,value:{row:g.df,column:g.jf}}},h);h=(new __c.mmr(this.dF)).serialize(g,
h);this.gVb.sheets.Azh(k,{...f,ranges:[h]})}}}};var fnx=class{static G(a){O(a,{Frf:Dnx.ref,hK:Dnx.ref,Oud:Bnx,Drf:Bnx({equals:__c.gk(__c.Qj)})})}get Oud(){var a=this.config.selection;if(a){a=a.Zb;var b=a.Pb;if((b?.type==="copy-sheets"||b?.type==="live-sheets")&&__c.MVe(a.config.ref.type)&&(b.type==="live-sheets"?this.session.id:b.ka)===this.session.id){var c=cnx(this.config,b);if(c){var d=c.container,e=c.sheet;c=c.FE;var f={ec:m(e.cols.first()),$b:m(e.rows.first()),jf:m(e.cols.last()),df:m(e.rows.last())};if(b.ranges.length){var g=new __c.mmr(this.dF);
try{var h=__c.pAb(g.deserialize(b.ranges[0]),e);var k=__c.sAb(e,__c.rAb(h,e))}catch(n){}}if(k)a:switch(f=k.start,k=k.end,f.type){case 0:__c.sa(k.type===0);f={ec:f.value.column,$b:f.value.row,jf:k.value.column,df:k.value.row};break a;case 1:__c.sa(k.type===1);f={ec:f.value,$b:m(e.rows.first()),jf:k.value,df:m(e.rows.last())};break a;case 2:__c.sa(k.type===2);f={ec:m(e.cols.first()),$b:f.value,jf:m(e.cols.last()),df:k.value};break a;default:throw new u(f);}k=e.yd(f.ec);h=e.ld(f.$b);g=e.yd(f.jf)+f.jf.width;
var l=e.ld(f.df)+f.df.height;return new Nnx(d,e,c,a,b,f,[{point:new pj(k,h),position:"top-start"},{point:new pj(g,h),position:"top-end"},{point:new pj(k,l),position:"bottom-start"},{point:new pj(g,l),position:"bottom-end"}])}}}}get Drf(){if(this.Oud){var a=this.Oud.sheet,b=this.Oud.range,{$b:c,ec:d,df:e,jf:f}=this.Frf||b;b=a.yd(d);var g=a.ld(c),h=a.yd(f)+f.width;a=a.ld(e)+e.height;return __c.Lj(b,g,h,a)}}constructor(a,b,c){this.config=a;this.session=b;this.dF=c;this.Frf=(fnx.G(this),void 0)}},Nnx=
class{constructor(a,b,c,d,e,f,g){this.container=a;this.sheet=b;this.FE=c;this.Zb=d;this.Rnf=e;this.range=f;this.Iyg=g}},enx=class{static G(a){O(a,{selection:Bnx})}get selection(){const a=this.vg.Ma,b=this.vg.Kb;if(a&&a.type==="elements"&&a.Pd?.type==="chart")return{container:a.container,Zb:a.Pd};if(b&&b.type===1&&b.only?.type==="chart")return __c.sa(__c.PVc(b.container)),{container:dnx(b.container),Zb:b.only}}constructor(a,b,c,d,e){this.session=a;this.vg=b;this.viewport=c;this.pd=d;this.Pa=e;enx.G(this)}};var Onx=class{static G(a){O(a,{KWc:Dnx.ref,zid:Bnx})}VKe(a){return nnx(this,a)?.Pb}get zid(){return this.KWc.zid()}constructor(a,b,c){this.nBa=b;this.dF=c;this.KWc=(Onx.G(this),void 0);this.KWc=new __c.Xps(a.document)}},mnx=class{static G(a){O(a,{LC:Bnx,Pb:Bnx,p$m:Bnx,range:Bnx,lwj:Bnx})}get LC(){if(this.p$m)return{Pb:this.Pb,data:[]}}get Pb(){return new __c.c$b({sheetId:this.sheetId,ranges:[(new __c.mmr(this.dF)).serialize(this.lwj,this.sheet)]})}get p$m(){return this.cells.some(a=>!!this.sheet.layout.cells.get(a.row,
a.column))}get range(){const a=this.sheet,b=this.cells,c=a.layout.cols.count()-1,d=a.layout.rows.count()-1;if(!b||b.length===0)return onx(a,0,0,c,d);let e,f,g,h;b.forEach(k=>{const l=a.zL(k.column);if(e==null||l<e)e=l;if(f==null||l>f)f=l;k=a.kL(k.row);if(g==null||k<g)g=k;if(h==null||k>h)h=k});return onx(a,e??0,g??0,f??c,h??d)}get lwj(){return __c.kAb(this.range,this.sheet)}constructor(a,b,c,d){this.sheet=a;this.cells=b;this.sheetId=c;this.dF=d;mnx.G(this)}};var Pnx=class{static G(a){O(a,{sheet:Bnx,cells:Bnx,n2:Bnx,hM:Bnx})}get sheet(){return this.hM?.sheet}get cells(){return this.hM?.cells}get n2(){const a=this.hM;return a&&{sheet:a.sheet,cells:a.cells,sheetId:a.sheetId}}get hM(){if(this.Pa.mode===40){var a=this.eJs;if(a)return a;if((a=this.selection.Ma)&&a.Ri(__c.Ol.Sw)&&(a.type==="elements"||a.type==="pages")){if(a.inner&&a.inner.type==="sheet"){let c;switch(a.type){case "pages":var b=a.inner.page.sheet;c=m(a.inner.page.id);break;case "elements":b=
a.inner.sheet.config;c=a.inner.sheet.id;break;default:throw new u(a);}return{sheet:b,sheetId:c,rows:a.inner.rows.map(d=>d),cols:a.inner.columns.map(d=>d),cells:a.inner.cells.map(d=>d)}}if(a.Pd?.type==="sheet"){b=a.Pd.config.layout.rows;const c=a.Pd.config.layout.cols;return{sheet:a.Pd.config,sheetId:a.Pd.id,rows:b.toArray(),cols:c.toArray(),cells:b.flatMap(d=>c.map(e=>({row:d,column:e})))}}}}}get eJs(){const a=this.selection.Kb;if(a!=null)switch(a.type){case 4:return{sheet:a.container.sheet.config,
sheetId:a.container.sheet.id,rows:a.rows.map(d=>d),cols:a.columns.map(d=>d),cells:a.cells.map(d=>d)};case 1:if(a.only?.type!=="sheet")break;const b=a.only.config.layout.rows,c=a.only.config.layout.cols;return{sheetId:a.only.id,sheet:a.only.config,rows:b.map(d=>d),cols:c.map(d=>d),cells:b.flatMap(d=>c.map(e=>({row:d,column:e})))};case 0:if(a.container.type!=="sheet-item-cell-richtext")break;return{sheetId:a.container.container.container.sheet.id,sheet:a.container.container.sheet,rows:[],cols:[],cells:[{column:a.container.container.column,
row:a.container.container.row}]};case 2:case 3:case 5:break;default:throw new u(a);}}constructor(a,b){this.selection=a;this.Pa=b;Pnx.G(this)}};__c.Pgg={Sqr:function(a){const b=new __c.mu,c=a.session,d=a.Pa,e=a.selection,f=a.nBa,g=a.he,h=a.Jd,k=a.QVs,l=a.config;knx({session:c,canvas:a.canvas,viewport:a.viewport,Pa:d,selection:e,Ih:a.Ih,gVb:a.gVb,pd:a.pd,dF:b});const n=new Pnx(e,d),p=new Onx(c,f,b),q=Enx(()=>{l.JHd?.()});h.plugins.dIb=()=>({Sd:()=>d.mode===40&&!!l.JHd&&!!n.n2,Button:hnx(r=>{const t=r.onClick,v=ynx(()=>Cnx(()=>{t?.();q()}),[t]);return inx(r.yi,{...r,icon:__c.VFr,tooltip:__c.M("OcZVfw"),onClick:v,zh:"icon",XEa:__c.M("OcZVfw")})})});
g&&["magic-charts","magic-charts-action"].forEach(r=>g.ym(()=>d.mode===40&&!!l.JHd&&lnx(p,n,r),{type:"simple",key:r,name:__c.M("OcZVfw"),aliases:[__c.M("Spialg")],Icon:__c.VFr,hI:!0,execute:async()=>{q()}}));k.set(new pnx(n,p))}};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/18453b333dd21190.js.map