(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[60343],{

/***/ 86720:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(764820);self._456c437108d2d2713799e19380be528d = self._456c437108d2d2713799e19380be528d || {};(function(__c) {var Tc=__c.Tc;var R=__c.R;var sb=__c.sb;
var ZWv=function(a){if(a)return a.video??a.audio},$Wv=function(a,{caption:b,context:c}){return a.selection.oc(c.container.page,b)},aXv=function(a){var b=a.container.page;const c=a.variant==="grouped"?a.qXd.zm:a.bog.zm;if(c.startsWith("D"))return(b=b.audio.tracks.first(d=>d.id===c))?{type:"audio",source:b,...a}:void 0;if(c.startsWith("V")){b=__c.OFd(b).find(f=>f.fill.id===c);if(!b)return;const d=b.element,e=b.parent;return{type:"video",source:b.fill,J5u:d&&{element:d,parent:e},...a}}throw Error("unexpected caption element sourceRef: "+
c);},cXv=function(a,b,c){return a.variant==="grouped"?a.qXd.pb.map(d=>bXv(d,a.qXd,a,b,c)).filter(sb):[bXv(a.bog,a.Pee,a,b,c)].filter(sb)},bXv=function(a,b,c,d,e){const f=__c.eXa(a,c.container.page,e,b);b=f.startUs;e=Math.min(f.startUs+f.durationUs,e);if(!(b>=e))return{caption:a,context:c,sId:d,startUs:b,endUs:e}},dXv=__webpack_require__(31968),wZ=dXv.jsx,eXv=dXv.jsxs;var fXv=__webpack_require__,gXv=fXv(208463),hXv=fXv.n_x(gXv)();var iXv=__webpack_require__(647370).PA;var jXv=__webpack_require__(845212),kXv=jXv.forwardRef,lXv=jXv.lazy,mXv=jXv.Suspense,nXv=jXv.useCallback,oXv=jXv.useEffect,pXv=jXv.useRef,qXv=jXv.useState;var rXv=__webpack_require__(186901),sXv=rXv.EW,tXv=rXv.mJ,uXv=rXv.XI;var vXv=__webpack_require__(536618).Aj;var wXv=iXv(kXv(function({a2p:a,disabled:b,R0b:c,xv:d,onFocus:e,onBlur:f,y3o:g,oc:h,kvr:k},l){var n=a.caption.text.Ya;n=n.at(-1)==="\n"?n.slice(0,-1):n;const p=!n,q=pXv(null),[r,t]=qXv(!1),v=nXv(B=>{c(a,B)},[a,c]),w=nXv(B=>{B.stopPropagation();d(a)},[a,d]),x=nXv(()=>{q.current&&q.current.focus()},[]),y=nXv(()=>{b||(e(a),t(!0))},[e,b,a]),z=nXv(()=>{f(a.context.source);t(!1);p&&d(a)},[p,d,a,f]);return eXv("div",{ref:l,className:hXv("zHttKA",{jVgfgg:r,cl18qQ:h}),onClick:x,children:[!r&&g,wZ(__c.TC,{ref:q,
className:hXv("KL0H2A",{BPBG7g:b,wfxDJw:k}),tN:hXv("GrL8hw","vBXbDg aWBg0w"),value:n,maxLength:150,cOa:0,disabled:b,resize:!1,ft:!0,PK:!0,onFocus:y,onBlur:z,onChange:v,ariaLabel:n}),wZ(__c.Wi,{className:"IKU0UQ",variant:"tertiary",icon:__c.Ix,size:"xsmall",onClick:w})]})}));var xXv=iXv(({L:a,x3o:b})=>{const c=pXv(null),d=pXv(!0);oXv(()=>{c.current!=null&&a.pzf==null&&c.current.scrollIntoView({behavior:d.current?"instant":"smooth",block:"center"});d.current=!1});return wZ(R,{padding:"2u",children:wZ(Tc,{spacing:"3u",children:a.cKj.map(({Bd:e,J8b:f})=>eXv(R,{children:[wZ(__c.Q,{size:"small",weight:"bold",children:__c.J("1vK1wg",[e])}),wZ(R,{paddingTop:"1.5u",children:wZ(Tc,{spacing:"0",children:f.map((g,h)=>{const k=a.Bbm.has(g.caption);return wZ(b,{ref:k?c:void 0,oqm:g,
isActive:k},`${g.startUs}-${h}`)})})})]},e))})})});var yXv=({isActive:a})=>wZ("div",{className:hXv("sp5uTw",{rMVC_A:a})});var zXv=({onClick:a})=>wZ("div",{className:"_7ztKEw",children:wZ(Tc,{align:"start",spacing:"2u",children:wZ(__c.Wi,{variant:"secondary",icon:__c.Ix,Np:"start",stretch:!0,onClick:a,children:__c.M("gsgTTQ")})})});var AXv=class{static G(a){__c.O(a,{cKj:sXv,Bbm:sXv,pzf:sXv,hSo:uXv.bound,deleteCaption:uXv.bound,cFm:uXv.bound,onFocus:uXv.bound,onBlur:uXv.bound,ICl:sXv})}get cKj(){const a=[];let b=0;for(const c of this.document.pages){if(c.draft)continue;b++;const d=this.store.BNh.filter(e=>e.context.container.page===c);d.length&&a.push({Bd:b,J8b:d})}return a}get Bbm(){return new Set(this.store.CCm)}get pzf(){return this.store.pzf}hSo(a,b){const c=a.caption;a=a.context.source;this.nw.MEd();c.text.Ywa(`${b}\n`);
this.N.hpq(a)}deleteCaption(a){this.nw.zga();const b=a.context,c=b.variant==="grouped"?b.qXd:b.Pee;c!=null?(c.pb.delete(a.caption),c.pb.count()===0&&b.container.page.elements.delete(c)):b.container.page.elements.delete(a.caption);this.N.P.track(__c.n$g,{media:[{mediaId:ZWv(a.context.source)}],action:"captions_row_deleted"})}cFm(){this.nw.zga();for(const {J8b:a}of this.cKj){const b=a[0].context.container.page,c=new Set(a.map(e=>e.context.variant==="individual"?e.context.Pee:void 0).filter(sb));for(const e of c)e.pb.Er(f=>
__c.nCe(f)),e.pb.count()===0&&b.elements.delete(e);const d=new Set(a.map(e=>{e=e.context;return e.variant==="grouped"?e.qXd:e.Pee==null?e.bog:null}).filter(sb));b.elements.Er(e=>d.has(e))}this.N.P.track(__c.n$g,{action:"all_captions_deleted"})}onFocus(a){const b=a.caption,c=a.context,d=a.sId;a=a.startUs;this.timing.btl?.(d+a);c.variant==="grouped"?this.selection.KUe(c.container.Me(c.qXd),b):c.Pee!=null?this.selection.KUe(c.container.Me(c.Pee),b):this.selection.Jl(c.container,c.bog);this.store.pzf=
b}onBlur(a){this.nw.zga();var b=this.N;b.store.z5h.has(a)&&(b.P.track(__c.n$g,{media:[{mediaId:ZWv(a)}],action:"caption_text_edited"}),b.store.z5h.delete(a));this.store.pzf=void 0}get ICl(){var a=this.selection.Ma?.elements??[];if(a.length>0&&a.every(b=>__c.oCe(b)))return!0;a=this.selection.Ma?.Hg;if(a!=null&&__c.oCe(a))return!0;a=this.selection.Ma?.inner;return a?.type==="group"&&__c.mCe(a.group)}constructor(a,b,c,d,e,f){this.document=a;this.N=b;this.nw=c;this.store=d;this.selection=e;this.timing=
f;AXv.G(this)}};var BXv=class{static G(a){__c.O(a,{BNh:sXv,VJm:sXv,CCm:sXv})}get fH(){return this.timing.drf||0}get BNh(){return this.document.pages.flatMap(a=>this.d2p(a))}get VJm(){return this.BNh.length>0}get CCm(){return this.F3q(this.fH)}constructor(a,b,c){this.document=a;this.od=b;this.timing=c;this.pzf=(BXv.G(this),void 0);this.d2p=vXv(d=>{const e=this.document;switch(d.type){case "fixed":const f=this.od.Iac(e,d),g=this.od.xb(d),h=d.elements.filter(__c.oCe).map(l=>l.type==="group"?{variant:"grouped",qXd:l,
container:__c.zf(e).xb(d)}:{variant:"individual",bog:l,container:__c.zf(e).xb(d)}),k=d.elements.filter(l=>l.type==="group").flatMap(l=>__c.mCe(l)?[]:l.pb.filter(__c.nCe).map(n=>({variant:"individual",Pee:l,bog:n,container:__c.zf(e).xb(d)})));return h.concat(k).flatMap(l=>(l=aXv(l))&&cXv(l,f,g)).filter(sb).sort((l,n)=>l.startUs-n.startUs);case "concatenated-fixed":case "responsive":return[];default:throw new __c.u(d);}});this.F3q=vXv(d=>this.BNh.filter(({sId:e,startUs:f,endUs:g})=>{e=d-e;return f<=
e&&e<g}).map(({caption:e})=>e))}};var CXv=class{static G(a){__c.O(a,{MEd:uXv,stop:uXv})}MEd(){this.o4==null&&(__c.sa(this.mOd===0),this.o4=this.undo.startBuffering(),this.mOd=window.setTimeout(()=>this.stop(),this.woq))}zga(){window.clearTimeout(this.mOd);this.stop()}stop(){this.mOd=0;this.o4?.stop();this.o4=void 0}constructor(a,b=1E3){this.undo=a;this.woq=b;this.o4=(CXv.G(this),void 0);this.mOd=0}};var DXv=__c.rc(6),FXv=()=>wZ(R,{padding:"2u",children:eXv(Tc,{spacing:"3u",children:[wZ(EXv,{}),wZ(EXv,{})]})}),EXv=()=>eXv(R,{children:[wZ(R,{className:"uVcZ_A",children:wZ(__c.Xi,{shape:"rectangle"})}),wZ(R,{className:"ASjK0Q",children:wZ(Tc,{spacing:"1u",children:DXv.map(a=>wZ(R,{className:"S_2MqA",children:wZ(__c.Xi,{index:a,shape:"rectangle"})},a))})})]});__c.iOe={onr:function({Jd:a,document:b,od:c,timing:d,b2p:e,undo:f,selection:g}){const h=new __c.Mx,k=new CXv(f),l=new BXv(b,c,d),n=new AXv(b,e,k,l,g,d),p=iXv(kXv((w,x)=>wZ(wXv,{ref:x,y3o:wZ(yXv,{isActive:w.isActive}),a2p:w.oqm,onFocus:n.onFocus,onBlur:n.onBlur,R0b:n.hSo,xv:n.deleteCaption,oc:$Wv(n,w.oqm),kvr:d.BIk()&&!w.isActive}))),q=()=>wZ(xXv,{L:n,x3o:p}),r=iXv(({oa:w})=>{l.VJm||w();return wZ(mXv,{fallback:wZ(FXv,{}),children:wZ(v,{A3o:q})})}),t=()=>h.$g({hf:r,sb:()=>wZ(zXv,{onClick:n.cFm}),options:{sg:()=>
__c.M("6tfC+g")}});tXv(()=>n.ICl,w=>{w||k.zga()});a.plugins.m9a=()=>({Sd:()=>!!n.ICl,Button:w=>{const x=w.onClick,y=nXv(()=>{x&&x();t()},[x]);return wZ(w.yi,{pressed:w.open,onClick:y,zh:"icon-and-label",icon:__c.yXb,children:__c.M("SH/djQ")})},navigation:h});const v=lXv(async()=>{const {Tgj:w}=await __webpack_require__.me(190471).then(()=>({Tgj:__c.YWv}));return{default:w}})}};
}).call(self, self._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/585bc96d36ba1670.js.map